<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 20 Proper ROC models | The RJafroc Roc Book</title>
  <meta name="description" content="Artificial intelligence and observer performance book based on RJafroc." />
  <meta name="generator" content="bookdown 0.32 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 20 Proper ROC models | The RJafroc Roc Book" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Artificial intelligence and observer performance book based on RJafroc." />
  <meta name="github-repo" content="dpc10ster/RJafrocRocBook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 20 Proper ROC models | The RJafroc Roc Book" />
  
  <meta name="twitter:description" content="Artificial intelligence and observer performance book based on RJafroc." />
  

<meta name="author" content="Dev P. Chakraborty, PhD" />


<meta name="date" content="2023-02-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="degenerate-rocs.html"/>
<link rel="next" href="proproc-rocs.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">RJafroc documentation</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#rationale-and-organization"><i class="fa fa-check"></i><b>0.1</b> Rationale and Organization</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#tba-acknowledgements"><i class="fa fa-check"></i><b>0.2</b> TBA Acknowledgements</a></li>
</ul></li>
<li class="part"><span><b>ROC paradigm</b></span></li>
<li class="chapter" data-level="1" data-path="preliminaries.html"><a href="preliminaries.html"><i class="fa fa-check"></i><b>1</b> Preliminaries</a><ul>
<li class="chapter" data-level="1.1" data-path="preliminaries.html"><a href="preliminaries.html#preliminaries-how-much-finished"><i class="fa fa-check"></i><b>1.1</b> TBA How much finished</a></li>
<li class="chapter" data-level="1.2" data-path="preliminaries.html"><a href="preliminaries.html#preliminariesIntro"><i class="fa fa-check"></i><b>1.2</b> Introduction</a></li>
<li class="chapter" data-level="1.3" data-path="preliminaries.html"><a href="preliminaries.html#clinical-tasks"><i class="fa fa-check"></i><b>1.3</b> Clinical tasks</a><ul>
<li class="chapter" data-level="1.3.1" data-path="preliminaries.html"><a href="preliminaries.html#workflow-in-an-imaging-study"><i class="fa fa-check"></i><b>1.3.1</b> Workflow in an imaging study</a></li>
<li class="chapter" data-level="1.3.2" data-path="preliminaries.html"><a href="preliminaries.html#the-screening-and-diagnostic-workup-tasks"><i class="fa fa-check"></i><b>1.3.2</b> The screening and diagnostic workup tasks</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="preliminaries.html"><a href="preliminaries.html#imaging-device-development-and-its-clinical-deployment"><i class="fa fa-check"></i><b>1.4</b> Imaging device development and its clinical deployment</a><ul>
<li class="chapter" data-level="1.4.1" data-path="preliminaries.html"><a href="preliminaries.html#physical-measurements"><i class="fa fa-check"></i><b>1.4.1</b> Physical measurements</a></li>
<li class="chapter" data-level="1.4.2" data-path="preliminaries.html"><a href="preliminaries.html#quality-control-and-image-quality-optimization"><i class="fa fa-check"></i><b>1.4.2</b> Quality Control and Image quality optimization</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="preliminaries.html"><a href="preliminaries.html#image-quality-vs.-task-performance"><i class="fa fa-check"></i><b>1.5</b> Image quality vs.Â task performance</a></li>
<li class="chapter" data-level="1.6" data-path="preliminaries.html"><a href="preliminaries.html#why-physical-measures-of-image-quality-are-not-enough"><i class="fa fa-check"></i><b>1.6</b> Why physical measures of image quality are not enough</a></li>
<li class="chapter" data-level="1.7" data-path="preliminaries.html"><a href="preliminaries.html#model-observers"><i class="fa fa-check"></i><b>1.7</b> Model observers</a></li>
<li class="chapter" data-level="1.8" data-path="preliminaries.html"><a href="preliminaries.html#measuring-observer-performance-four-paradigms"><i class="fa fa-check"></i><b>1.8</b> Measuring observer performance: four paradigms</a><ul>
<li class="chapter" data-level="1.8.1" data-path="preliminaries.html"><a href="preliminaries.html#basic-approach-to-the-analysis"><i class="fa fa-check"></i><b>1.8.1</b> Basic approach to the analysis</a></li>
<li class="chapter" data-level="1.8.2" data-path="preliminaries.html"><a href="preliminaries.html#historical-notes"><i class="fa fa-check"></i><b>1.8.2</b> Historical notes</a></li>
</ul></li>
<li class="chapter" data-level="1.9" data-path="preliminaries.html"><a href="preliminaries.html#hierarchy-of-assessment-methods"><i class="fa fa-check"></i><b>1.9</b> Hierarchy of assessment methods</a></li>
<li class="chapter" data-level="1.10" data-path="preliminaries.html"><a href="preliminaries.html#overview-of-the-book-and-how-to-use-it"><i class="fa fa-check"></i><b>1.10</b> Overview of the book and how to use it</a><ul>
<li class="chapter" data-level="1.10.1" data-path="preliminaries.html"><a href="preliminaries.html#overview-of-the-book"><i class="fa fa-check"></i><b>1.10.1</b> Overview of the book</a></li>
<li class="chapter" data-level="1.10.2" data-path="preliminaries.html"><a href="preliminaries.html#how-to-use-the-book"><i class="fa fa-check"></i><b>1.10.2</b> How to use the book</a></li>
</ul></li>
<li class="chapter" data-level="1.11" data-path="preliminaries.html"><a href="preliminaries.html#preliminaries-Summary"><i class="fa fa-check"></i><b>1.11</b> Summary</a></li>
<li class="chapter" data-level="1.12" data-path="preliminaries.html"><a href="preliminaries.html#preliminaries-Discussion"><i class="fa fa-check"></i><b>1.12</b> Discussion</a></li>
<li class="chapter" data-level="1.13" data-path="preliminaries.html"><a href="preliminaries.html#preliminaries-references"><i class="fa fa-check"></i><b>1.13</b> References</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="binary-task.html"><a href="binary-task.html"><i class="fa fa-check"></i><b>2</b> The Binary Task</a><ul>
<li class="chapter" data-level="2.1" data-path="binary-task.html"><a href="binary-task.html#binary-task-how-much-finished"><i class="fa fa-check"></i><b>2.1</b> TBA How much finished</a></li>
<li class="chapter" data-level="2.2" data-path="binary-task.html"><a href="binary-task.html#binary-taskIntro"><i class="fa fa-check"></i><b>2.2</b> Introduction</a></li>
<li class="chapter" data-level="2.3" data-path="binary-task.html"><a href="binary-task.html#binary-taskTruth"><i class="fa fa-check"></i><b>2.3</b> The fundamental 2x2 table</a></li>
<li class="chapter" data-level="2.4" data-path="binary-task.html"><a href="binary-task.html#sensitivity-and-specificity"><i class="fa fa-check"></i><b>2.4</b> Sensitivity and specificity</a><ul>
<li class="chapter" data-level="2.4.1" data-path="binary-task.html"><a href="binary-task.html#reasons-for-the-names-sensitivity-and-specificity"><i class="fa fa-check"></i><b>2.4.1</b> Reasons for the names sensitivity and specificity</a></li>
<li class="chapter" data-level="2.4.2" data-path="binary-task.html"><a href="binary-task.html#estimating-sensitivity-and-specificity"><i class="fa fa-check"></i><b>2.4.2</b> Estimating sensitivity and specificity</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="binary-task.html"><a href="binary-task.html#disease-prevalence"><i class="fa fa-check"></i><b>2.5</b> Disease prevalence</a></li>
<li class="chapter" data-level="2.6" data-path="binary-task.html"><a href="binary-task.html#accuracy"><i class="fa fa-check"></i><b>2.6</b> Accuracy</a></li>
<li class="chapter" data-level="2.7" data-path="binary-task.html"><a href="binary-task.html#negative-and-positive-predictive-values"><i class="fa fa-check"></i><b>2.7</b> Negative and positive predictive values</a><ul>
<li class="chapter" data-level="2.7.1" data-path="binary-task.html"><a href="binary-task.html#binary-taskNpvPpvCode"><i class="fa fa-check"></i><b>2.7.1</b> Example calculation of PPV, NPV and accuracy</a></li>
<li class="chapter" data-level="2.7.2" data-path="binary-task.html"><a href="binary-task.html#binary-taskNpvPpvComments"><i class="fa fa-check"></i><b>2.7.2</b> Comments</a></li>
<li class="chapter" data-level="2.7.3" data-path="binary-task.html"><a href="binary-task.html#binary-taskNpvPpvIrrel2LabTasks"><i class="fa fa-check"></i><b>2.7.3</b> PPV and NPV are irrelevant to laboratory tasks</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="binary-task.html"><a href="binary-task.html#binary-task-Summary"><i class="fa fa-check"></i><b>2.8</b> Summary</a></li>
<li class="chapter" data-level="2.9" data-path="binary-task.html"><a href="binary-task.html#binary-task-Discussion"><i class="fa fa-check"></i><b>2.9</b> Discussion</a></li>
<li class="chapter" data-level="2.10" data-path="binary-task.html"><a href="binary-task.html#binary-task-references"><i class="fa fa-check"></i><b>2.10</b> References</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="binary-task-model.html"><a href="binary-task-model.html"><i class="fa fa-check"></i><b>3</b> Modeling the Binary Task</a><ul>
<li class="chapter" data-level="3.1" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-how-much-finished"><i class="fa fa-check"></i><b>3.1</b> TBA How much finished</a></li>
<li class="chapter" data-level="3.2" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-intro"><i class="fa fa-check"></i><b>3.2</b> Introduction</a></li>
<li class="chapter" data-level="3.3" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-z-sample-model"><i class="fa fa-check"></i><b>3.3</b> Decision variable and decision threshold</a><ul>
<li class="chapter" data-level="3.3.1" data-path="binary-task-model.html"><a href="binary-task-model.html#existence-of-a-decision-variable"><i class="fa fa-check"></i><b>3.3.1</b> Existence of a decision variable</a></li>
<li class="chapter" data-level="3.3.2" data-path="binary-task-model.html"><a href="binary-task-model.html#existence-of-a-decision-threshold"><i class="fa fa-check"></i><b>3.3.2</b> Existence of a decision threshold</a></li>
<li class="chapter" data-level="3.3.3" data-path="binary-task-model.html"><a href="binary-task-model.html#adequacy-of-the-training-session"><i class="fa fa-check"></i><b>3.3.3</b> Adequacy of the training session</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-example-1"><i class="fa fa-check"></i><b>3.4</b> Changing the decision threshold: Example I</a></li>
<li class="chapter" data-level="3.5" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-example-2"><i class="fa fa-check"></i><b>3.5</b> Changing the decision threshold: Example II</a></li>
<li class="chapter" data-level="3.6" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-equal-variance-binormal-model"><i class="fa fa-check"></i><b>3.6</b> The equal-variance binormal model</a></li>
<li class="chapter" data-level="3.7" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-normal-distribution"><i class="fa fa-check"></i><b>3.7</b> The normal distribution</a></li>
<li class="chapter" data-level="3.8" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-sensitivity-specificity"><i class="fa fa-check"></i><b>3.8</b> Analytic expressions for specificity and sensitivity</a></li>
<li class="chapter" data-level="3.9" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-sensitivity-specificity-demo"><i class="fa fa-check"></i><b>3.9</b> Demonstration of the concepts of sensitivity and specificity</a><ul>
<li class="chapter" data-level="3.9.1" data-path="binary-task-model.html"><a href="binary-task-model.html#estimating-mu-from-a-finite-sample"><i class="fa fa-check"></i><b>3.9.1</b> Estimating mu from a finite sample</a></li>
<li class="chapter" data-level="3.9.2" data-path="binary-task-model.html"><a href="binary-task-model.html#changing-the-seed-variable-case-sampling-variability"><i class="fa fa-check"></i><b>3.9.2</b> Changing the seed variable: case-sampling variability</a></li>
<li class="chapter" data-level="3.9.3" data-path="binary-task-model.html"><a href="binary-task-model.html#increasing-the-numbers-of-cases"><i class="fa fa-check"></i><b>3.9.3</b> Increasing the numbers of cases</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-sensitivity-specificity-inverse-variation"><i class="fa fa-check"></i><b>3.10</b> Inverse variation of sensitivity and specificity and the need for a single FOM</a></li>
<li class="chapter" data-level="3.11" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-roc-curve"><i class="fa fa-check"></i><b>3.11</b> The ROC curve</a><ul>
<li class="chapter" data-level="3.11.1" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-chance-diagonal"><i class="fa fa-check"></i><b>3.11.1</b> The chance diagonal</a></li>
<li class="chapter" data-level="3.11.2" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-guessing-observer"><i class="fa fa-check"></i><b>3.11.2</b> The guessing observer</a></li>
<li class="chapter" data-level="3.11.3" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-symmetry-wrt-negative-diagonal"><i class="fa fa-check"></i><b>3.11.3</b> Symmetry with respect to negative diagonal</a></li>
<li class="chapter" data-level="3.11.4" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-auc-roc-important"><i class="fa fa-check"></i><b>3.11.4</b> Area under the ROC curve</a></li>
<li class="chapter" data-level="3.11.5" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-properties-roc"><i class="fa fa-check"></i><b>3.11.5</b> Properties of the equal-variance binormal model ROC curve</a></li>
<li class="chapter" data-level="3.11.6" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-comments"><i class="fa fa-check"></i><b>3.11.6</b> Comments</a></li>
<li class="chapter" data-level="3.11.7" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-mu-parameter-intepretation"><i class="fa fa-check"></i><b>3.11.7</b> Physical interpretation of the mu-parameter</a></li>
</ul></li>
<li class="chapter" data-level="3.12" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-confidence-intervals"><i class="fa fa-check"></i><b>3.12</b> Assigning confidence intervals to an operating point</a></li>
<li class="chapter" data-level="3.13" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-beam-study"><i class="fa fa-check"></i><b>3.13</b> Variability in sensitivity and specificity: the Beam et al study</a></li>
<li class="chapter" data-level="3.14" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-summary"><i class="fa fa-check"></i><b>3.14</b> Summary</a></li>
<li class="chapter" data-level="3.15" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-references"><i class="fa fa-check"></i><b>3.15</b> References</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ratings-paradigm.html"><a href="ratings-paradigm.html"><i class="fa fa-check"></i><b>4</b> Ratings Paradigm</a><ul>
<li class="chapter" data-level="4.1" data-path="ratings-paradigm.html"><a href="ratings-paradigm.html#ratings-paradigm-how-much-finished"><i class="fa fa-check"></i><b>4.1</b> TBA How much finished</a></li>
<li class="chapter" data-level="4.2" data-path="ratings-paradigm.html"><a href="ratings-paradigm.html#ratings-paradigm-introduction"><i class="fa fa-check"></i><b>4.2</b> Introduction</a></li>
<li class="chapter" data-level="4.3" data-path="ratings-paradigm.html"><a href="ratings-paradigm.html#binary-task-roc-counts-table"><i class="fa fa-check"></i><b>4.3</b> The ROC counts table</a></li>
<li class="chapter" data-level="4.4" data-path="ratings-paradigm.html"><a href="ratings-paradigm.html#binary-task-operating-points-from-counts-table"><i class="fa fa-check"></i><b>4.4</b> Operating points from counts table</a><ul>
<li class="chapter" data-level="4.4.1" data-path="ratings-paradigm.html"><a href="ratings-paradigm.html#labeling-the-points"><i class="fa fa-check"></i><b>4.4.1</b> Labeling the points</a></li>
<li class="chapter" data-level="4.4.2" data-path="ratings-paradigm.html"><a href="ratings-paradigm.html#binary-task-examples"><i class="fa fa-check"></i><b>4.4.2</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="ratings-paradigm.html"><a href="ratings-paradigm.html#binary-task-automating"><i class="fa fa-check"></i><b>4.5</b> Automating all this</a></li>
<li class="chapter" data-level="4.6" data-path="ratings-paradigm.html"><a href="ratings-paradigm.html#binary-task-relation-to-rating"><i class="fa fa-check"></i><b>4.6</b> Relation between ratings paradigm and the binary paradigm</a></li>
<li class="chapter" data-level="4.7" data-path="ratings-paradigm.html"><a href="ratings-paradigm.html#binary-task-ratings-not-numerical-values"><i class="fa fa-check"></i><b>4.7</b> Ratings are not numerical values</a></li>
<li class="chapter" data-level="4.8" data-path="ratings-paradigm.html"><a href="ratings-paradigm.html#binary-task-clinical-operating-point"><i class="fa fa-check"></i><b>4.8</b> A single âclinicalâ operating point from ratings data</a></li>
<li class="chapter" data-level="4.9" data-path="ratings-paradigm.html"><a href="ratings-paradigm.html#binary-task-2afc"><i class="fa fa-check"></i><b>4.9</b> The forced choice paradigm</a></li>
<li class="chapter" data-level="4.10" data-path="ratings-paradigm.html"><a href="ratings-paradigm.html#binary-task-observer-studies-as-simulations"><i class="fa fa-check"></i><b>4.10</b> Observer performance studies as laboratory simulations of clinical tasks</a></li>
<li class="chapter" data-level="4.11" data-path="ratings-paradigm.html"><a href="ratings-paradigm.html#binary-task-discrete-vs-continuous-ratings"><i class="fa fa-check"></i><b>4.11</b> Discrete vs.Â continuous ratings: the Miller study</a></li>
<li class="chapter" data-level="4.12" data-path="ratings-paradigm.html"><a href="ratings-paradigm.html#binary-task-birads-rating-scale"><i class="fa fa-check"></i><b>4.12</b> The BI-RADS ratings scale and ROC studies</a></li>
<li class="chapter" data-level="4.13" data-path="ratings-paradigm.html"><a href="ratings-paradigm.html#binary-task-birads-rating-scale-controversy"><i class="fa fa-check"></i><b>4.13</b> The controversy</a></li>
<li class="chapter" data-level="4.14" data-path="ratings-paradigm.html"><a href="ratings-paradigm.html#ratings-paradigm-discussion"><i class="fa fa-check"></i><b>4.14</b> Discussion</a></li>
<li class="chapter" data-level="4.15" data-path="ratings-paradigm.html"><a href="ratings-paradigm.html#ratings-paradigm-references"><i class="fa fa-check"></i><b>4.15</b> References</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="empirical-auc.html"><a href="empirical-auc.html"><i class="fa fa-check"></i><b>5</b> Empirical AUC</a><ul>
<li class="chapter" data-level="5.1" data-path="empirical-auc.html"><a href="empirical-auc.html#empirical-auc-how-much-finished"><i class="fa fa-check"></i><b>5.1</b> TBA How much finished</a></li>
<li class="chapter" data-level="5.2" data-path="empirical-auc.html"><a href="empirical-auc.html#empirical-auc-introduction"><i class="fa fa-check"></i><b>5.2</b> Introduction</a></li>
<li class="chapter" data-level="5.3" data-path="empirical-auc.html"><a href="empirical-auc.html#empirical-roc-plot"><i class="fa fa-check"></i><b>5.3</b> The empirical ROC plot</a><ul>
<li class="chapter" data-level="5.3.1" data-path="empirical-auc.html"><a href="empirical-auc.html#notation-for-cases"><i class="fa fa-check"></i><b>5.3.1</b> Notation for cases</a></li>
<li class="chapter" data-level="5.3.2" data-path="empirical-auc.html"><a href="empirical-auc.html#an-empirical-operating-point"><i class="fa fa-check"></i><b>5.3.2</b> An empirical operating point</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="empirical-auc.html"><a href="empirical-auc.html#empirical-auc-operating-points"><i class="fa fa-check"></i><b>5.4</b> Empirical operating points from ratings data</a></li>
<li class="chapter" data-level="5.5" data-path="empirical-auc.html"><a href="empirical-auc.html#empirical-auc-area-under"><i class="fa fa-check"></i><b>5.5</b> AUC under the empirical ROC plot</a></li>
<li class="chapter" data-level="5.6" data-path="empirical-auc.html"><a href="empirical-auc.html#empirical-auc-wilcoxon"><i class="fa fa-check"></i><b>5.6</b> The Wilcoxon statistic</a></li>
<li class="chapter" data-level="5.7" data-path="empirical-auc.html"><a href="empirical-auc.html#empirical-auc-wilcoxon-bamber-theorem"><i class="fa fa-check"></i><b>5.7</b> Bamberâs Equivalence theorem</a></li>
<li class="chapter" data-level="5.8" data-path="empirical-auc.html"><a href="empirical-auc.html#empirical-auc-wilcoxon-bamber-theorem-importance"><i class="fa fa-check"></i><b>5.8</b> Importance of Bamberâs theorem</a></li>
<li class="chapter" data-level="5.9" data-path="empirical-auc.html"><a href="empirical-auc.html#empirical-auc-discussion-summary"><i class="fa fa-check"></i><b>5.9</b> Discussion / Summary</a></li>
<li class="chapter" data-level="5.10" data-path="empirical-auc.html"><a href="empirical-auc.html#empirical-auc-appendix-details-bamber-theorem"><i class="fa fa-check"></i><b>5.10</b> Appendix 5.A: Details of Wilcoxon theorem</a><ul>
<li class="chapter" data-level="5.10.1" data-path="empirical-auc.html"><a href="empirical-auc.html#upper-triangle"><i class="fa fa-check"></i><b>5.10.1</b> Upper triangle</a></li>
<li class="chapter" data-level="5.10.2" data-path="empirical-auc.html"><a href="empirical-auc.html#lowest-trapezoid"><i class="fa fa-check"></i><b>5.10.2</b> Lowest trapezoid</a></li>
</ul></li>
<li class="chapter" data-level="5.11" data-path="empirical-auc.html"><a href="empirical-auc.html#empirical-auc-references"><i class="fa fa-check"></i><b>5.11</b> References</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="binormal-model.html"><a href="binormal-model.html"><i class="fa fa-check"></i><b>6</b> Binormal model</a><ul>
<li class="chapter" data-level="6.1" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-how-much-finished"><i class="fa fa-check"></i><b>6.1</b> How much finished</a></li>
<li class="chapter" data-level="6.2" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-introduction"><i class="fa fa-check"></i><b>6.2</b> Introduction</a></li>
<li class="chapter" data-level="6.3" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-definition"><i class="fa fa-check"></i><b>6.3</b> Binormal model</a><ul>
<li class="chapter" data-level="6.3.1" data-path="binormal-model.html"><a href="binormal-model.html#additional-parameters-for-binned-data"><i class="fa fa-check"></i><b>6.3.1</b> Additional parameters for binned data</a></li>
<li class="chapter" data-level="6.3.2" data-path="binormal-model.html"><a href="binormal-model.html#sensitivity-and-specificity-1"><i class="fa fa-check"></i><b>6.3.2</b> Sensitivity and specificity</a></li>
<li class="chapter" data-level="6.3.3" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-in-conventional-notation"><i class="fa fa-check"></i><b>6.3.3</b> Binormal model in conventional notation</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-roc-curve"><i class="fa fa-check"></i><b>6.4</b> Binormal ROC curve</a></li>
<li class="chapter" data-level="6.5" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-scalar-measure"><i class="fa fa-check"></i><b>6.5</b> Threshold-independent performance measure</a><ul>
<li class="chapter" data-level="6.5.1" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-partial-auc"><i class="fa fa-check"></i><b>6.5.1</b> Partial AUC</a></li>
<li class="chapter" data-level="6.5.2" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-meaning-partial-auc"><i class="fa fa-check"></i><b>6.5.2</b> Meaning of partial AUC</a></li>
<li class="chapter" data-level="6.5.3" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-partial-auc-recommendation"><i class="fa fa-check"></i><b>6.5.3</b> Full AUC</a></li>
<li class="chapter" data-level="6.5.4" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-full-auc"><i class="fa fa-check"></i><b>6.5.4</b> Full AUC</a></li>
<li class="chapter" data-level="6.5.5" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-d-prime"><i class="fa fa-check"></i><b>6.5.5</b> The dâ measure</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-partial-true"><i class="fa fa-check"></i><b>6.6</b> Partial AUC vs.Â true performance</a></li>
<li class="chapter" data-level="6.7" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-illustrative-plots"><i class="fa fa-check"></i><b>6.7</b> Illustrative plots</a></li>
<li class="chapter" data-level="6.8" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-geometrical-argument"><i class="fa fa-check"></i><b>6.8</b> Geometrical argument</a></li>
<li class="chapter" data-level="6.9" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-optimal-op-pt"><i class="fa fa-check"></i><b>6.9</b> Optimal operating point on ROC</a></li>
<li class="chapter" data-level="6.10" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-discussion"><i class="fa fa-check"></i><b>6.10</b> Discussion</a></li>
<li class="chapter" data-level="6.11" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-pdf-curves-appendix-1"><i class="fa fa-check"></i><b>6.11</b> Appendix I: Density functions</a></li>
<li class="chapter" data-level="6.12" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-appendix-2"><i class="fa fa-check"></i><b>6.12</b> Appendix II: Area under binormal ROC</a><ul>
<li class="chapter" data-level="6.12.1" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-partial-auc-derivation"><i class="fa fa-check"></i><b>6.12.1</b> General case (partial-area)</a></li>
<li class="chapter" data-level="6.12.2" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-total-auc"><i class="fa fa-check"></i><b>6.12.2</b> Special case (total area)</a></li>
</ul></li>
<li class="chapter" data-level="6.13" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-invariance-property"><i class="fa fa-check"></i><b>6.13</b> Appendix III: Invariance property of pdfs</a></li>
<li class="chapter" data-level="6.14" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-curve-fitting-appendix-4"><i class="fa fa-check"></i><b>6.14</b> Appendix IV: Fitting an ROC curve</a><ul>
<li class="chapter" data-level="6.14.1" data-path="binormal-model.html"><a href="binormal-model.html#java-fitted-roc-curve"><i class="fa fa-check"></i><b>6.14.1</b> JAVA fitted ROC curve</a></li>
<li class="chapter" data-level="6.14.2" data-path="binormal-model.html"><a href="binormal-model.html#simplistic-straight-line-fit-to-the-roc-curve"><i class="fa fa-check"></i><b>6.14.2</b> Simplistic straight line fit to the ROC curve</a></li>
<li class="chapter" data-level="6.14.3" data-path="binormal-model.html"><a href="binormal-model.html#maximum-likelihood-estimation-mle"><i class="fa fa-check"></i><b>6.14.3</b> Maximum likelihood estimation (MLE)</a></li>
<li class="chapter" data-level="6.14.4" data-path="binormal-model.html"><a href="binormal-model.html#code-implementing-mle"><i class="fa fa-check"></i><b>6.14.4</b> Code implementing MLE</a></li>
</ul></li>
<li class="chapter" data-level="6.15" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-curve-fitting-validation-appendix-5"><i class="fa fa-check"></i><b>6.15</b> Appendix V: Validating fitting model</a><ul>
<li class="chapter" data-level="6.15.1" data-path="binormal-model.html"><a href="binormal-model.html#estimating-the-covariance-matrix"><i class="fa fa-check"></i><b>6.15.1</b> Estimating the covariance matrix</a></li>
<li class="chapter" data-level="6.15.2" data-path="binormal-model.html"><a href="binormal-model.html#estimating-the-variance-of-az"><i class="fa fa-check"></i><b>6.15.2</b> Estimating the variance of Az</a></li>
</ul></li>
<li class="chapter" data-level="6.16" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-references"><i class="fa fa-check"></i><b>6.16</b> References</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="sources-of-variability.html"><a href="sources-of-variability.html"><i class="fa fa-check"></i><b>7</b> Sources of AUC variability</a><ul>
<li class="chapter" data-level="7.1" data-path="sources-of-variability.html"><a href="sources-of-variability.html#sources-of-variability-how-much-finished"><i class="fa fa-check"></i><b>7.1</b> TBA How much finished</a></li>
<li class="chapter" data-level="7.2" data-path="sources-of-variability.html"><a href="sources-of-variability.html#sources-of-variabilityIntro"><i class="fa fa-check"></i><b>7.2</b> Introduction</a></li>
<li class="chapter" data-level="7.3" data-path="sources-of-variability.html"><a href="sources-of-variability.html#sources-of-variability3sources"><i class="fa fa-check"></i><b>7.3</b> Three sources of variability</a></li>
<li class="chapter" data-level="7.4" data-path="sources-of-variability.html"><a href="sources-of-variability.html#dependence-of-auc-on-the-case-sample"><i class="fa fa-check"></i><b>7.4</b> Dependence of AUC on the case sample</a><ul>
<li class="chapter" data-level="7.4.1" data-path="sources-of-variability.html"><a href="sources-of-variability.html#case-sampling-variability-of-auc"><i class="fa fa-check"></i><b>7.4.1</b> Case sampling variability of AUC</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="sources-of-variability.html"><a href="sources-of-variability.html#sources-of-variabilityDeLong"><i class="fa fa-check"></i><b>7.5</b> DeLong method</a></li>
<li class="chapter" data-level="7.6" data-path="sources-of-variability.html"><a href="sources-of-variability.html#sources-of-variabilityBootstrap"><i class="fa fa-check"></i><b>7.6</b> Bootstrap method</a><ul>
<li class="chapter" data-level="7.6.1" data-path="sources-of-variability.html"><a href="sources-of-variability.html#demonstration-of-the-bootstrap-method"><i class="fa fa-check"></i><b>7.6.1</b> Demonstration of the bootstrap method</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="sources-of-variability.html"><a href="sources-of-variability.html#sources-of-variabilityJackknife"><i class="fa fa-check"></i><b>7.7</b> Jackknife method</a></li>
<li class="chapter" data-level="7.8" data-path="sources-of-variability.html"><a href="sources-of-variability.html#sources-of-variabilityCalSimulator"><i class="fa fa-check"></i><b>7.8</b> Calibrated simulator</a><ul>
<li class="chapter" data-level="7.8.1" data-path="sources-of-variability.html"><a href="sources-of-variability.html#the-need-for-a-calibrated-simulator"><i class="fa fa-check"></i><b>7.8.1</b> The need for a calibrated simulator</a></li>
<li class="chapter" data-level="7.8.2" data-path="sources-of-variability.html"><a href="sources-of-variability.html#implementation-of-a-simple-calibrated-simulator"><i class="fa fa-check"></i><b>7.8.2</b> Implementation of a simple calibrated simulator</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="sources-of-variability.html"><a href="sources-of-variability.html#sources-of-variability-Discussion"><i class="fa fa-check"></i><b>7.9</b> Discussion</a></li>
<li class="chapter" data-level="7.10" data-path="sources-of-variability.html"><a href="sources-of-variability.html#sources-of-variability-references"><i class="fa fa-check"></i><b>7.10</b> References</a></li>
</ul></li>
<li class="part"><span><b>Significance Testing</b></span></li>
<li class="chapter" data-level="8" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html"><i class="fa fa-check"></i><b>8</b> Hypothesis Testing</a><ul>
<li class="chapter" data-level="8.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#hypothesis-testing-how-much-finished"><i class="fa fa-check"></i><b>8.1</b> TBA How much finished</a></li>
<li class="chapter" data-level="8.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#hypothesis-testing-introduction"><i class="fa fa-check"></i><b>8.2</b> Introduction</a></li>
<li class="chapter" data-level="8.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#single-modality-single-reader-roc-study"><i class="fa fa-check"></i><b>8.3</b> Single-modality single-reader ROC study</a></li>
<li class="chapter" data-level="8.4" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#type-i-errors"><i class="fa fa-check"></i><b>8.4</b> Type-I errors</a></li>
<li class="chapter" data-level="8.5" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#one-vs.-two-sided-tests"><i class="fa fa-check"></i><b>8.5</b> One vs.Â two sided tests</a></li>
<li class="chapter" data-level="8.6" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#statistical-power"><i class="fa fa-check"></i><b>8.6</b> Statistical power</a><ul>
<li class="chapter" data-level="8.6.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#factors-affecting-statistical-power"><i class="fa fa-check"></i><b>8.6.1</b> Factors affecting statistical power</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#hypothesis-testingComments"><i class="fa fa-check"></i><b>8.7</b> Comments</a></li>
<li class="chapter" data-level="8.8" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#why-alpha-is-chosen-as-5"><i class="fa fa-check"></i><b>8.8</b> Why alpha is chosen as 5%</a></li>
<li class="chapter" data-level="8.9" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#hypothesis-testingDiscussion"><i class="fa fa-check"></i><b>8.9</b> Discussion</a></li>
<li class="chapter" data-level="8.10" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#hypothesis-testing-references"><i class="fa fa-check"></i><b>8.10</b> References</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="dbm-analysis-background.html"><a href="dbm-analysis-background.html"><i class="fa fa-check"></i><b>9</b> DBM method background</a><ul>
<li class="chapter" data-level="9.1" data-path="dbm-analysis-background.html"><a href="dbm-analysis-background.html#dbm-analysis-background-how-much-finished"><i class="fa fa-check"></i><b>9.1</b> TBA How much finished</a></li>
<li class="chapter" data-level="9.2" data-path="dbm-analysis-background.html"><a href="dbm-analysis-background.html#dbm-analysis-background-introduction"><i class="fa fa-check"></i><b>9.2</b> Introduction</a><ul>
<li class="chapter" data-level="9.2.1" data-path="dbm-analysis-background.html"><a href="dbm-analysis-background.html#historical-background"><i class="fa fa-check"></i><b>9.2.1</b> Historical background</a></li>
<li class="chapter" data-level="9.2.2" data-path="dbm-analysis-background.html"><a href="dbm-analysis-background.html#the-wagner-analogy"><i class="fa fa-check"></i><b>9.2.2</b> The Wagner analogy</a></li>
<li class="chapter" data-level="9.2.3" data-path="dbm-analysis-background.html"><a href="dbm-analysis-background.html#the-shortage-of-numbers-to-analyze-and-a-pivotal-breakthrough"><i class="fa fa-check"></i><b>9.2.3</b> The shortage of numbers to analyze and a pivotal breakthrough</a></li>
<li class="chapter" data-level="9.2.4" data-path="dbm-analysis-background.html"><a href="dbm-analysis-background.html#organization-of-chapter"><i class="fa fa-check"></i><b>9.2.4</b> Organization of chapter</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="dbm-analysis-background.html"><a href="dbm-analysis-background.html#dbm-analysis-background-random-fixed-factors"><i class="fa fa-check"></i><b>9.3</b> Random and fixed factors</a></li>
<li class="chapter" data-level="9.4" data-path="dbm-analysis-background.html"><a href="dbm-analysis-background.html#dbm-analysis-background-reader-case-populations"><i class="fa fa-check"></i><b>9.4</b> Reader and case populations</a></li>
<li class="chapter" data-level="9.5" data-path="dbm-analysis-background.html"><a href="dbm-analysis-background.html#dbm-analysis-background-threeAnalyses"><i class="fa fa-check"></i><b>9.5</b> Three types of analyses</a></li>
<li class="chapter" data-level="9.6" data-path="dbm-analysis-background.html"><a href="dbm-analysis-background.html#dbm-analysis-background-approach"><i class="fa fa-check"></i><b>9.6</b> General approach</a></li>
<li class="chapter" data-level="9.7" data-path="dbm-analysis-background.html"><a href="dbm-analysis-background.html#dbm-analysis-background-summary"><i class="fa fa-check"></i><b>9.7</b> Summary TBA</a></li>
<li class="chapter" data-level="9.8" data-path="dbm-analysis-background.html"><a href="dbm-analysis-background.html#dbm-analysis-background-references"><i class="fa fa-check"></i><b>9.8</b> References</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="dbm-analysis-significance-testing.html"><a href="dbm-analysis-significance-testing.html"><i class="fa fa-check"></i><b>10</b> Significance Testing using the DBM Method</a><ul>
<li class="chapter" data-level="10.1" data-path="dbm-analysis-significance-testing.html"><a href="dbm-analysis-significance-testing.html#dbm-analysis-significance-testing-how-much-finished"><i class="fa fa-check"></i><b>10.1</b> TBA How much finished</a></li>
<li class="chapter" data-level="10.2" data-path="dbm-analysis-significance-testing.html"><a href="dbm-analysis-significance-testing.html#the-dbm-sampling-model"><i class="fa fa-check"></i><b>10.2</b> The DBM sampling model</a><ul>
<li class="chapter" data-level="10.2.1" data-path="dbm-analysis-significance-testing.html"><a href="dbm-analysis-significance-testing.html#explanation-of-terms-in-the-model"><i class="fa fa-check"></i><b>10.2.1</b> Explanation of terms in the model</a></li>
<li class="chapter" data-level="10.2.2" data-path="dbm-analysis-significance-testing.html"><a href="dbm-analysis-significance-testing.html#meanings-of-variance-components-in-the-dbm-model-tba-this-section-can-be-improved"><i class="fa fa-check"></i><b>10.2.2</b> Meanings of variance components in the DBM model (<strong>TBA this section can be improved</strong>)</a></li>
<li class="chapter" data-level="10.2.3" data-path="dbm-analysis-significance-testing.html"><a href="dbm-analysis-significance-testing.html#definitions-of-mean-squares"><i class="fa fa-check"></i><b>10.2.3</b> Definitions of mean-squares</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="dbm-analysis-significance-testing.html"><a href="dbm-analysis-significance-testing.html#expected-values-of-mean-squares"><i class="fa fa-check"></i><b>10.3</b> Expected values of mean squares</a></li>
<li class="chapter" data-level="10.4" data-path="dbm-analysis-significance-testing.html"><a href="dbm-analysis-significance-testing.html#dbm-analysis-significance-testing-RRRC-analysis"><i class="fa fa-check"></i><b>10.4</b> Random-reader random-case (RRRC) analysis</a><ul>
<li class="chapter" data-level="10.4.1" data-path="dbm-analysis-significance-testing.html"><a href="dbm-analysis-significance-testing.html#calculation-of-mean-squares-an-example"><i class="fa fa-check"></i><b>10.4.1</b> Calculation of mean squares: an example</a></li>
<li class="chapter" data-level="10.4.2" data-path="dbm-analysis-significance-testing.html"><a href="dbm-analysis-significance-testing.html#dbm-analysis-significance-testing-sig-testing"><i class="fa fa-check"></i><b>10.4.2</b> Significance testing</a></li>
<li class="chapter" data-level="10.4.3" data-path="dbm-analysis-significance-testing.html"><a href="dbm-analysis-significance-testing.html#the-satterthwaite-approximation"><i class="fa fa-check"></i><b>10.4.3</b> The Satterthwaite approximation</a></li>
<li class="chapter" data-level="10.4.4" data-path="dbm-analysis-significance-testing.html"><a href="dbm-analysis-significance-testing.html#decision-rules-p-value-and-confidence-intervals"><i class="fa fa-check"></i><b>10.4.4</b> Decision rules, p-value and confidence intervals</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="dbm-analysis-significance-testing.html"><a href="dbm-analysis-significance-testing.html#sample-size-estimation-for-random-reader-random-case-generalization"><i class="fa fa-check"></i><b>10.5</b> Sample size estimation for random-reader random-case generalization</a><ul>
<li class="chapter" data-level="10.5.1" data-path="dbm-analysis-significance-testing.html"><a href="dbm-analysis-significance-testing.html#the-non-centrality-parameter"><i class="fa fa-check"></i><b>10.5.1</b> The non-centrality parameter</a></li>
<li class="chapter" data-level="10.5.2" data-path="dbm-analysis-significance-testing.html"><a href="dbm-analysis-significance-testing.html#the-denominator-degrees-of-freedom"><i class="fa fa-check"></i><b>10.5.2</b> The denominator degrees of freedom</a></li>
<li class="chapter" data-level="10.5.3" data-path="dbm-analysis-significance-testing.html"><a href="dbm-analysis-significance-testing.html#example-of-sample-size-estimation-rrrc-generalization"><i class="fa fa-check"></i><b>10.5.3</b> Example of sample size estimation, RRRC generalization</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="dbm-analysis-significance-testing.html"><a href="dbm-analysis-significance-testing.html#significance-testing-and-sample-size-estimation-for-fixed-reader-random-case-generalization"><i class="fa fa-check"></i><b>10.6</b> Significance testing and sample size estimation for fixed-reader random-case generalization</a></li>
<li class="chapter" data-level="10.7" data-path="dbm-analysis-significance-testing.html"><a href="dbm-analysis-significance-testing.html#significance-testing-and-sample-size-estimation-for-random-reader-fixed-case-generalization"><i class="fa fa-check"></i><b>10.7</b> Significance testing and sample size estimation for random-reader fixed-case generalization</a></li>
<li class="chapter" data-level="10.8" data-path="dbm-analysis-significance-testing.html"><a href="dbm-analysis-significance-testing.html#dbm-analysis-significance-testing-summary"><i class="fa fa-check"></i><b>10.8</b> Summary TBA</a></li>
<li class="chapter" data-level="10.9" data-path="dbm-analysis-significance-testing.html"><a href="dbm-analysis-significance-testing.html#things-for-me-to-think-about"><i class="fa fa-check"></i><b>10.9</b> Things for me to think about</a><ul>
<li class="chapter" data-level="10.9.1" data-path="dbm-analysis-significance-testing.html"><a href="dbm-analysis-significance-testing.html#expected-values-of-mean-squares-1"><i class="fa fa-check"></i><b>10.9.1</b> Expected values of mean squares</a></li>
</ul></li>
<li class="chapter" data-level="10.10" data-path="dbm-analysis-significance-testing.html"><a href="dbm-analysis-significance-testing.html#dbm-analysis-significance-testing-references"><i class="fa fa-check"></i><b>10.10</b> References</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="dbm-analysis-special-cases.html"><a href="dbm-analysis-special-cases.html"><i class="fa fa-check"></i><b>11</b> DBM method special cases</a><ul>
<li class="chapter" data-level="11.1" data-path="dbm-analysis-special-cases.html"><a href="dbm-analysis-special-cases.html#dbm-analysis-special-cases-fits-how-much-finished"><i class="fa fa-check"></i><b>11.1</b> TBA How much finished</a></li>
<li class="chapter" data-level="11.2" data-path="dbm-analysis-special-cases.html"><a href="dbm-analysis-special-cases.html#FRRCDBMAnalysis"><i class="fa fa-check"></i><b>11.2</b> Fixed-reader random-case (FRRC) analysis</a><ul>
<li class="chapter" data-level="11.2.1" data-path="dbm-analysis-special-cases.html"><a href="dbm-analysis-special-cases.html#FRRCSingleReaderDBMAnalysis"><i class="fa fa-check"></i><b>11.2.1</b> Single-reader multiple-treatment analysis</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="dbm-analysis-special-cases.html"><a href="dbm-analysis-special-cases.html#dbm-analysis-special-cases-RRFCAnalysis"><i class="fa fa-check"></i><b>11.3</b> Random-reader fixed-case (RRFC) analysis</a></li>
<li class="chapter" data-level="11.4" data-path="dbm-analysis-special-cases.html"><a href="dbm-analysis-special-cases.html#dbm-analysis-special-cases-references"><i class="fa fa-check"></i><b>11.4</b> References</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="or-method-intro.html"><a href="or-method-intro.html"><i class="fa fa-check"></i><b>12</b> Introduction to the Obuchowski-Rockette method</a><ul>
<li class="chapter" data-level="12.1" data-path="or-method-intro.html"><a href="or-method-intro.html#or-method-intro-how-much-finished"><i class="fa fa-check"></i><b>12.1</b> TBA How much finished</a></li>
<li class="chapter" data-level="12.2" data-path="or-method-intro.html"><a href="or-method-intro.html#or-method-intro-helper-functions"><i class="fa fa-check"></i><b>12.2</b> Locations of helper functions</a></li>
<li class="chapter" data-level="12.3" data-path="or-method-intro.html"><a href="or-method-intro.html#or-method-intro-intro"><i class="fa fa-check"></i><b>12.3</b> Introduction</a></li>
<li class="chapter" data-level="12.4" data-path="or-method-intro.html"><a href="or-method-intro.html#or-method-intro-single-reader"><i class="fa fa-check"></i><b>12.4</b> Single-reader multiple-treatment</a><ul>
<li class="chapter" data-level="12.4.1" data-path="or-method-intro.html"><a href="or-method-intro.html#or-method-intro-single-reader-overview"><i class="fa fa-check"></i><b>12.4.1</b> Overview</a></li>
<li class="chapter" data-level="12.4.2" data-path="or-method-intro.html"><a href="or-method-intro.html#st-or-multiple-treatment"><i class="fa fa-check"></i><b>12.4.2</b> Significance testing</a></li>
<li class="chapter" data-level="12.4.3" data-path="or-method-intro.html"><a href="or-method-intro.html#or-method-intro-pvalue-ci"><i class="fa fa-check"></i><b>12.4.3</b> p-value and confidence interval</a></li>
<li class="chapter" data-level="12.4.4" data-path="or-method-intro.html"><a href="or-method-intro.html#or-method-intro-single-reader-nh-validation"><i class="fa fa-check"></i><b>12.4.4</b> Null hypothesis validation</a></li>
<li class="chapter" data-level="12.4.5" data-path="or-method-intro.html"><a href="or-method-intro.html#or-method-intro-single-reader-application-roc"><i class="fa fa-check"></i><b>12.4.5</b> Application 1</a></li>
<li class="chapter" data-level="12.4.6" data-path="or-method-intro.html"><a href="or-method-intro.html#or-method-intro-single-reader-application-froc"><i class="fa fa-check"></i><b>12.4.6</b> Application 2</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="or-method-intro.html"><a href="or-method-intro.html#or-method-intro-single-treatment"><i class="fa fa-check"></i><b>12.5</b> Single-treatment multiple-reader</a><ul>
<li class="chapter" data-level="12.5.1" data-path="or-method-intro.html"><a href="or-method-intro.html#or-method-intro-single-treatment-overview"><i class="fa fa-check"></i><b>12.5.1</b> Overview</a></li>
<li class="chapter" data-level="12.5.2" data-path="or-method-intro.html"><a href="or-method-intro.html#st-or-multiple-reader"><i class="fa fa-check"></i><b>12.5.2</b> Significance testing</a></li>
<li class="chapter" data-level="12.5.3" data-path="or-method-intro.html"><a href="or-method-intro.html#st-or-multiple-reader-example-three"><i class="fa fa-check"></i><b>12.5.3</b> Special case</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="or-method-intro.html"><a href="or-method-intro.html#or-method-intro-multiple-reader-multiple-treatment"><i class="fa fa-check"></i><b>12.6</b> Multiple-reader multiple-treatment</a><ul>
<li class="chapter" data-level="12.6.1" data-path="or-method-intro.html"><a href="or-method-intro.html#StrCovMatrix"><i class="fa fa-check"></i><b>12.6.1</b> Structure of the covariance matrix</a></li>
<li class="chapter" data-level="12.6.2" data-path="or-method-intro.html"><a href="or-method-intro.html#PhysicalMeaningsOfCovMatrix"><i class="fa fa-check"></i><b>12.6.2</b> Physical meanings of the covariance terms</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="or-method-intro.html"><a href="or-method-intro.html#or-method-intro-summary"><i class="fa fa-check"></i><b>12.7</b> Summary</a></li>
<li class="chapter" data-level="12.8" data-path="or-method-intro.html"><a href="or-method-intro.html#or-method-intro-discussion"><i class="fa fa-check"></i><b>12.8</b> Discussion</a></li>
<li class="chapter" data-level="12.9" data-path="or-method-intro.html"><a href="or-method-intro.html#or-method-intro-elementary-stats"><i class="fa fa-check"></i><b>12.9</b> Appendix: Covariance and correlation</a><ul>
<li class="chapter" data-level="12.9.1" data-path="or-method-intro.html"><a href="or-method-intro.html#or-method-intro-elementary-stats-f-stat-chisq-stat"><i class="fa fa-check"></i><b>12.9.1</b> Relation: chisquare and F with infinite ddf</a></li>
<li class="chapter" data-level="12.9.2" data-path="or-method-intro.html"><a href="or-method-intro.html#or-method-intro-elementary-stats-def-cov-matrix"><i class="fa fa-check"></i><b>12.9.2</b> Definitions of covariance and correlation</a></li>
<li class="chapter" data-level="12.9.3" data-path="or-method-intro.html"><a href="or-method-intro.html#or-method-intro-elementary-stats-equal-variance"><i class="fa fa-check"></i><b>12.9.3</b> Special case when variables have equal variances</a></li>
<li class="chapter" data-level="12.9.4" data-path="or-method-intro.html"><a href="or-method-intro.html#or-method-intro-elementary-stats-est-cov-matrix"><i class="fa fa-check"></i><b>12.9.4</b> Estimating the variance-covariance matrix</a></li>
<li class="chapter" data-level="12.9.5" data-path="or-method-intro.html"><a href="or-method-intro.html#or-method-intro-elementary-stats-jack-var-inflation-factor"><i class="fa fa-check"></i><b>12.9.5</b> The variance inflation factor</a></li>
<li class="chapter" data-level="12.9.6" data-path="or-method-intro.html"><a href="or-method-intro.html#or-method-intro-elementary-stats-meaning-cov-matrix"><i class="fa fa-check"></i><b>12.9.6</b> Meaning of the covariance matrix</a></li>
<li class="chapter" data-level="12.9.7" data-path="or-method-intro.html"><a href="or-method-intro.html#or-method-intro-elementary-stats-code-cov-matrix"><i class="fa fa-check"></i><b>12.9.7</b> Code illustrating the covariance matrix</a></li>
<li class="chapter" data-level="12.9.8" data-path="or-method-intro.html"><a href="or-method-intro.html#or-method-intro-compare-dbm-or"><i class="fa fa-check"></i><b>12.9.8</b> Comparing DBM to Obuchowski and Rockette for single-reader multiple-treatments</a></li>
</ul></li>
<li class="chapter" data-level="12.10" data-path="or-method-intro.html"><a href="or-method-intro.html#or-method-intro-references"><i class="fa fa-check"></i><b>12.10</b> References</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="or-analysis-st.html"><a href="or-analysis-st.html"><i class="fa fa-check"></i><b>13</b> Obuchowski Rockette (OR) Analysis</a><ul>
<li class="chapter" data-level="13.1" data-path="or-analysis-st.html"><a href="or-analysis-st.html#or-analysis-st-how-much-finished"><i class="fa fa-check"></i><b>13.1</b> TBA How much finished</a></li>
<li class="chapter" data-level="13.2" data-path="or-analysis-st.html"><a href="or-analysis-st.html#or-analysis-st-introduction"><i class="fa fa-check"></i><b>13.2</b> Introduction</a></li>
<li class="chapter" data-level="13.3" data-path="or-analysis-st.html"><a href="or-analysis-st.html#or-analysis-st-rrrc"><i class="fa fa-check"></i><b>13.3</b> Random-reader random-case</a><ul>
<li class="chapter" data-level="13.3.1" data-path="or-analysis-st.html"><a href="or-analysis-st.html#TwoAnecdotes"><i class="fa fa-check"></i><b>13.3.1</b> Two anecdotes</a></li>
<li class="chapter" data-level="13.3.2" data-path="or-analysis-st.html"><a href="or-analysis-st.html#Hills-ddf"><i class="fa fa-check"></i><b>13.3.2</b> Hillis ddf</a></li>
<li class="chapter" data-level="13.3.3" data-path="or-analysis-st.html"><a href="or-analysis-st.html#decision-rule-p-value-and-confidence-interval"><i class="fa fa-check"></i><b>13.3.3</b> Decision rule, p-value and confidence interval</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="or-analysis-st.html"><a href="or-analysis-st.html#or-analysis-st-frrc"><i class="fa fa-check"></i><b>13.4</b> Fixed-reader random-case</a></li>
<li class="chapter" data-level="13.5" data-path="or-analysis-st.html"><a href="or-analysis-st.html#or-analysis-st-rrfc"><i class="fa fa-check"></i><b>13.5</b> Random-reader fixed-case</a></li>
<li class="chapter" data-level="13.6" data-path="or-analysis-st.html"><a href="or-analysis-st.html#or-analysis-st-single-treatment"><i class="fa fa-check"></i><b>13.6</b> Single treatment analysis</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="or-applications.html"><a href="or-applications.html"><i class="fa fa-check"></i><b>14</b> Obuchowski Rockette Applications</a><ul>
<li class="chapter" data-level="14.1" data-path="or-applications.html"><a href="or-applications.html#or-applications-how-much-finished"><i class="fa fa-check"></i><b>14.1</b> TBA How much finished</a></li>
<li class="chapter" data-level="14.2" data-path="or-applications.html"><a href="or-applications.html#or-applications-introduction"><i class="fa fa-check"></i><b>14.2</b> Introduction</a></li>
<li class="chapter" data-level="14.3" data-path="or-applications.html"><a href="or-applications.html#or-applications-dataset02-hand"><i class="fa fa-check"></i><b>14.3</b> Hand calculation</a><ul>
<li class="chapter" data-level="14.3.1" data-path="or-applications.html"><a href="or-applications.html#or-applications-RRRC-dataset02-hand"><i class="fa fa-check"></i><b>14.3.1</b> Random-Reader Random-Case (RRRC) analysis</a></li>
<li class="chapter" data-level="14.3.2" data-path="or-applications.html"><a href="or-applications.html#or-applications-FRRC-dataset02-hand"><i class="fa fa-check"></i><b>14.3.2</b> Fixed-Reader Random-Case (FRRC) analysis</a></li>
<li class="chapter" data-level="14.3.3" data-path="or-applications.html"><a href="or-applications.html#or-applications-RRFC-dataset02-hand"><i class="fa fa-check"></i><b>14.3.3</b> Random-Reader Fixed-Case (RRFC) analysis</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="or-applications.html"><a href="or-applications.html#or-applications-dataset02-RJafroc"><i class="fa fa-check"></i><b>14.4</b> RJafroc: dataset02</a><ul>
<li class="chapter" data-level="14.4.1" data-path="or-applications.html"><a href="or-applications.html#or-applications-RRRC-dataset02-RJafroc"><i class="fa fa-check"></i><b>14.4.1</b> Random-Reader Random-Case (RRRC) analysis</a></li>
<li class="chapter" data-level="14.4.2" data-path="or-applications.html"><a href="or-applications.html#or-applications-FRRC-dataset02-RJafroc"><i class="fa fa-check"></i><b>14.4.2</b> Fixed-Reader Random-Case (FRRC) analysis</a></li>
<li class="chapter" data-level="14.4.3" data-path="or-applications.html"><a href="or-applications.html#or-applications-RRFC-dataset02-RJafroc"><i class="fa fa-check"></i><b>14.4.3</b> Random-Reader Fixed-Case (RRFC) analysis</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="or-applications.html"><a href="or-applications.html#or-applications-dataset04-RJafroc"><i class="fa fa-check"></i><b>14.5</b> RJafroc: dataset04</a><ul>
<li class="chapter" data-level="14.5.1" data-path="or-applications.html"><a href="or-applications.html#or-applications-RRRC-dataset04"><i class="fa fa-check"></i><b>14.5.1</b> Random-Reader Random-Case (RRRC) analysis</a></li>
<li class="chapter" data-level="14.5.2" data-path="or-applications.html"><a href="or-applications.html#or-applications-FRRC-dataset04"><i class="fa fa-check"></i><b>14.5.2</b> Fixed-Reader Random-Case (FRRC) analysis</a></li>
<li class="chapter" data-level="14.5.3" data-path="or-applications.html"><a href="or-applications.html#or-applications-RRFC-dataset04"><i class="fa fa-check"></i><b>14.5.3</b> Random-Reader Fixed-Case (RRFC) analysis</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="or-applications.html"><a href="or-applications.html#or-applications-dataset04-FROC-RJafroc"><i class="fa fa-check"></i><b>14.6</b> RJafroc: dataset04, FROC</a><ul>
<li class="chapter" data-level="14.6.1" data-path="or-applications.html"><a href="or-applications.html#or-applications-RRRC-dataset04-FROC"><i class="fa fa-check"></i><b>14.6.1</b> Random-Reader Random-Case (RRRC) analysis</a></li>
<li class="chapter" data-level="14.6.2" data-path="or-applications.html"><a href="or-applications.html#or-applications-FRRC-dataset04-FROC"><i class="fa fa-check"></i><b>14.6.2</b> Fixed-Reader Random-Case (FRRC) analysis</a></li>
<li class="chapter" data-level="14.6.3" data-path="or-applications.html"><a href="or-applications.html#or-applications-RRFC-dataset04-FROC"><i class="fa fa-check"></i><b>14.6.3</b> Random-Reader Fixed-Case (RRFC) analysis</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="or-applications.html"><a href="or-applications.html#or-applications-dataset04-FROC-DBM-RJafroc"><i class="fa fa-check"></i><b>14.7</b> RJafroc: dataset04, FROC/DBM</a><ul>
<li class="chapter" data-level="14.7.1" data-path="or-applications.html"><a href="or-applications.html#or-applications-RRRC-dataset04-FROC-DBM"><i class="fa fa-check"></i><b>14.7.1</b> Random-Reader Random-Case (RRRC) analysis</a></li>
<li class="chapter" data-level="14.7.2" data-path="or-applications.html"><a href="or-applications.html#or-applications-FRRC-dataset04-FROC-DBM"><i class="fa fa-check"></i><b>14.7.2</b> Fixed-Reader Random-Case (FRRC) analysis</a></li>
<li class="chapter" data-level="14.7.3" data-path="or-applications.html"><a href="or-applications.html#or-applications-RRFC-dataset04-FROC-DBM"><i class="fa fa-check"></i><b>14.7.3</b> Random-Reader Fixed-Case (RRFC) analysis</a></li>
</ul></li>
<li class="chapter" data-level="14.8" data-path="or-applications.html"><a href="or-applications.html#or-applications-Summary"><i class="fa fa-check"></i><b>14.8</b> Summary</a></li>
<li class="chapter" data-level="14.9" data-path="or-applications.html"><a href="or-applications.html#or-applications-Discussion"><i class="fa fa-check"></i><b>14.9</b> Discussion</a></li>
<li class="chapter" data-level="14.10" data-path="or-applications.html"><a href="or-applications.html#ToMullOver1-tentative"><i class="fa fa-check"></i><b>14.10</b> Tentative</a></li>
<li class="chapter" data-level="14.11" data-path="or-applications.html"><a href="or-applications.html#or-applications-references"><i class="fa fa-check"></i><b>14.11</b> References</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="roc-sample-size-dbm.html"><a href="roc-sample-size-dbm.html"><i class="fa fa-check"></i><b>15</b> Sample size estimation: DBM method</a><ul>
<li class="chapter" data-level="15.1" data-path="roc-sample-size-dbm.html"><a href="roc-sample-size-dbm.html#roc-sample-size-dbm-how-much-finished"><i class="fa fa-check"></i><b>15.1</b> TBA How much finished</a></li>
<li class="chapter" data-level="15.2" data-path="roc-sample-size-dbm.html"><a href="roc-sample-size-dbm.html#roc-sample-size-dbm-introduction"><i class="fa fa-check"></i><b>15.2</b> Introduction</a></li>
<li class="chapter" data-level="15.3" data-path="roc-sample-size-dbm.html"><a href="roc-sample-size-dbm.html#StatPower1"><i class="fa fa-check"></i><b>15.3</b> Statistical Power</a><ul>
<li class="chapter" data-level="15.3.1" data-path="roc-sample-size-dbm.html"><a href="roc-sample-size-dbm.html#observed-vs.-anticipated-effect-size"><i class="fa fa-check"></i><b>15.3.1</b> Observed vs.Â anticipated effect-size</a></li>
<li class="chapter" data-level="15.3.2" data-path="roc-sample-size-dbm.html"><a href="roc-sample-size-dbm.html#roc-sample-size-dbm-dependence-of-stats-power"><i class="fa fa-check"></i><b>15.3.2</b> Dependence of statistical power on estimates of model parameters</a></li>
<li class="chapter" data-level="15.3.3" data-path="roc-sample-size-dbm.html"><a href="roc-sample-size-dbm.html#roc-sample-size-dbm-RRRC-sample-size-estimation"><i class="fa fa-check"></i><b>15.3.3</b> Formulae for random-reader random-case (RRRC) sample size estimation</a></li>
<li class="chapter" data-level="15.3.4" data-path="roc-sample-size-dbm.html"><a href="roc-sample-size-dbm.html#roc-sample-size-dbm-sig-testing"><i class="fa fa-check"></i><b>15.3.4</b> Significance testing</a></li>
<li class="chapter" data-level="15.3.5" data-path="roc-sample-size-dbm.html"><a href="roc-sample-size-dbm.html#roc-sample-size-dbm-pvalue-ci"><i class="fa fa-check"></i><b>15.3.5</b> p-value and confidence interval</a></li>
<li class="chapter" data-level="15.3.6" data-path="roc-sample-size-dbm.html"><a href="roc-sample-size-dbm.html#roc-sample-size-dbm-CompareDBM2OR"><i class="fa fa-check"></i><b>15.3.6</b> Comparing DBM to Obuchowski and Rockette for single-reader multiple-treatments</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="roc-sample-size-dbm.html"><a href="roc-sample-size-dbm.html#roc-sample-size-dbm-FRRC-sample-size-estimation"><i class="fa fa-check"></i><b>15.4</b> Formulae for fixed-reader random-case (FRRC) sample size estimation</a><ul>
<li class="chapter" data-level="15.4.1" data-path="roc-sample-size-dbm.html"><a href="roc-sample-size-dbm.html#roc-sample-size-dbm-RRFC-sample-size-estimation"><i class="fa fa-check"></i><b>15.4.1</b> Formulae for random-reader fixed-case (RRFC) sample size estimation</a></li>
<li class="chapter" data-level="15.4.2" data-path="roc-sample-size-dbm.html"><a href="roc-sample-size-dbm.html#roc-sample-size-dbm-FRRCAnalysis"><i class="fa fa-check"></i><b>15.4.2</b> Fixed-reader random-case (FRRC) analysis TBA</a></li>
<li class="chapter" data-level="15.4.3" data-path="roc-sample-size-dbm.html"><a href="roc-sample-size-dbm.html#roc-sample-size-dbm-RRFCAnalysis"><i class="fa fa-check"></i><b>15.4.3</b> Random-reader fixed-case (RRFC) analysis</a></li>
<li class="chapter" data-level="15.4.4" data-path="roc-sample-size-dbm.html"><a href="roc-sample-size-dbm.html#roc-sample-size-dbm-STMRAnalysis"><i class="fa fa-check"></i><b>15.4.4</b> Single-treatment multiple-reader analysis</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="roc-sample-size-dbm.html"><a href="roc-sample-size-dbm.html#discussionsummary2"><i class="fa fa-check"></i><b>15.5</b> Discussion/Summary/2</a></li>
<li class="chapter" data-level="15.6" data-path="roc-sample-size-dbm.html"><a href="roc-sample-size-dbm.html#roc-sample-size-dbm-references"><i class="fa fa-check"></i><b>15.6</b> References</a></li>
</ul></li>
<li class="part"><span><b>RJafroc Vignettes</b></span></li>
<li class="chapter" data-level="16" data-path="background-f-distribution.html"><a href="background-f-distribution.html"><i class="fa fa-check"></i><b>16</b> F-distribution</a><ul>
<li class="chapter" data-level="16.1" data-path="background-f-distribution.html"><a href="background-f-distribution.html#background-f-distribution-how-much-finished"><i class="fa fa-check"></i><b>16.1</b> TBA How much finished</a></li>
<li class="chapter" data-level="16.2" data-path="background-f-distribution.html"><a href="background-f-distribution.html#introduction"><i class="fa fa-check"></i><b>16.2</b> Introduction</a></li>
<li class="chapter" data-level="16.3" data-path="background-f-distribution.html"><a href="background-f-distribution.html#effect-of-ncp-for-ndf-2-and-ddf-10"><i class="fa fa-check"></i><b>16.3</b> Effect of <code>ncp</code> for <code>ndf</code> = 2 and <code>ddf</code> = 10</a></li>
<li class="chapter" data-level="16.4" data-path="background-f-distribution.html"><a href="background-f-distribution.html#comments"><i class="fa fa-check"></i><b>16.4</b> Comments</a><ul>
<li class="chapter" data-level="16.4.1" data-path="background-f-distribution.html"><a href="background-f-distribution.html#fig.-a"><i class="fa fa-check"></i><b>16.4.1</b> Fig. A</a></li>
<li class="chapter" data-level="16.4.2" data-path="background-f-distribution.html"><a href="background-f-distribution.html#fig.-b"><i class="fa fa-check"></i><b>16.4.2</b> Fig. B</a></li>
<li class="chapter" data-level="16.4.3" data-path="background-f-distribution.html"><a href="background-f-distribution.html#fig.-c"><i class="fa fa-check"></i><b>16.4.3</b> Fig. C</a></li>
<li class="chapter" data-level="16.4.4" data-path="background-f-distribution.html"><a href="background-f-distribution.html#fig.-d"><i class="fa fa-check"></i><b>16.4.4</b> Fig. D</a></li>
<li class="chapter" data-level="16.4.5" data-path="background-f-distribution.html"><a href="background-f-distribution.html#summary"><i class="fa fa-check"></i><b>16.4.5</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="background-f-distribution.html"><a href="background-f-distribution.html#effect-of-ncp-for-ndf-2-and-ddf-100"><i class="fa fa-check"></i><b>16.5</b> Effect of <code>ncp</code> for <code>ndf</code> = 2 and <code>ddf</code> = 100</a></li>
<li class="chapter" data-level="16.6" data-path="background-f-distribution.html"><a href="background-f-distribution.html#comments-1"><i class="fa fa-check"></i><b>16.6</b> Comments</a><ul>
<li class="chapter" data-level="16.6.1" data-path="background-f-distribution.html"><a href="background-f-distribution.html#fig.-e"><i class="fa fa-check"></i><b>16.6.1</b> Fig. E</a></li>
<li class="chapter" data-level="16.6.2" data-path="background-f-distribution.html"><a href="background-f-distribution.html#fig.-f"><i class="fa fa-check"></i><b>16.6.2</b> Fig. F</a></li>
<li class="chapter" data-level="16.6.3" data-path="background-f-distribution.html"><a href="background-f-distribution.html#fig.-g"><i class="fa fa-check"></i><b>16.6.3</b> Fig. G</a></li>
<li class="chapter" data-level="16.6.4" data-path="background-f-distribution.html"><a href="background-f-distribution.html#fig.-h"><i class="fa fa-check"></i><b>16.6.4</b> Fig. H</a></li>
</ul></li>
<li class="chapter" data-level="16.7" data-path="background-f-distribution.html"><a href="background-f-distribution.html#effect-of-ncp-for-ndf-1-ddf-100"><i class="fa fa-check"></i><b>16.7</b> Effect of <code>ncp</code> for <code>ndf</code> = 1, <code>ddf</code> = 100</a></li>
<li class="chapter" data-level="16.8" data-path="background-f-distribution.html"><a href="background-f-distribution.html#comments-2"><i class="fa fa-check"></i><b>16.8</b> Comments</a><ul>
<li class="chapter" data-level="16.8.1" data-path="background-f-distribution.html"><a href="background-f-distribution.html#fig.-i"><i class="fa fa-check"></i><b>16.8.1</b> Fig. I</a></li>
<li class="chapter" data-level="16.8.2" data-path="background-f-distribution.html"><a href="background-f-distribution.html#fig.-j"><i class="fa fa-check"></i><b>16.8.2</b> Fig. J</a></li>
<li class="chapter" data-level="16.8.3" data-path="background-f-distribution.html"><a href="background-f-distribution.html#fig.-k"><i class="fa fa-check"></i><b>16.8.3</b> Fig. K</a></li>
<li class="chapter" data-level="16.8.4" data-path="background-f-distribution.html"><a href="background-f-distribution.html#fig.-l"><i class="fa fa-check"></i><b>16.8.4</b> Fig. L</a></li>
</ul></li>
<li class="chapter" data-level="16.9" data-path="background-f-distribution.html"><a href="background-f-distribution.html#summary-1"><i class="fa fa-check"></i><b>16.9</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="roc-sample-size-or.html"><a href="roc-sample-size-or.html"><i class="fa fa-check"></i><b>17</b> Sample size estimation: OR method</a><ul>
<li class="chapter" data-level="17.1" data-path="roc-sample-size-or.html"><a href="roc-sample-size-or.html#roc-sample-size-or-how-much-finished"><i class="fa fa-check"></i><b>17.1</b> TBA How much finished</a></li>
<li class="chapter" data-level="17.2" data-path="roc-sample-size-or.html"><a href="roc-sample-size-or.html#roc-sample-size-or-introduction"><i class="fa fa-check"></i><b>17.2</b> Introduction</a></li>
<li class="chapter" data-level="17.3" data-path="roc-sample-size-or.html"><a href="roc-sample-size-or.html#StatPower2"><i class="fa fa-check"></i><b>17.3</b> Statistical Power</a><ul>
<li class="chapter" data-level="17.3.1" data-path="roc-sample-size-or.html"><a href="roc-sample-size-or.html#sample-size-estimation-for-random-reader-random-cases"><i class="fa fa-check"></i><b>17.3.1</b> Sample size estimation for random-reader random-cases</a></li>
<li class="chapter" data-level="17.3.2" data-path="roc-sample-size-or.html"><a href="roc-sample-size-or.html#roc-sample-size-or-dependence-of-stats-power"><i class="fa fa-check"></i><b>17.3.2</b> Dependence of statistical power on estimates of model parameters</a></li>
<li class="chapter" data-level="17.3.3" data-path="roc-sample-size-or.html"><a href="roc-sample-size-or.html#roc-sample-size-or-RRRC-sample-size-estimation"><i class="fa fa-check"></i><b>17.3.3</b> Formulae for random-reader random-case (RRRC) sample size estimation</a></li>
<li class="chapter" data-level="17.3.4" data-path="roc-sample-size-or.html"><a href="roc-sample-size-or.html#roc-sample-size-or-sig-testing"><i class="fa fa-check"></i><b>17.3.4</b> Significance testing</a></li>
<li class="chapter" data-level="17.3.5" data-path="roc-sample-size-or.html"><a href="roc-sample-size-or.html#roc-sample-size-or-pvalue-ci"><i class="fa fa-check"></i><b>17.3.5</b> p-value and confidence interval</a></li>
<li class="chapter" data-level="17.3.6" data-path="roc-sample-size-or.html"><a href="roc-sample-size-or.html#roc-sample-size-or-CompareDBM2OR"><i class="fa fa-check"></i><b>17.3.6</b> Comparing DBM to Obuchowski and Rockette for single-reader multiple-treatments</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="roc-sample-size-or.html"><a href="roc-sample-size-or.html#roc-sample-size-or-FRRC-sample-size-estimation"><i class="fa fa-check"></i><b>17.4</b> Formulae for fixed-reader random-case (FRRC) sample size estimation</a><ul>
<li class="chapter" data-level="17.4.1" data-path="roc-sample-size-or.html"><a href="roc-sample-size-or.html#roc-sample-size-or-RRFC-sample-size-estimation"><i class="fa fa-check"></i><b>17.4.1</b> Formulae for random-reader fixed-case (RRFC) sample size estimation</a></li>
<li class="chapter" data-level="17.4.2" data-path="roc-sample-size-or.html"><a href="roc-sample-size-or.html#example-1"><i class="fa fa-check"></i><b>17.4.2</b> Example 1</a></li>
<li class="chapter" data-level="17.4.3" data-path="roc-sample-size-or.html"><a href="roc-sample-size-or.html#roc-sample-size-or-FRRCAnalysis"><i class="fa fa-check"></i><b>17.4.3</b> Fixed-reader random-case (FRRC) analysis</a></li>
<li class="chapter" data-level="17.4.4" data-path="roc-sample-size-or.html"><a href="roc-sample-size-or.html#roc-sample-size-or-RRFCAnalysis"><i class="fa fa-check"></i><b>17.4.4</b> Random-reader fixed-case (RRFC) analysis</a></li>
<li class="chapter" data-level="17.4.5" data-path="roc-sample-size-or.html"><a href="roc-sample-size-or.html#roc-sample-size-or-STMRAnalysis"><i class="fa fa-check"></i><b>17.4.5</b> Single-treatment multiple-reader analysis</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="roc-sample-size-or.html"><a href="roc-sample-size-or.html#discussionsummary3"><i class="fa fa-check"></i><b>17.5</b> Discussion/Summary/3</a></li>
<li class="chapter" data-level="17.6" data-path="roc-sample-size-or.html"><a href="roc-sample-size-or.html#roc-sample-size-or-references"><i class="fa fa-check"></i><b>17.6</b> References</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="improper-rocs.html"><a href="improper-rocs.html"><i class="fa fa-check"></i><b>18</b> Improper ROC curves</a><ul>
<li class="chapter" data-level="18.1" data-path="improper-rocs.html"><a href="improper-rocs.html#improper-rocs-how-much-finished"><i class="fa fa-check"></i><b>18.1</b> TBA How much finished</a></li>
<li class="chapter" data-level="18.2" data-path="improper-rocs.html"><a href="improper-rocs.html#the-binormal-model"><i class="fa fa-check"></i><b>18.2</b> The binormal model</a></li>
<li class="chapter" data-level="18.3" data-path="improper-rocs.html"><a href="improper-rocs.html#improper-rocs-1"><i class="fa fa-check"></i><b>18.3</b> Improper ROCs</a></li>
<li class="chapter" data-level="18.4" data-path="improper-rocs.html"><a href="improper-rocs.html#reason-for-improper-rocs"><i class="fa fa-check"></i><b>18.4</b> Reason for improper ROCs</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="degenerate-rocs.html"><a href="degenerate-rocs.html"><i class="fa fa-check"></i><b>19</b> Degenerate ROC curves</a><ul>
<li class="chapter" data-level="19.1" data-path="degenerate-rocs.html"><a href="degenerate-rocs.html#two-helper-functions"><i class="fa fa-check"></i><b>19.1</b> Two helper functions</a></li>
<li class="chapter" data-level="19.2" data-path="degenerate-rocs.html"><a href="degenerate-rocs.html#degenerate-datasets"><i class="fa fa-check"></i><b>19.2</b> Degenerate datasets</a></li>
<li class="chapter" data-level="19.3" data-path="degenerate-rocs.html"><a href="degenerate-rocs.html#understanding-degenerate-datasets"><i class="fa fa-check"></i><b>19.3</b> Understanding degenerate datasets</a></li>
<li class="chapter" data-level="19.4" data-path="degenerate-rocs.html"><a href="degenerate-rocs.html#the-exact-fit-is-not-unique"><i class="fa fa-check"></i><b>19.4</b> The exact fit is not unique</a></li>
<li class="chapter" data-level="19.5" data-path="degenerate-rocs.html"><a href="degenerate-rocs.html#comments-on-degeneracy"><i class="fa fa-check"></i><b>19.5</b> Comments on degeneracy</a></li>
<li class="chapter" data-level="19.6" data-path="degenerate-rocs.html"><a href="degenerate-rocs.html#a-reasonable-fit-to-the-degenerate-dataset"><i class="fa fa-check"></i><b>19.6</b> A reasonable fit to the degenerate dataset</a></li>
</ul></li>
<li class="part"><span><b>Advanced topics</b></span></li>
<li class="chapter" data-level="20" data-path="proper-roc-models.html"><a href="proper-roc-models.html"><i class="fa fa-check"></i><b>20</b> Proper ROC models</a><ul>
<li class="chapter" data-level="20.1" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-how-much-finished"><i class="fa fa-check"></i><b>20.1</b> TBA How much finished</a></li>
<li class="chapter" data-level="20.2" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-introduction"><i class="fa fa-check"></i><b>20.2</b> Introduction</a></li>
<li class="chapter" data-level="20.3" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-likelihood-ratio-theorem1"><i class="fa fa-check"></i><b>20.3</b> Theorem: ROC slope equals likelihood ratio</a></li>
<li class="chapter" data-level="20.4" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-likelihood-ratio-theorem2"><i class="fa fa-check"></i><b>20.4</b> Theorem: likelihood ratio observer maximizes AUC</a><ul>
<li class="chapter" data-level="20.4.1" data-path="proper-roc-models.html"><a href="proper-roc-models.html#explanation"><i class="fa fa-check"></i><b>20.4.1</b> Explanation</a></li>
</ul></li>
<li class="chapter" data-level="20.5" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-proper-vs-improper"><i class="fa fa-check"></i><b>20.5</b> Proper vs.Â improper ROC curves</a></li>
<li class="chapter" data-level="20.6" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-degenerate-datasets"><i class="fa fa-check"></i><b>20.6</b> Degenerate datasets</a><ul>
<li class="chapter" data-level="20.6.1" data-path="proper-roc-models.html"><a href="proper-roc-models.html#comments-on-degeneracy-1"><i class="fa fa-check"></i><b>20.6.1</b> Comments on degeneracy</a></li>
</ul></li>
<li class="chapter" data-level="20.7" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-likelihood-ratio-observer"><i class="fa fa-check"></i><b>20.7</b> The likelihood ratio observer</a></li>
<li class="chapter" data-level="20.8" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-proproc"><i class="fa fa-check"></i><b>20.8</b> PROPROC</a><ul>
<li class="chapter" data-level="20.8.1" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-proproc-formulae"><i class="fa fa-check"></i><b>20.8.1</b> PROPROC formulae</a></li>
<li class="chapter" data-level="20.8.2" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-proproc-code"><i class="fa fa-check"></i><b>20.8.2</b> PROPROC code implementation</a></li>
<li class="chapter" data-level="20.8.3" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-proproc-rocs"><i class="fa fa-check"></i><b>20.8.3</b> PROPROC ROC and slope plots</a></li>
</ul></li>
<li class="chapter" data-level="20.9" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-cbm"><i class="fa fa-check"></i><b>20.9</b> The contaminated binormal model (CBM)</a><ul>
<li class="chapter" data-level="20.9.1" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-cbm-formulae"><i class="fa fa-check"></i><b>20.9.1</b> CBM formulae</a></li>
<li class="chapter" data-level="20.9.2" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-cbm-code"><i class="fa fa-check"></i><b>20.9.2</b> CBM code implementation</a></li>
<li class="chapter" data-level="20.9.3" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-cbm-rocs"><i class="fa fa-check"></i><b>20.9.3</b> CBM ROC plots</a></li>
<li class="chapter" data-level="20.9.4" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-cbm-pdfs"><i class="fa fa-check"></i><b>20.9.4</b> CBM pdf plots</a></li>
<li class="chapter" data-level="20.9.5" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-cbm-slopes"><i class="fa fa-check"></i><b>20.9.5</b> CBM likelihood ratio plots</a></li>
</ul></li>
<li class="chapter" data-level="20.10" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-bigamma"><i class="fa fa-check"></i><b>20.10</b> The bigamma model (BGM)</a><ul>
<li class="chapter" data-level="20.10.1" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-bigamma-formulae"><i class="fa fa-check"></i><b>20.10.1</b> BGM formulae</a></li>
<li class="chapter" data-level="20.10.2" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-bigamma-code"><i class="fa fa-check"></i><b>20.10.2</b> BGM code implementation</a></li>
<li class="chapter" data-level="20.10.3" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-bigamma-rocs"><i class="fa fa-check"></i><b>20.10.3</b> BGM ROC plots</a></li>
<li class="chapter" data-level="20.10.4" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-bigamma-pdfs"><i class="fa fa-check"></i><b>20.10.4</b> BGM pdf plots</a></li>
<li class="chapter" data-level="20.10.5" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-bigamma-slopes"><i class="fa fa-check"></i><b>20.10.5</b> BGM likelihood ratio plots</a></li>
</ul></li>
<li class="chapter" data-level="20.11" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-discussion"><i class="fa fa-check"></i><b>20.11</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="proproc-rocs.html"><a href="proproc-rocs.html"><i class="fa fa-check"></i><b>21</b> PROPROC ROC curves</a><ul>
<li class="chapter" data-level="21.1" data-path="proproc-rocs.html"><a href="proproc-rocs.html#helper-functions"><i class="fa fa-check"></i><b>21.1</b> Helper functions</a></li>
<li class="chapter" data-level="21.2" data-path="proproc-rocs.html"><a href="proproc-rocs.html#definitions-of-proproc-parameters-in-terms-of-binormal-model-parameters"><i class="fa fa-check"></i><b>21.2</b> Definitions of PROPROC parameters in terms of binormal model parameters</a></li>
<li class="chapter" data-level="21.3" data-path="proproc-rocs.html"><a href="proproc-rocs.html#main-code-and-output"><i class="fa fa-check"></i><b>21.3</b> Main code and output</a></li>
<li class="chapter" data-level="21.4" data-path="proproc-rocs.html"><a href="proproc-rocs.html#discussion"><i class="fa fa-check"></i><b>21.4</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="metz-eqn-36.html"><a href="metz-eqn-36.html"><i class="fa fa-check"></i><b>22</b> Metz Eqn 36 numerical check</a><ul>
<li class="chapter" data-level="22.1" data-path="metz-eqn-36.html"><a href="metz-eqn-36.html#helper-functions-1"><i class="fa fa-check"></i><b>22.1</b> Helper functions</a></li>
<li class="chapter" data-level="22.2" data-path="metz-eqn-36.html"><a href="metz-eqn-36.html#main-code-and-output-1"><i class="fa fa-check"></i><b>22.2</b> Main code and output</a></li>
<li class="chapter" data-level="22.3" data-path="metz-eqn-36.html"><a href="metz-eqn-36.html#discussion-1"><i class="fa fa-check"></i><b>22.3</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html"><i class="fa fa-check"></i><b>23</b> Bivariate binormal model</a><ul>
<li class="chapter" data-level="23.1" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-how-much-finished"><i class="fa fa-check"></i><b>23.1</b> TBA How much finished</a></li>
<li class="chapter" data-level="23.2" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-introduction"><i class="fa fa-check"></i><b>23.2</b> Introduction</a></li>
<li class="chapter" data-level="23.3" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-bivariate-density"><i class="fa fa-check"></i><b>23.3</b> Bivariate density function</a></li>
<li class="chapter" data-level="23.4" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-formulae"><i class="fa fa-check"></i><b>23.4</b> The bivariate binormal model</a></li>
<li class="chapter" data-level="23.5" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-multivariate-density-visualization"><i class="fa fa-check"></i><b>23.5</b> Visualizing the bivariate density function</a></li>
<li class="chapter" data-level="23.6" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-multivariate-density-estimation"><i class="fa fa-check"></i><b>23.6</b> Estimating bivariate binormal model parameters</a></li>
<li class="chapter" data-level="23.7" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-multivariate-density-examples"><i class="fa fa-check"></i><b>23.7</b> Examples of bivariate normal probability integrals</a><ul>
<li class="chapter" data-level="23.7.1" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-multivariate-density-estimation-code"><i class="fa fa-check"></i><b>23.7.1</b> Code listing</a></li>
<li class="chapter" data-level="23.7.2" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-examples-integrals"><i class="fa fa-check"></i><b>23.7.2</b> Examples of bivariate normal probability integrals</a></li>
</ul></li>
<li class="chapter" data-level="23.8" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-likelihood"><i class="fa fa-check"></i><b>23.8</b> Likelihood function</a></li>
<li class="chapter" data-level="23.9" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-corroc2"><i class="fa fa-check"></i><b>23.9</b> CORROC2 software</a><ul>
<li class="chapter" data-level="23.9.1" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-corroc2-details"><i class="fa fa-check"></i><b>23.9.1</b> Details of CORROC2 software</a></li>
<li class="chapter" data-level="23.9.2" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-corroc2-data-input"><i class="fa fa-check"></i><b>23.9.2</b> CORROC2 data input</a></li>
<li class="chapter" data-level="23.9.3" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-corroc2-output"><i class="fa fa-check"></i><b>23.9.3</b> CORROC2 output</a></li>
<li class="chapter" data-level="23.9.4" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-corroc2-covariance-matrix"><i class="fa fa-check"></i><b>23.9.4</b> Covariance matrix</a></li>
<li class="chapter" data-level="23.9.5" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-corroc2-output-restof"><i class="fa fa-check"></i><b>23.9.5</b> Rest of CORROC2 output</a></li>
</ul></li>
<li class="chapter" data-level="23.10" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-corroc2-application"><i class="fa fa-check"></i><b>23.10</b> Application to a real dataset</a><ul>
<li class="chapter" data-level="23.10.1" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-corroc2-application-code-output"><i class="fa fa-check"></i><b>23.10.1</b> Code Output</a></li>
<li class="chapter" data-level="23.10.2" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-corroc2-application-debug-window"><i class="fa fa-check"></i><b>23.10.2</b> Contents of the Debug window, as viewed from the Mac side</a></li>
<li class="chapter" data-level="23.10.3" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-corroc2-application-corrocii-input"><i class="fa fa-check"></i><b>23.10.3</b> Contents of CorrocIIinput.txt</a></li>
</ul></li>
<li class="chapter" data-level="23.11" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-corroc2-discussion"><i class="fa fa-check"></i><b>23.11</b> Discussion / Summary</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The RJafroc Roc Book</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="proper-roc-models" class="section level1 hasAnchor">
<h1><span class="header-section-number">Chapter 20</span> Proper ROC models<a href="proper-roc-models.html#proper-roc-models" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="proper-roc-models-how-much-finished" class="section level2 hasAnchor">
<h2><span class="header-section-number">20.1</span> TBA How much finished<a href="proper-roc-models.html#proper-roc-models-how-much-finished" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>50%</p>
</div>
<div id="proper-roc-models-introduction" class="section level2 hasAnchor">
<h2><span class="header-section-number">20.2</span> Introduction<a href="proper-roc-models.html#proper-roc-models-introduction" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>So far, two methods have been described for fitting curves to ROC operating points, namely the (unequal variance) binormal model, book Chapter 06 and the radiological search model (RSM), book Chapter 16. The binormal model has been widely used to fit ROC operating points in many studies, dating to the early 1960s, and in a wide range of applications that are not just limited to medical imaging. It is a two-parameter model, i.e., <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span>, excluding threshold parameters. However, binormal model fits almost invariably lead to ROC curves that inappropriately cross the chance diagonal, leading to a prediction of a region of the ROC curve where performance is worse than chance, even for expert observers. By convention, such curves are termed âimproperâ. A chance line crossing near the upper right corner, which occurs when <span class="math inline">\(b &lt; 1\)</span>, and the fact that the ROC curve must eventually reach (1, 1) implies the curve must turn upwards as one approaches (1, 1), thereby displaying a âhookâ. The hook occurs near the origin if <span class="math inline">\(b &gt; 1\)</span>. Since <span class="math inline">\(b\)</span> is a continuous-variable parameter, there is zero probability that an estimate of <span class="math inline">\(b\)</span> will be exactly equal to one, the only condition under which there is no âhookâ. <em>Therefore, every fitted binormal model ROC curve is improper.</em></p>
<p>The improper behavior is often not readily visible. One may need to âzoom-inâ on the upper-right corner to see it. This has been used as an argument for minimizing its importance / relevance <span class="citation">(Metz <a href="#ref-metz1978rocmethodology" role="doc-biblioref">1978</a>)</span>. In my judgment, any fit that predicts worse than chance level performance anywhere on the ROC plot, visible or not, is scientifically indefensible. Quite appropriately much effort has gone into developing models that always predict proper ROC curves, i.e., those that do not drop below the chance diagonal. These are called âproperâ ROC curves (some of literature uses the quotes and some does not). There are at least four methods for fitting proper ROC curves, and these are listed in reverse chronological order.</p>
<ul>
<li><p>The most recent (2016) one <span class="citation">(Chakraborty and Svahn <a href="#ref-chakraborty2011estimating" role="doc-biblioref">2011</a>; Chakraborty, Yoon, and Mello-Thoms <a href="#ref-chakraborty2012inverse" role="doc-biblioref">2012</a>)</span> is based on the radiological search model (RSM), which is implemented in the <code>RJafroc</code> package, as described in book Chapter 18.</p></li>
<li><p>Next, (2000) is a method <span class="citation">(Donald D Dorfman, Berbaum, and Brandser <a href="#ref-dorfman2000contaminated1" role="doc-biblioref">2000</a>; Donald D Dorfman and Berbaum <a href="#ref-dorfman2000contaminated2" role="doc-biblioref">2000</a><a href="#ref-dorfman2000contaminated2" role="doc-biblioref">b</a>, <a href="#ref-dorfman2000contaminated3" role="doc-biblioref">2000</a><a href="#ref-dorfman2000contaminated3" role="doc-biblioref">a</a>)</span> based on the contaminated binormal model (CBM), available as part of DBM-MRMC software from a University of Iowa website and which is implemented in the <code>RJafroc</code> package.</p></li>
<li><p>Next, (1999) is the binormal model-based proper ROC fitting algorithm <span class="citation">(Metz and Pan <a href="#ref-metz1999proper" role="doc-biblioref">1999</a>; Pan and Metz <a href="#ref-pan1997proper" role="doc-biblioref">1997</a>)</span> developed by Metz and Pan, implemented in PROPROC software available as part of DBM-MRMC software.</p></li>
<li><p>Next, (1997) is the bigamma model <span class="citation">(Dorfman et al. <a href="#ref-dorfman1997proper" role="doc-biblioref">1997</a>)</span> fitting algorithm for which no software currently exists as far as I am aware.</p></li>
<li><p>Next, (1996) is LROCFIT, based on the location ROC (LROC) paradigm <span class="citation">(Swensson <a href="#ref-swensson1996unified" role="doc-biblioref">1996</a>)</span>, which also predicts proper ROC curves, but the data has to be acquired according to the LROC paradigm, while all of the other methods described in this chapter, and in book Chapter 18, work with ROC data.</p></li>
</ul>
<p>A related issue is data degeneracy that occurs when a reader fails to provide an interior ROC point, i.e., a point that lies inside the ROC unit-square, as distinct from points on the axes. The binormal model is unable to yield reasonable fits to such data (which tend to be generated by experts; for example the perfect radiologist will detect lesions without generating any false positives, leading to a point on the y-axis). Inability to fit a dataset means the researcher has no option but to discard them or use empirical methods. The CBM and RSM methods are able to fit degenerate datasets. It has been claimed incorrectly, as shown below, that PROPROC can fit degenerate datasets â it cannot.</p>
<p>There is a theorem relating the slope of a general ROC curve, independent of model assumptions, to a quantity called the <em>likelihood ratio</em>. This will lead to the distinction between âproperâ and âimproperâ ROC curves. Needed first is an understanding of the likelihood ratio and demonstration (not a proof) of an important theorem, namely <em>the slope of the ROC curve always equals the likelihood ratio, independent of parametric assumptions</em>.</p>
</div>
<div id="proper-roc-models-likelihood-ratio-theorem1" class="section level2 hasAnchor">
<h2><span class="header-section-number">20.3</span> Theorem: ROC slope equals likelihood ratio<a href="proper-roc-models.html#proper-roc-models-likelihood-ratio-theorem1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><span class="math display" id="eq:proper-roc-models-binormal-model">\[\begin{equation} 
\left.\begin{aligned}
\text{FPF}&amp;=\Phi\left( -z \right)\\
\text{TPF}&amp;=\Phi\left( a-bz \right)
\end{aligned}\right\}
\tag{20.1}
\end{equation}\]</span></p>
<p>The slope <span class="math inline">\(m\)</span> of the ROC curve is:</p>
<p><span class="math display" id="eq:proper-roc-models-slope">\[\begin{equation} 
\left.\begin{aligned}
m\left( z|a,b \right)&amp;=\frac{\frac{\partial \left( TPF \right)}{\partial z}}{\frac{\partial \left( FPF \right)}{\partial z}}\\ 
&amp;=\frac{b\phi\left( a-bz \right)}{\phi\left( -z \right)}\\ 
&amp;=b\exp\left( -\frac{1}{2} \left[ \left( bz-a \right)^2 \right]-z^2\right)
\end{aligned}\right\}
\tag{20.2}
\end{equation}\]</span></p>
<p>The probability density functions (pdfs) for the binormal model were defined in TBA Eqn. (6.23) and TBA Eqn. (6.24) and for convenience are reproduced here (N = non-diseased, D = diseased):</p>
<p><span class="math display" id="eq:proper-roc-models-pdfs">\[\begin{equation} 
\left.\begin{aligned}
\text{pdf}_N\left( z \right) &amp;= \frac{1}{\sqrt{2\pi}}\exp\left( -\frac{z^2}{2} \right) \\
\text{pdf}_D\left( z \right) &amp;= \frac{b}{\sqrt{2\pi}}\exp\left( -\frac{\left( bz-a \right)^2}{2} \right) \\
\end{aligned}\right\}
\tag{20.3}
\end{equation}\]</span></p>
<p>The likelihood ratio is defined by (the subscript âBINâ is for âbinormal modelâ):</p>
<p><span class="math display" id="eq:proper-roc-models-likelihood-ratio">\[\begin{equation} 
\left.\begin{aligned}
l_{BIN}\left( z | a,b\right) &amp;= \frac{\text{pdf}_D\left( z \right)}{\text{pdf}_N\left( z \right)} \\
&amp;= b\exp\left( -\frac{\left( bz-a \right)^2 -z^2}{2} \right) \\
\end{aligned}\right\}
\tag{20.4}
\end{equation}\]</span></p>
<p>It is seen from Eqn. <a href="proper-roc-models.html#eq:proper-roc-models-slope">(20.2)</a> and Eqn. <a href="proper-roc-models.html#eq:proper-roc-models-likelihood-ratio">(20.4)</a> that the likelihood ratio equals the slope of the ROC curve:</p>
<p><span class="math display" id="eq:proper-roc-models-likelihood-ratio-theorem">\[\begin{equation} 
l_{BIN}\left( z | a,b\right) = m\left( z | a,b\right)
\tag{20.5}
\end{equation}\]</span></p>
<p>While illustrated for the binormal model, this theorem is actually independent of any distributional assumptions <span class="citation">(Egan <a href="#ref-Egan1975" role="doc-biblioref">1975</a><a href="#ref-Egan1975" role="doc-biblioref">b</a>)</span>. The reason for the name âlikelihood ratioâ is that early researchers in the field, mostly psychophysicists, used the term âlikelihood functionâ for what statisticians term âprobability density functionâ. Hence the ratio of two likelihood functions was termed a âlikelihood ratioâ, when in fact it is a ratio of two pdfs. The likelihood ratio should never be confused with the likelihood function defined in Book Chapter 06, which is the probability of an observed dataset, given a set of parameter values, and which is the starting point of maximum likelihood estimation methods.</p>
</div>
<div id="proper-roc-models-likelihood-ratio-theorem2" class="section level2 hasAnchor">
<h2><span class="header-section-number">20.4</span> Theorem: likelihood ratio observer maximizes AUC<a href="proper-roc-models.html#proper-roc-models-likelihood-ratio-theorem2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>An observer who maximizes TPF for a given FPF, for all values of FPF in the range (0,1), is called a Neyman-Pearson observer <span class="citation">(Neyman and Pearson <a href="#ref-neyman1933ix" role="doc-biblioref">1933</a>)</span>. It can be shown that the Neyman-Pearson observer uses the likelihood ratio as the decision variable <span class="citation">(Green, Swets, and others <a href="#ref-green1966signal" role="doc-biblioref">1966</a>)</span>. The proof is a little involved and will not be repeated here. A mathematical description is found in the book <span class="citation">(Barrett and Myers <a href="#ref-barrett2013foundations" role="doc-biblioref">2013</a>)</span> by Barrett and Myers, Section 13.2.6. <em>A consequence of the theorem is that AUC for a likelihood ratio observer represents an upper limit on performance, and such an observer is called an âideal observerâ and an observer using the likelihood ratio as the decision variable always yields proper ROC curves.</em></p>
<div id="explanation" class="section level3 hasAnchor">
<h3><span class="header-section-number">20.4.1</span> Explanation<a href="proper-roc-models.html#explanation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>So far the decision rule has been, book Chapter 03, that if the z-sample for a case is equal to or greater than threshold <span class="math inline">\(\zeta\)</span> the case is diagnosed as diseased, and otherwise it is diagnosed as non-diseased. The likelihood ratio involves a deeper concept. It is assumed that the observer is aware of the distribution of the z-samples for diseased and non-diseased cases, i.e., the observer knows the pdfs as a function of z. Then, for an observed value of z for a particular case, the observer computes the pdf for the diseased distribution at that value of z, namely <span class="math inline">\(\text{pdf}_D(z)\)</span> and does the same for the non-diseased distribution <span class="math inline">\(\text{pdf}_N(z)\)</span>. Assuming equal numbers of diseased and non-diseased cased, if <span class="math inline">\(\text{pdf}_D\left( z \right) \ge \text{pdf}_N\left( z \right)\)</span>, which is equivalent to <span class="math inline">\(l(z) \ge 1\)</span>, it is more probable that the case is diseased, and if the reverse is true if <span class="math inline">\(l(z) &lt; 1\)</span>. In other words, the likelihood ratio observer does not merely use the z-sample to make decisions. Instead, the observer uses the observed z-sample and knowledge of the value of the two pdfs at the observed value of z to compute the ratio <span class="math inline">\(l(z)\)</span> and only if the ratio is equal or greater than some preset value <span class="math inline">\(\lambda\)</span>, the case is diagnosed as diseased and otherwise the case is diagnosed as non-diseased.</p>
<p>A word on notation: I am attempting to be consistent: when the decision variable was <span class="math inline">\(z\)</span>, I used the corresponding Greek character to denote a threshold on that axis. Since likelihood ratio is denoted <span class="math inline">\(l\)</span>, the corresponding Greek character is <span class="math inline">\(]\lambda\)</span>.<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a></p>
<p>So in effect, the observer has transformed the decision variable <span class="math inline">\(z\)</span> to a new variable <span class="math inline">\(l\)</span> defined by <span class="math inline">\(l \equiv \frac{\text{pdf}_D\left( z \right)}{\text{pdf}_N\left( z \right)}\)</span> , and the new variable is used for making decisions. Varying <span class="math inline">\(\lambda\)</span> allows the observer to move along the resulting <em>likelihood ratio ROC curve</em>, which has the âproperâ property. The value of <span class="math inline">\(\lambda\)</span> used by the observer is determined by the disease prevalence and the costs and benefits of incorrect (FN and FP) and correct decisions (TP and TN). Assuming equal costs, benefits, and disease prevalence of 0.5, the observer will select <span class="math inline">\(\lambda = 1\)</span> as the operating point. If on the other hand disease-prevalence is 0.1, the observer will adopt a higher value of <span class="math inline">\(\lambda\)</span>, corresponding to moving down the ROC curve, to decrease FPF.</p>
<p>If decision variable z results in improper ROC curves, as does the z-sample in the binormal model, the transformation will not be monotonic.<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a> If the transformation were monotonic, that would imply that z was already equivalent to the likelihood ratio, since a monotonic transformation exists that relates the two. As was learned from earlier chapters, the ROC curve is invariant to monotonic transformations of the decision variable. If the z-sample from a different model, e.g., the highest rating sample of the RSM, always yields proper ROC curves, book Chapter 17, then it must already be equivalent to the likelihood ratio.</p>
<p>To summarize these concepts in equations, the likelihood ratio observer transforms z to l:</p>
<p><span class="math display" id="eq:proper-roc-models-likelihood-ratio-definition">\[\begin{equation} 
l\left( z \right) \equiv  \frac{\text{pdf}_D\left( z \right)}{\text{pdf}_N\left( z \right)}
\tag{20.6}
\end{equation}\]</span></p>
<p>Then the decision variable <span class="math inline">\(M\left( l\left( z \right) \right)\)</span> will yield a proper ROC curve. Here <span class="math inline">\(M\left( \right)\)</span> is an arbitrary monotone increasing function of its argument, i.e.Â if <span class="math inline">\(x_2 &gt; x_1\)</span>:</p>
<p><span class="math display" id="eq:proper-roc-models-definition-monotonic">\[\begin{equation} 
M\left( x_2 \right) \ge M\left( x_1 \right) 
\tag{20.7}
\end{equation}\]</span></p>
<p>More accurately, âincreasingâ should be replaced by ânon-decreasingâ; i.e., the transformation allows flat portions.</p>
</div>
</div>
<div id="proper-roc-models-proper-vs-improper" class="section level2 hasAnchor">
<h2><span class="header-section-number">20.5</span> Proper vs.Â improper ROC curves<a href="proper-roc-models.html#proper-roc-models-proper-vs-improper" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If <span class="math inline">\(b=1\)</span>,</p>
<p><span class="math display" id="eq:proper-roc-models-b-equal-1">\[\begin{equation} 
m\left( z|a,b=1 \right)=\exp\left( -\frac{1}{2} \left[ \left( a^2-2az \right)^2 \right]\right)
\tag{20.8}
\end{equation}\]</span></p>
<p>At <span class="math inline">\(z=-\infty\)</span> the slope is zero and at <span class="math inline">\(z=+\infty\)</span> the slope is infinite. This is reasonable behavior: the ROC curve starts out at the origin with infinite slope and gradually bends down and eventually approaches (1, 1) with zero slope. This is an example of a âproperâ ROC. However, if <span class="math inline">\(0 &lt; b &lt; 1\)</span>, which is true for most datasets (clinical or not <span class="citation">(Green, Swets, and others <a href="#ref-green1966signal" role="doc-biblioref">1966</a>)</span>), the slope is infinite at the origin, which is fine, <em>and</em> at (1, 1), which spells trouble. For the ROC curve to have started out at the origin with infinite slope and then approach (1, 1), again with infinite slope, means that at some intermediate point it must have crossed the chance diagonal. This behavior, termed âthe hookâ, generally occurs just below the upper right corner, Plot A in Fig. <a href="proper-roc-models.html#fig:proper-roc-models-plots-1">20.1</a>. If <span class="math inline">\(b &gt; 1\)</span> the binormal model predicts that the slope is zero near the origin, which means the ROC curve starts out below the chance diagonal, in other words the âhookâ is still there, but it occurs just above the origin, Plot B in Fig. <a href="proper-roc-models.html#fig:proper-roc-models-plots-1">20.1</a>. Usually, Plots C and D in Fig. <a href="proper-roc-models.html#fig:proper-roc-models-plots-1">20.1</a>, the hook is not readily visible unless one âzooms inâ on the part near the top-right corner.</p>
<div class="figure"><span style="display:block;" id="fig:proper-roc-models-plots-1"></span>
<img src="20a-proper-roc-models_files/figure-html/proper-roc-models-plots-1-1.png" alt="Predicted improper ROC curves: top-left is for a = 0.7, b = 0.5, top-right is for a = 0.7, b = 1.5, bottom-left is for a = 1.5, b = 0.5 and bottom-right is for a = 2, b = 0.5." width="672" />
<p class="caption">
FIGURE 20.1: Predicted improper ROC curves: top-left is for a = 0.7, b = 0.5, top-right is for a = 0.7, b = 1.5, bottom-left is for a = 1.5, b = 0.5 and bottom-right is for a = 2, b = 0.5.
</p>
</div>
</div>
<div id="proper-roc-models-degenerate-datasets" class="section level2 hasAnchor">
<h2><span class="header-section-number">20.6</span> Degenerate datasets<a href="proper-roc-models.html#proper-roc-models-degenerate-datasets" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Metz2 defined binormal degenerate data sets as those that result in exact-fit binormal ROC curves of inappropriate shape consisting of a series of horizontal and/or vertical line segments in which the ROC âcurveâ crosses the chance line. The crossing of the chance line occurs because the degenerate data sets can be fitted exactly by infinite or zero values for the model slope parameter b, and infinite values for the decision thresholds, or both. To understand this, consider that the non-diseased distribution is a Dirac delta function centered at zero (by definition such a function integrates to unity), and the unit variance diseased distribution is centered at 0.6744898. In other words this binormal model is characterized by a = 0.6744898 and b = zero and the two distributions consist of a delta function at z = zero and a unit normal centered at z = a. What is the expected ROC curve? As the threshold is moved from the far right, gradually to the left, TPF will increase but FPF will be stuck at zero until the threshold reaches zero. Just before reaching this point, the coordinates of the ROC operating point are (0, 0.75). The 0.75 is due to the fact that z = zero is -0.6744898 units relative to the center of the diseased distribution, so the area under the diseased distribution below z = zero is . Since pnorm is giving the probability below the threshold, TPF must be its complement, namely 0.75. This explains the operating point (0,0.75), which lies on the y-axis. As the threshold crosses the zero-width delta function, FPF shoots up from 0 to 1, but TPF stays constant. Therefore, the operating point has jumped from (0, 0.75) to (1, 0.75). When the threshold is reduced further, the operating point moves up vertically, along the right side of the ROC plot, until the threshold is so small that virtually all of diseased distribution exceeds it and the operating point reaches (1, 1). The ROC curve is illustrated in Fig. 20.3 (A). This is an extreme example of an ROC curve with a âhookâ. If the data is such that the only operating point provided by the observer is (0,0.75) then this curve will be an exact fit to the data point. An example of such a dataset is in Table 20.1.</p>
<p>Actually, given one operating point (0, 0.75) the preceding fit is not even unique. If the diseased distribution is shifted appropriately to the right of its previous position, and one can determine the necessary value of a, then the ROC curve will shoot upwards through the operating point (0, 0.75) to (0, 0.9), as in Fig. 20.3 (B), before proceeding horizontally to (1, 0.9) and then completing the curve to (1, 1). If the diseased distribution is shifted well to the right, i.e., a is very large, then the ROC curve will shoot upwards past the operating point, as in Fig. 20.3 (C), all the way to (0,1) before proceeding horizontally to (1, 1). All of these represent maximum likelihood fits, albeit with b = zero, and different values of a. Not one of them is reasonable.</p>
<p>Restricting to the more common situation, the reason for the hook can be appreciated from Fig. 20.2 (B) showing the pdf functions for non-diseased and diseased cases as functions of z. The plot corresponds to the same parameter value that generated Fig. 20.1(A). Since , the diseased pdf is broader and has a lower peak (since the integrals under each distribution are unity) than the non-diseased pdf. Sliding an imaginary threshold to the left, starting from the extreme right, one sees that initially, just below z = 7, the diseased distribution starts being âpicked upâ while the non-diseased distribution is not âpicked upâ, causing the ROC, Fig. 20.2 (A), to start with infinite slope near the origin (because TPF increases while FPF does not). Around z = 2.5 the non-diseased distribution starts being âpicked upâ, causing the ROC slope to decrease. Around z = -3, almost all of the non-diseased distribution has been âpicked upâ which mean FPF is near unity, but since not all of the broader diseased distribution has been âpicked upâ, TPF is less than unity. Here is a region where TPF &lt; FPF, meaning the operating point is below the chance diagonal. As the threshold is lowered further, TPF continues to increase, as the rest of the diseased distribution is âpicked upâ while FPF stays almost constant at unity. In this region, the ROC curve is approaching the upper right corner with almost infinite slope (because TPF is increasing but FPF is not).</p>
<div id="comments-on-degeneracy-1" class="section level3 hasAnchor">
<h3><span class="header-section-number">20.6.1</span> Comments on degeneracy<a href="proper-roc-models.html#comments-on-degeneracy-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>ratings" is going to convince this observer to rate with twos, threes and fours any of the 75 easy diseased cases. If the cases are obviously diseased, and that is what the author means by âeasy casesâ, they are supposed to be rated fives: âdefinitely diseasedâ. Forcing them to rate some of them as âprobably diseasedâ or âpossibly diseasedâ would be irrational and guilty of bending the reading paradigm to fit the convenience of the researcher.</p>
<p>Faced with a degenerate data set the binormal model is unable to yield a reasonable and unique ROC curve Fig. 20.3 (A-C). Essentially the analyst has to discard the readerâs dataset (or abandon the binormal model in favor of empirical AUCs â which come with their own issues) â always a bad idea. Discarding a dataset just because the model is unable to fit it is a failing of the model, and an expensive failing at that, because radiologist generated operating points do not come cheap. Furthermore, degenerate datasets are more likely with expert observers. This follows from the fact that what is an obvious diseased case to an expert may not be obvious to a less experienced observer. The latter observer is likely to apply the two, three and four ratings to some of the 75 cases that were obviously diseased to the expert. Therefore, the less experienced observer is more likely to provide a number of interior data points, and the binormal model would fit their data without encountering degeneracy problems. The result is to âscreen-outâ expert radiologists in favor of those with less expertise.</p>
<p>One could argue that the choice of dataset, with a mixture of very easy and very difficult, was incorrect. One should have chosen a more mixed dataset. The counter argument is what if the population consists of these types of bimodal cases. Any sample from such a population would be expected to yield degenerate datasets. A âbullet-proofâ model should be able to deal with the data as it comes, and not be restricted to datasets that are convenient to the model. As a general scientific principle, the model should accommodate the data, not vise-versa.</p>
<p>If the dataset yields a single operating point (0, 0.75), what is a reasonable ROC plot? There is a theorem that given an observed operating point, the line connecting that point to (1, 1) represents a lower bound on achievable performance by the observer. The lower bound is achieved by the observer using a guessing mechanism to classify the remaining cases. Here is an elaboration on this theorem. Having rated the 75 easy diseased cases as fives, the observer is left with 25 diseased cases and 100 non-diseased cases, all 125 of which look non-diseased to the observer. Suppose the observer randomly rates 20% of the remaining cases as fours. This would pick up five of the actually diseased cases and 20 non-diseased ones. Therefore, the total number of diseased cases rated four or higher is 80, and the corresponding number of non-diseased cases is 20. The new operating point of the observer is (0.20, 0.80). Now, one has two operating points, the original one on the y-axis at (0, 0.75) and an interior point (0.20, 0.80). Next, instead of randomly rating 20% of the remaining cases as fours, the observer rates 40% of them as fours, then the interior point would have been (0.40, 0.85). The reader can appreciate that simply by increasing the fraction of remaining cases that are randomly rated fours, the observer can move along the straight line connecting (0, 0.75) and (1, 1), as in Fig. 20.3 (D). Since a guessing mechanism is being used, this must represent a lower bound on performance. The resulting ROC curve is proper and the net AUC = 0.875. This is in fact the fit yielded by the CBM and RSM models for this dataset. The empirical AUC also yields this result.</p>
<p>Why should one select the lowest possible performance consistent with the data? Because it yields a unique value for performance and higher performance is both not unique, Fig. 20.3 (A-D), and is guilty of extrapolating outside the data.</p>
</div>
</div>
<div id="proper-roc-models-likelihood-ratio-observer" class="section level2 hasAnchor">
<h2><span class="header-section-number">20.7</span> The likelihood ratio observer<a href="proper-roc-models.html#proper-roc-models-likelihood-ratio-observer" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>An observer using the likelihood ratio, or any monotonic transformation of it, as the decision variable, is termed a likelihood ratio observer.</strong> This is worthy of some illustrations, Fig. <a href="proper-roc-models.html#fig:proper-roc-models-plots-2">20.2</a> Plots A-F, all of which apply to <span class="math inline">\(a = 0.7\)</span> and <span class="math inline">\(b = 0.5\)</span>. The ordinate is labeled <span class="math inline">\(\text{lr}\)</span>, for <em>likelihood ratio</em>, identical to <span class="math inline">\(l\)</span> in the equations, i.e., the slope of the ROC.</p>
<div class="figure"><span style="display:block;" id="fig:proper-roc-models-plots-2"></span>
<img src="20a-proper-roc-models_files/figure-html/proper-roc-models-plots-2-1.png" alt="These plots of slopes $\text{lr}$ of the ROC curves as functions of z all apply to $a = 0.7, b = 0.5$. They correspond to different ranges along the z-axis, starting with a 'birds-eye' view (A, top left) and gradually focusing in on the region near the minimum (F, bottom right). " width="672" />
<p class="caption">
FIGURE 20.2: These plots of slopes <span class="math inline">\(\text{lr}\)</span> of the ROC curves as functions of z all apply to <span class="math inline">\(a = 0.7, b = 0.5\)</span>. They correspond to different ranges along the z-axis, starting with a âbirds-eyeâ view (A, top left) and gradually focusing in on the region near the minimum (F, bottom right).
</p>
</div>
<p>For now focus on Plot A in Fig. <a href="proper-roc-models.html#fig:proper-roc-models-plots-2">20.2</a> in which range of z is: -5 to 8. Imagine a sliding threshold <span class="math inline">\(\lambda\)</span> moving down along the <em>ordinate</em>, starting from very high values, <span class="math inline">\(\approx 1.5 \times 10^{11}\)</span>. The decision rule is to diagnose the case as âdiseasedâ if <span class="math inline">\(l &gt; \lambda\)</span>, and otherwise the case is diagnosed as ânon-diseasedâ. In Plot A the likelihood ratio <span class="math inline">\(\text{lr}\)</span> seems, for all practical purposes, to be monotonically related to z, so on the surface is makes no difference which decision rule is used, that based on <span class="math inline">\(l &gt; \lambda\)</span> or the one based on <span class="math inline">\(z &gt; \zeta\)</span>. The same conclusion is reached for Plot B, which shows the range z: (-3,5). Plot C reveals the first hint of trouble. It shows the range z: (-3,3); now, the ordinate <span class="math inline">\(l\)</span> is not monotonically related to <span class="math inline">\(z\)</span>, rather the function <span class="math inline">\(l(z|a,b)\)</span> has a minimum, so for values of <span class="math inline">\(l\)</span> below approximately 1 (the value depends on the choice of the <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> parameters) there are two values of <span class="math inline">\(\zeta\)</span> corresponding to a single value of <span class="math inline">\(\lambda\)</span>. This behavior is amplified in the remaining plots, as one âhomesâ in on the minimum. Taking the clearest example, Plot F, for <span class="math inline">\(\lambda = 0.37\)</span> the two values are (-0.7277494065, 0.2055839269).<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a> The two values are denoted by <span class="math inline">\(\zeta_L=-0.728\)</span> and <span class="math inline">\(\zeta_U=0.206\)</span>. The likelihood ratio observer, using threshold <span class="math inline">\(\lambda=0.37\)</span>, declares all cases with <span class="math inline">\(l &gt; 0.37\)</span> as âdiseasedâ and ânon-diseasedâ otherwise. Therefore, the corresponding z-sample binormal model observer must declare cases with <span class="math inline">\(z &gt; \zeta_U\)</span> and cases with <span class="math inline">\(z \le \zeta_L\)</span> as diseased and ânon-diseasedâ otherwise. The z-sample based decision rule is non-intuitive and bifurcated: why should cases with very low z-samples be declared diseased? The reason is that the z-sample based model assumed by the observer (as noted earlier, the analysis assumes that the observer âknowsâ or âlearnsâ the two distributions and makes rational decisions based on this knowledge) is itself unphysical. According to the z-sample based model, i.e., binormal model, both very high and very low values of z are consistent with the case being diseased. If the observer is rational, then he will abandon making decisions based on <span class="math inline">\(z\)</span> and instead use the transformation <span class="math inline">\(l=l(z|a,b)\)</span> to make decisions based on <span class="math inline">\(l\)</span>. The l-based decision rule is much simpler (i.e., not bifurcated): if <span class="math inline">\(l &gt; \lambda\)</span> one diagnoses the case as âdiseasedâ, otherwise one diagnoses it as ânon-diseasedâ.</p>
<p>Since likelihood ratio decreases monotonically as <span class="math inline">\(\lambda\)</span> is reduced (i.e., one is moving down the y-axis in Fig. <a href="proper-roc-models.html#fig:proper-roc-models-plots-2">20.2</a>, starting from a very high value), the slope of the resulting ROC curve decreases monotonically.<a href="#fn7" class="footnote-ref" id="fnref7"><sup>7</sup></a> In other words, the likelihood ratio observer generates a proper ROC curve. Another theorem14,16,18, is that the likelihood ratio observer achieves highest AUC as compared to an observer using any other decision rule, e.g., one based on the binormal model z-sample exceeding threshold <span class="math inline">\(\zeta\)</span>. Since likelihood ratio is the ratio of two probabilities, it is always positive. More accurately, it is non-negative. The slope of the proper ROC at the upper-right corner is non-negative. Unlike traditional ROC curves, the slope of proper ROC fits do not generally decrease monotonically to zero as one moves up the curve. Rather it approaches a positive constant. In special cases the limiting slope can be zero, as in the <span class="math inline">\(b = 1\)</span> binormal model example shown earlier, see following Eqn. <a href="proper-roc-models.html#eq:proper-roc-models-b-equal-1">(20.8)</a>, so it is more accurate to say that the limiting slope is non-negative.</p>
<p>For the binormal model based likelihood ratio observer, the slope will not decrease to zero, rather it will decrease to the limiting value, 0.3606620722, suggested by <a href="proper-roc-models.html#fig:proper-roc-models-plots-2">20.2</a> Plot F (for values of <span class="math inline">\(\lambda\)</span> below the minimum, there are no solutions for z).</p>
<p>The observer can use a decision rule that is based on any monotonic increasing transformation of the likelihood ratio and the resulting ROC curve will be identical to that based on the likelihood ratio; the slope of the resulting curve always equals the likelihood ratio (before the monotonic transformation). For example, the monotonic transformation could yield a variable ranging from -infinity to plus infinity, but the slope of the resulting ROC curve will still be that for the likelihood ratio observer prior to the transformation. The limiting value of the slope is model dependent; specifically, if the binormal model is used, the limiting slope depends on the values of <span class="math inline">\(a,b\)</span>.</p>
<p>A final theorem not explicitly stated in the literature: since AUC of the likelihood ratio observer is optimal with respect to other observers using different decision rules, or different underlying models of the decision variable, the AUC achieved by the likelihood ratio observer is unique, regardless of the model used to fit the proper ROC curve. In other words, the shapes of the predicted proper ROC curves are model dependent and could differ from each other, but the AUCs will be the same. This was empirically demonstrated in book Chapter 18, in connection with RSM, PROPROC and CBM fitted AUCs.</p>
</div>
<div id="proper-roc-models-proproc" class="section level2 hasAnchor">
<h2><span class="header-section-number">20.8</span> PROPROC<a href="proper-roc-models.html#proper-roc-models-proproc" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>An algorithm <span class="citation">(Metz and Pan <a href="#ref-metz1999proper" role="doc-biblioref">1999</a>)</span>, based on the observer using the binormal model likelihood ratio, has been implemented. The software is called PROPROC, for proper ROC.<a href="#fn8" class="footnote-ref" id="fnref8"><sup>8</sup></a></p>
<div id="proper-roc-models-proproc-formulae" class="section level3 hasAnchor">
<h3><span class="header-section-number">20.8.1</span> PROPROC formulae<a href="proper-roc-models.html#proper-roc-models-proproc-formulae" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The method uses two parameters <span class="math inline">\(c,d_a\)</span> defined as follows:</p>
<p><span class="math display" id="eq:proper-roc-models-proproc-parameters">\[\begin{equation} 
\left.\begin{aligned}
c &amp;= \frac{b-1}{b+1} \\
d_a &amp;= \frac{\sqrt{2}a}{1+b^2} \\
\end{aligned}\right\}
\tag{20.9}
\end{equation}\]</span></p>
<p>Allowed values of the parameters are as follows:</p>
<p><span class="math display" id="eq:proper-roc-models-proproc-parameter-ranges">\[\begin{equation} 
\left.\begin{aligned}
&amp; -1 &lt; c &lt; 1 \\
&amp; 0 &lt; d_a &lt; \infty \\
\end{aligned}\right\}
\tag{20.10}
\end{equation}\]</span></p>
<p>Eqn. <a href="proper-roc-models.html#eq:proper-roc-models-proproc-parameters">(20.9)</a> can be solved for the <span class="math inline">\(a,b\)</span> parameters as functions of the <span class="math inline">\(c.d_a\)</span> parameters:</p>
<p><span class="math display" id="eq:proper-roc-models-proproc-parameters-transform">\[\begin{equation} 
\left.\begin{aligned}
a &amp;= \frac{d_a}{\sqrt{2}}\sqrt{1+{{\left( \frac{c+1}{c-1} \right)^2}}} \\
b &amp;= -\frac{c+1}{c-1} \\
\end{aligned}\right\}
\tag{20.11}
\end{equation}\]</span></p>
<p>Since <span class="math inline">\(b &lt; 1\)</span> with most clinical datasets, one expects to find <span class="math inline">\(c &lt; 0\)</span>. The proper ROC curve is defined by <span class="citation">(Metz and Pan <a href="#ref-metz1999proper" role="doc-biblioref">1999</a>)</span>:</p>
<p><span class="math display" id="eq:proper-roc-models-fpf-tpf">\[\begin{equation} 
\left.\begin{aligned}
FPF\left( v \right) &amp;= \Phi\left( -\left( 1-c \right)v -\frac{d_a}{2}\sqrt{1+c^2}  \right) \\ 
&amp;+\Phi\left( -\left( 1-c \right)v +\frac{d_a}{2c}\sqrt{1+c^2} \right)  -H(c) \\
TPF\left( v \right) &amp;= \Phi\left( -\left( 1+c \right)v +\frac{d_a}{2}\sqrt{1+c^2}  \right)  \\ &amp;+\Phi\left( -\left( 1+c \right)v +\frac{d_a}{2c}\sqrt{1+c^2} \right)  -H(c) \\
\end{aligned}\right\}
\tag{20.12}
\end{equation}\]</span></p>
<p>The (Heaviside) step function <span class="math inline">\(H(x)\)</span> is defined by:</p>
<p><span class="math display" id="eq:proper-roc-models-heaviside">\[\begin{equation} 
\left.\begin{aligned}
H\left( x &lt; 0 \right) &amp;= 0 \\
H\left( x &gt; 0 \right) &amp;= 1 \\
\end{aligned}\right\}
\tag{20.13}
\end{equation}\]</span></p>
<p>The function is discontinuous, but its value at <span class="math inline">\(x = 0\)</span> is irrelevant because <span class="math inline">\(c = 0\)</span> implies <span class="math inline">\(b = 1\)</span>, in which case the equal variance binormal model applies, which predicts proper ROCs. Depending on the value of <span class="math inline">\(c\)</span> the threshold variable <span class="math inline">\(v\)</span> in Eqn. <a href="proper-roc-models.html#eq:proper-roc-models-fpf-tpf">(20.12)</a> has different ranges:</p>
<p><span class="math display" id="eq:proper-roc-models-limits-v">\[\begin{equation} 
\left.\begin{aligned}
\begin{matrix}
\frac{d_a}{4c}\sqrt{1+c^2} \le v \le \infty &amp; \text{if} &amp; c&lt;0 
\end{matrix}\\
\begin{matrix}
-\infty \le v \le \infty &amp; \text{if} &amp; c=0 
\end{matrix}\\
\begin{matrix}
-\infty \le v \le\frac{d_a}{4c}\sqrt{1+c^2} \le v &amp; \text{if} &amp; c&lt;0 
\end{matrix}\\
\\
\end{aligned}\right\}
\tag{20.14}
\end{equation}\]</span></p>
<p>PROPROC software implements a maximum likelihood method to estimate the <span class="math inline">\(c, d_a\)</span> parameters from ratings data. The 1999 publication <span class="citation">(Metz and Pan <a href="#ref-metz1999proper" role="doc-biblioref">1999</a>)</span> states, without proof, that the area under the proper ROC is give by:</p>
<p><span class="math display" id="eq:proper-roc-models-metz-36">\[\begin{equation} 
A_{prop}=\Phi\left( \frac{d_a}{\sqrt{2}} \right) + 2F\left\{-\frac{d_a}{\sqrt{2}},0;-\frac{1-c^2}{1+c^2}  \right\}
\tag{20.15}
\end{equation}\]</span></p>
<p>Here <span class="math inline">\(F(X,Y;\rho)\)</span> is the bivariate standard-normal (i.e., zero means and unit variances) cumulative distribution function (CDF) with correlation coefficient <span class="math inline">\(\rho\)</span>. In the notation of book Chapter 21:</p>
<p><span class="math display" id="eq:proper-roc-models-def-bivariate-cdf">\[\begin{equation} 
F\left( X,Y;\rho \right)=\int_{x=-\infty}^{X}
\int_{y=-\infty}^{Y}
dx dy f\left( 
\left( \begin{matrix}
x \\
y
\end{matrix}
 \right) \bigg\rvert
\left( \begin{matrix}
0 \\
0
\end{matrix}  \right),
\left( \begin{matrix}
1 &amp; \rho \\
\rho &amp; 1
\end{matrix} \right)
\right)
\tag{20.16}
\end{equation}\]</span></p>
<p>Here <span class="math inline">\(f\)</span> is the pdf of a standard-normal bivariate distribution with correlation <span class="math inline">\(\rho\)</span>, i.e., the mean is the zero column vector of length 2 and the 2 x 2 covariance matrix has ones along the diagonal and <span class="math inline">\(\rho\)</span> along the off-diagonal.</p>
<p>The first term in Eqn. <a href="proper-roc-models.html#eq:proper-roc-models-metz-36">(20.15)</a> is equal to the area under the binormal model ROC curve, TBA book Chapter 06, Eqn. (6.48):</p>
<p><span class="math display" id="eq:proper-roc-models-az-binormal">\[\begin{equation} 
A_z=\Phi\left( \frac{a}{1+b^2} \right)
\tag{20.17}
\end{equation}\]</span></p>
<p>Therefore,</p>
<p><span class="math display" id="eq:proper-roc-models-area-proproc2">\[\begin{equation} 
A_{prop}=A_z+2F\left( -\frac{d_a}{\sqrt{2}},0;-\frac{1-c^2}{1+c^2} \right)
\tag{20.18}
\end{equation}\]</span></p>
<p>Since F (a CDF, which is a probability) is non-negative,</p>
<p><span class="math display" id="eq:proper-roc-models-area-proproc-az-inequality">\[\begin{equation} 
A_{prop}\ge A_z
\tag{20.19}
\end{equation}\]</span></p>
<p>This reinforces the earlier stated more general result (more general, as it is not restricted to any distributional assumptions) that performance of a likelihood ratio, or ideal, observer is greater than or equal to that of any other observer using a different decision rule.</p>
</div>
<div id="proper-roc-models-proproc-code" class="section level3 hasAnchor">
<h3><span class="header-section-number">20.8.2</span> PROPROC code implementation<a href="proper-roc-models.html#proper-roc-models-proproc-code" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="proper-roc-models.html#cb159-1"></a>Transform2ab &lt;-<span class="st"> </span><span class="cf">function</span> (d_a, c){</span>
<span id="cb159-2"><a href="proper-roc-models.html#cb159-2"></a>  b &lt;-<span class="st"> </span><span class="op">-</span>(c<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span>(c<span class="dv">-1</span>)</span>
<span id="cb159-3"><a href="proper-roc-models.html#cb159-3"></a>  a &lt;-<span class="st"> </span>(d_a<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span>))<span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">1</span><span class="op">+</span>b<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb159-4"><a href="proper-roc-models.html#cb159-4"></a>  <span class="kw">return</span>( <span class="kw">list</span>(</span>
<span id="cb159-5"><a href="proper-roc-models.html#cb159-5"></a>    <span class="dt">a =</span> a,</span>
<span id="cb159-6"><a href="proper-roc-models.html#cb159-6"></a>    <span class="dt">b =</span> b</span>
<span id="cb159-7"><a href="proper-roc-models.html#cb159-7"></a>  ) )</span>
<span id="cb159-8"><a href="proper-roc-models.html#cb159-8"></a>}</span>
<span id="cb159-9"><a href="proper-roc-models.html#cb159-9"></a></span>
<span id="cb159-10"><a href="proper-roc-models.html#cb159-10"></a>GetLimits &lt;-<span class="st"> </span><span class="cf">function</span> (d_a, c)</span>
<span id="cb159-11"><a href="proper-roc-models.html#cb159-11"></a>{</span>
<span id="cb159-12"><a href="proper-roc-models.html#cb159-12"></a>  <span class="cf">if</span> (c <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.0</span>) {</span>
<span id="cb159-13"><a href="proper-roc-models.html#cb159-13"></a>    LL &lt;-<span class="st">  </span>d_a<span class="op">/</span><span class="dv">4</span><span class="op">/</span>c<span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">1</span><span class="op">+</span>c<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb159-14"><a href="proper-roc-models.html#cb159-14"></a>    UL &lt;-<span class="st">  </span><span class="fl">10.0</span></span>
<span id="cb159-15"><a href="proper-roc-models.html#cb159-15"></a>  }</span>
<span id="cb159-16"><a href="proper-roc-models.html#cb159-16"></a>  </span>
<span id="cb159-17"><a href="proper-roc-models.html#cb159-17"></a>  <span class="cf">if</span> (c <span class="op">==</span><span class="st"> </span><span class="fl">0.0</span>) </span>
<span id="cb159-18"><a href="proper-roc-models.html#cb159-18"></a>  {</span>
<span id="cb159-19"><a href="proper-roc-models.html#cb159-19"></a>    LL  &lt;-<span class="st">  </span><span class="fl">-10.0</span></span>
<span id="cb159-20"><a href="proper-roc-models.html#cb159-20"></a>    UL &lt;-<span class="st">  </span><span class="fl">10.0</span></span>
<span id="cb159-21"><a href="proper-roc-models.html#cb159-21"></a>  }</span>
<span id="cb159-22"><a href="proper-roc-models.html#cb159-22"></a>  </span>
<span id="cb159-23"><a href="proper-roc-models.html#cb159-23"></a>  <span class="cf">if</span> (c <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.0</span>) </span>
<span id="cb159-24"><a href="proper-roc-models.html#cb159-24"></a>  {</span>
<span id="cb159-25"><a href="proper-roc-models.html#cb159-25"></a>    LL &lt;-<span class="st">  </span><span class="fl">-10.0</span></span>
<span id="cb159-26"><a href="proper-roc-models.html#cb159-26"></a>    UL &lt;-<span class="st">  </span>d_a<span class="op">/</span><span class="dv">4</span><span class="op">/</span>c<span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">1</span><span class="op">+</span>c<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb159-27"><a href="proper-roc-models.html#cb159-27"></a>  }</span>
<span id="cb159-28"><a href="proper-roc-models.html#cb159-28"></a>  <span class="kw">return</span>( <span class="kw">list</span>(</span>
<span id="cb159-29"><a href="proper-roc-models.html#cb159-29"></a>    <span class="dt">LL =</span> LL,</span>
<span id="cb159-30"><a href="proper-roc-models.html#cb159-30"></a>    <span class="dt">UL =</span> UL</span>
<span id="cb159-31"><a href="proper-roc-models.html#cb159-31"></a>  ) )</span>
<span id="cb159-32"><a href="proper-roc-models.html#cb159-32"></a>  </span>
<span id="cb159-33"><a href="proper-roc-models.html#cb159-33"></a>}</span>
<span id="cb159-34"><a href="proper-roc-models.html#cb159-34"></a></span>
<span id="cb159-35"><a href="proper-roc-models.html#cb159-35"></a></span>
<span id="cb159-36"><a href="proper-roc-models.html#cb159-36"></a></span>
<span id="cb159-37"><a href="proper-roc-models.html#cb159-37"></a>Heaviside &lt;-<span class="st"> </span><span class="cf">function</span> (c)</span>
<span id="cb159-38"><a href="proper-roc-models.html#cb159-38"></a>{</span>
<span id="cb159-39"><a href="proper-roc-models.html#cb159-39"></a>  <span class="cf">if</span> (c <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.0</span>) rval &lt;-<span class="st">  </span><span class="fl">0.0</span> <span class="cf">else</span> rval  &lt;-<span class="st">  </span><span class="fl">1.0</span></span>
<span id="cb159-40"><a href="proper-roc-models.html#cb159-40"></a>  <span class="kw">return</span> (rval)</span>
<span id="cb159-41"><a href="proper-roc-models.html#cb159-41"></a>}</span>
<span id="cb159-42"><a href="proper-roc-models.html#cb159-42"></a></span>
<span id="cb159-43"><a href="proper-roc-models.html#cb159-43"></a>FalsePositiveFraction &lt;-<span class="st"> </span><span class="cf">function</span> (vc, d_a, c)</span>
<span id="cb159-44"><a href="proper-roc-models.html#cb159-44"></a>{</span>
<span id="cb159-45"><a href="proper-roc-models.html#cb159-45"></a>  </span>
<span id="cb159-46"><a href="proper-roc-models.html#cb159-46"></a>  arg1 &lt;-<span class="st">  </span><span class="op">-</span>(<span class="dv">1</span><span class="op">-</span>c)<span class="op">*</span>vc<span class="op">-</span>d_a<span class="op">/</span><span class="dv">2</span><span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">1</span><span class="op">+</span>c<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb159-47"><a href="proper-roc-models.html#cb159-47"></a>  arg2 &lt;-<span class="st">  </span><span class="op">-</span>(<span class="dv">1</span><span class="op">-</span>c)<span class="op">*</span>vc<span class="op">+</span>d_a<span class="op">/</span><span class="dv">2</span><span class="op">/</span>c<span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">1</span><span class="op">+</span>c<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb159-48"><a href="proper-roc-models.html#cb159-48"></a>  </span>
<span id="cb159-49"><a href="proper-roc-models.html#cb159-49"></a>  rval =<span class="st"> </span><span class="kw">pnorm</span> (arg1) <span class="op">+</span><span class="st"> </span><span class="kw">pnorm</span> (arg2) <span class="op">-</span><span class="st"> </span><span class="kw">Heaviside</span> (c)</span>
<span id="cb159-50"><a href="proper-roc-models.html#cb159-50"></a>  </span>
<span id="cb159-51"><a href="proper-roc-models.html#cb159-51"></a>  <span class="kw">return</span> (rval)</span>
<span id="cb159-52"><a href="proper-roc-models.html#cb159-52"></a>}</span>
<span id="cb159-53"><a href="proper-roc-models.html#cb159-53"></a></span>
<span id="cb159-54"><a href="proper-roc-models.html#cb159-54"></a></span>
<span id="cb159-55"><a href="proper-roc-models.html#cb159-55"></a></span>
<span id="cb159-56"><a href="proper-roc-models.html#cb159-56"></a>TruePositiveFraction &lt;-<span class="st"> </span><span class="cf">function</span> (vc, d_a, c)</span>
<span id="cb159-57"><a href="proper-roc-models.html#cb159-57"></a>{</span>
<span id="cb159-58"><a href="proper-roc-models.html#cb159-58"></a>  arg1 =<span class="st"> </span><span class="op">-</span>(<span class="dv">1</span><span class="op">+</span>c)<span class="op">*</span>vc<span class="op">+</span>d_a<span class="op">/</span><span class="dv">2</span><span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">1</span><span class="op">+</span>c<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb159-59"><a href="proper-roc-models.html#cb159-59"></a>  arg2 =<span class="st"> </span><span class="op">-</span>(<span class="dv">1</span><span class="op">+</span>c)<span class="op">*</span>vc<span class="op">+</span>d_a<span class="op">/</span><span class="dv">2</span><span class="op">/</span>c<span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">1</span><span class="op">+</span>c<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb159-60"><a href="proper-roc-models.html#cb159-60"></a>  </span>
<span id="cb159-61"><a href="proper-roc-models.html#cb159-61"></a>  rval =<span class="st"> </span><span class="kw">pnorm</span> (arg1) <span class="op">+</span><span class="st"> </span><span class="kw">pnorm</span> (arg2) <span class="op">-</span><span class="st"> </span><span class="kw">Heaviside</span> (c)</span>
<span id="cb159-62"><a href="proper-roc-models.html#cb159-62"></a>  </span>
<span id="cb159-63"><a href="proper-roc-models.html#cb159-63"></a>  <span class="kw">return</span> (rval)</span>
<span id="cb159-64"><a href="proper-roc-models.html#cb159-64"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="proper-roc-models.html#cb160-1"></a>c1Arr &lt;-<span class="st">   </span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.1322804</span>, <span class="fl">0.2225588</span>)</span>
<span id="cb160-2"><a href="proper-roc-models.html#cb160-2"></a>daArr  &lt;-<span class="st">  </span><span class="kw">c</span>(<span class="fl">1.197239</span>,<span class="fl">1.740157</span>)</span>
<span id="cb160-3"><a href="proper-roc-models.html#cb160-3"></a>plotRoc &lt;-<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb160-4"><a href="proper-roc-models.html#cb160-4"></a>plotSlope &lt;-<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb160-5"><a href="proper-roc-models.html#cb160-5"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>)</span>
<span id="cb160-6"><a href="proper-roc-models.html#cb160-6"></a>{</span>
<span id="cb160-7"><a href="proper-roc-models.html#cb160-7"></a>  c1 &lt;-<span class="st"> </span>c1Arr[i]</span>
<span id="cb160-8"><a href="proper-roc-models.html#cb160-8"></a>  da &lt;-<span class="st"> </span>daArr[i]</span>
<span id="cb160-9"><a href="proper-roc-models.html#cb160-9"></a>  ret &lt;-<span class="st"> </span><span class="kw">Transform2ab</span>(da, c1)</span>
<span id="cb160-10"><a href="proper-roc-models.html#cb160-10"></a>  a &lt;-<span class="st"> </span>ret<span class="op">$</span>a;b &lt;-<span class="st"> </span>ret<span class="op">$</span>b</span>
<span id="cb160-11"><a href="proper-roc-models.html#cb160-11"></a>  <span class="co"># may need to adjust limits to view detail of slope plot</span></span>
<span id="cb160-12"><a href="proper-roc-models.html#cb160-12"></a>  <span class="cf">if</span> (i <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) z &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">0</span>, <span class="dt">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb160-13"><a href="proper-roc-models.html#cb160-13"></a>  <span class="cf">if</span> (i <span class="op">==</span><span class="st"> </span><span class="dv">2</span>) z &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">5</span>, <span class="dt">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb160-14"><a href="proper-roc-models.html#cb160-14"></a>  </span>
<span id="cb160-15"><a href="proper-roc-models.html#cb160-15"></a>  FPF &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="fl">0.0</span>, <span class="dv">1</span>, <span class="fl">0.001</span>)</span>
<span id="cb160-16"><a href="proper-roc-models.html#cb160-16"></a>  TPF &lt;-<span class="st"> </span><span class="kw">rocY</span>(FPF, a, b)</span>
<span id="cb160-17"><a href="proper-roc-models.html#cb160-17"></a>  </span>
<span id="cb160-18"><a href="proper-roc-models.html#cb160-18"></a>  rocPlot &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">FPF =</span> FPF, <span class="dt">TPF =</span> TPF)</span>
<span id="cb160-19"><a href="proper-roc-models.html#cb160-19"></a>  plotRoc[[i]] &lt;-<span class="st"> </span><span class="kw">ggplot</span>(</span>
<span id="cb160-20"><a href="proper-roc-models.html#cb160-20"></a>    rocPlot, <span class="kw">aes</span>(<span class="dt">x =</span> FPF, <span class="dt">y =</span> TPF)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb160-21"><a href="proper-roc-models.html#cb160-21"></a><span class="st">    </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb160-22"><a href="proper-roc-models.html#cb160-22"></a><span class="st">    </span><span class="kw">ggtitle</span>(<span class="kw">paste0</span>(<span class="st">&quot;Plot &quot;</span>, </span>
<span id="cb160-23"><a href="proper-roc-models.html#cb160-23"></a>                   LETTERS[i], </span>
<span id="cb160-24"><a href="proper-roc-models.html#cb160-24"></a>                   <span class="st">&quot;:&quot;</span>, </span>
<span id="cb160-25"><a href="proper-roc-models.html#cb160-25"></a>                   <span class="kw">sprintf</span>(<span class="st">&quot; c = %5.3f, da = %5.3f&quot;</span>, </span>
<span id="cb160-26"><a href="proper-roc-models.html#cb160-26"></a>                           c1, da)))</span>
<span id="cb160-27"><a href="proper-roc-models.html#cb160-27"></a></span>
<span id="cb160-28"><a href="proper-roc-models.html#cb160-28"></a>  <span class="co"># Implement Eqn. 36 from Metz-Pan paper </span></span>
<span id="cb160-29"><a href="proper-roc-models.html#cb160-29"></a>  rho &lt;-<span class="st"> </span><span class="op">-</span>(<span class="dv">1</span><span class="op">-</span>c1<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>c1<span class="op">^</span><span class="dv">2</span>);sigma &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">c</span>(<span class="dv">1</span>, rho), <span class="kw">c</span>(rho, <span class="dv">1</span>))</span>
<span id="cb160-30"><a href="proper-roc-models.html#cb160-30"></a>  lower &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="op">-</span><span class="ot">Inf</span>,<span class="dv">2</span>);upper &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span>da<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span>),<span class="dv">0</span>)</span>
<span id="cb160-31"><a href="proper-roc-models.html#cb160-31"></a>  A_prop &lt;-<span class="st"> </span><span class="kw">pnorm</span>(da<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb160-32"><a href="proper-roc-models.html#cb160-32"></a><span class="st">    </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">pmvnorm</span>(lower, upper, <span class="dt">sigma =</span> sigma)</span>
<span id="cb160-33"><a href="proper-roc-models.html#cb160-33"></a>  A_prop &lt;-<span class="st">  </span><span class="kw">as.numeric</span>(A_prop)</span>
<span id="cb160-34"><a href="proper-roc-models.html#cb160-34"></a>  </span>
<span id="cb160-35"><a href="proper-roc-models.html#cb160-35"></a>  slope &lt;-b<span class="op">*</span><span class="kw">dnorm</span>(a<span class="op">-</span>b<span class="op">*</span>z)<span class="op">/</span><span class="kw">dnorm</span>(<span class="op">-</span>z)</span>
<span id="cb160-36"><a href="proper-roc-models.html#cb160-36"></a>  </span>
<span id="cb160-37"><a href="proper-roc-models.html#cb160-37"></a>  slopePlot &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">z =</span> z, <span class="dt">slope =</span> slope)</span>
<span id="cb160-38"><a href="proper-roc-models.html#cb160-38"></a>  plotSlope[[i]] &lt;-<span class="st"> </span><span class="kw">ggplot</span>(</span>
<span id="cb160-39"><a href="proper-roc-models.html#cb160-39"></a>    slopePlot, <span class="kw">aes</span>(<span class="dt">x =</span> z, <span class="dt">y =</span> slope)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb160-40"><a href="proper-roc-models.html#cb160-40"></a><span class="st">    </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb160-41"><a href="proper-roc-models.html#cb160-41"></a><span class="st">    </span><span class="kw">ggtitle</span>(<span class="kw">paste0</span>(<span class="st">&quot;Plot &quot;</span>, </span>
<span id="cb160-42"><a href="proper-roc-models.html#cb160-42"></a>                   LETTERS[i<span class="op">+</span><span class="dv">2</span>], </span>
<span id="cb160-43"><a href="proper-roc-models.html#cb160-43"></a>                   <span class="st">&quot;:&quot;</span>, </span>
<span id="cb160-44"><a href="proper-roc-models.html#cb160-44"></a>                   <span class="kw">sprintf</span>(<span class="st">&quot; c = %5.3f, da = %5.3f&quot;</span>, </span>
<span id="cb160-45"><a href="proper-roc-models.html#cb160-45"></a>                           c1, da)))</span>
<span id="cb160-46"><a href="proper-roc-models.html#cb160-46"></a>}</span></code></pre></div>
<p>The analytic expressions for PROPROC ROC curves are implemented in the preceding code which plots PROPROC ROC curves predicted by the specified values of the model parameters <span class="math inline">\((c,d_a)\)</span> and plots of the slopes as a function of binormal model decision variable <span class="math inline">\(z\)</span>, Fig. <a href="proper-roc-models.html#fig:proper-roc-models-plots-3">20.3</a>. Plot A is the ROC for <span class="math inline">\(c = -0.132, d_a = 1.197\)</span> while plot B is the ROC for <span class="math inline">\(c = 0.226, d_a = 1.74\)</span>. Plots C and D are the corresponding slope plots. The parameters correspond to radiologists from a dataset <span class="citation">(Andersson et al. <a href="#ref-andersson2008breast" role="doc-biblioref">2008</a>)</span> involving a FROC study of breast tomosynthesis. Highest rating ROC data were inferred from the original FROC data. These were analyzed by PROPROC and the resulting parameter values were used above. The radiologists were chosen as they demonstrate significant differences in the shapes of their respective proper ROC curves. Plot A is for a negative value of <span class="math inline">\(c\)</span> which implies <span class="math inline">\(b &lt; 1\)</span>. In this situation the slope of the proper ROC is infinite near the origin (corresponding to the very large values of slope in Plot C approached at large likelihood threshold <span class="math inline">\(\lambda\)</span>) and approaches a constant slope near the upper right corner of the ROC (corresponding to the positive minimum slope in Plot C approached as one lowers the likelihood threshold <span class="math inline">\(\lambda\)</span>). Plot B is for a positive value of <span class="math inline">\(c\)</span> which implies <span class="math inline">\(b &gt; 1\)</span>. This time the slope of the ROC near the origin is large but finite (corresponding to the peak in Plot D at intermediate likelihood threshold <span class="math inline">\(\lambda\)</span>) and approaches zero near the upper right corner (corresponding to the zero minimum slope in Plot D approached as one lowers the likelihood threshold <span class="math inline">\(\lambda\)</span> to zero).</p>
</div>
<div id="proper-roc-models-proproc-rocs" class="section level3 hasAnchor">
<h3><span class="header-section-number">20.8.3</span> PROPROC ROC and slope plots<a href="proper-roc-models.html#proper-roc-models-proproc-rocs" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="figure"><span style="display:block;" id="fig:proper-roc-models-plots-3"></span>
<img src="20a-proper-roc-models_files/figure-html/proper-roc-models-plots-3-1.png" alt="The plots are labeled by the values of $c$ and $d_a$. Plots A and B are proper ROC plots while Plots C and D are the corresponding slope plots. In Plot A the slope is infinite near the origin and the curve approaches the upper-right corner with finite slope. The situation is reversed in Plot B where the slope is finite near the origin and the curve approaches the upper-right corner with zero slope." width="672" />
<p class="caption">
FIGURE 20.3: The plots are labeled by the values of <span class="math inline">\(c\)</span> and <span class="math inline">\(d_a\)</span>. Plots A and B are proper ROC plots while Plots C and D are the corresponding slope plots. In Plot A the slope is infinite near the origin and the curve approaches the upper-right corner with finite slope. The situation is reversed in Plot B where the slope is finite near the origin and the curve approaches the upper-right corner with zero slope.
</p>
</div>
<p>To better understand the relation between the ROC plots and the slope plots, one moves up along the proper ROC curve by âcuttingâ the slope axis in Plots C and D horizontally with a sliding threshold <span class="math inline">\(\lambda\)</span>, starting with very high values and then lowering it downwards. In Plot B the slope of the ROC curve starts at the origin with a large but finite value corresponding to the peak in Plot D. Above the peak, there are no solutions for <span class="math inline">\(z\)</span>. The slope decreases monotonically to zero, corresponding to the flattening out of the slope at zero for <span class="math inline">\(z \approx 2\)</span>. Alternatively, one can think of horizontally shrinking each of Plots C and D to zero width, and all that remains is the slope axis with a thick vertical line superimposed on it, corresponding to the horizontally collapsed curves. In Plot C this vertical line extends from positive infinity down to about 0.1, and represents the range of decision variable samples encountered by the observer on the likelihood ratio scale. In Plot D this vertical line extends from a finite value (~9.4) to zero. Values outside of these ranges are not possible.<a href="#fn9" class="footnote-ref" id="fnref9"><sup>9</sup></a></p>
</div>
</div>
<div id="proper-roc-models-cbm" class="section level2 hasAnchor">
<h2><span class="header-section-number">20.9</span> The contaminated binormal model (CBM)<a href="proper-roc-models.html#proper-roc-models-cbm" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The contaminated binormal model <span class="citation">(Donald D Dorfman, Berbaum, and Brandser <a href="#ref-dorfman2000contaminated1" role="doc-biblioref">2000</a>; Donald D Dorfman and Berbaum <a href="#ref-dorfman2000contaminated2" role="doc-biblioref">2000</a><a href="#ref-dorfman2000contaminated2" role="doc-biblioref">b</a>, <a href="#ref-dorfman2000contaminated3" role="doc-biblioref">2000</a><a href="#ref-dorfman2000contaminated3" role="doc-biblioref">a</a>)</span>, or CBM, is an alternate model for decision variable sampling in an ROC study. Like the binormal model, it is a two-parameter model, excluding cutoffs. The first parameter is <span class="math inline">\(\mu_\text{CBM}\)</span>, the separation of two unit-variance normal distributions. The sampling for non-diseased cases is from the <span class="math inline">\(N(0,1)\)</span> distribution, while sampling for diseased cases is from the <span class="math inline">\(N(\mu_\text{CBM},1)\)</span> distribution, provided the disease is visible, otherwise it is from the <span class="math inline">\(N(0,1)\)</span> distribution. In other words, for diseased cases the sampling is from a mixture distribution of two unit variance normal distributions, one centered at <span class="math inline">\(\mu\)</span> and the other centered at 0, with mixing fraction <span class="math inline">\(\alpha\)</span>, the fraction of diseased cases where the abnormality is actually visible. The binning is accomplished, as usual, by the cutoff vector <span class="math inline">\(\overrightarrow{\zeta}=\left( \zeta_1,...,\zeta_{\text{ROC}-1} \right)\)</span>, where <span class="math inline">\(R_\text{ROC}\)</span> is the number of ROC bins. Defining dummy cutoffs <span class="math inline">\(\zeta_0=-\infty\)</span> and <span class="math inline">\(\zeta_{\text{ROC}}=\infty\)</span>, the binning rule is as before:</p>
<p><span class="math display">\[\begin{equation} 
\begin{matrix}
\text{if} &amp; \zeta_{r-1} \le z &lt; \zeta_r &amp; \text{rating} = r 
\end{matrix}
\end{equation}\]</span></p>
<p>Therefore, CBM is characterized by the parameters <span class="math inline">\(\mu, \alpha, \zeta_r\)</span> where <span class="math inline">\(r=1,2,...,R_{\text{ROC}-1}\)</span>. The parameters <span class="math inline">\(\mu, \alpha\)</span> can be used to predict the ROC curve and the area under the curve.</p>
<div id="proper-roc-models-cbm-formulae" class="section level3 hasAnchor">
<h3><span class="header-section-number">20.9.1</span> CBM formulae<a href="proper-roc-models.html#proper-roc-models-cbm-formulae" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For non-diseased cases, the <span class="math inline">\(\text{pdf}\)</span> is the same as for the binormal model:</p>
<p><span class="math display" id="eq:proper-roc-models-cbm-pdfn">\[\begin{equation}
\text{pdf}_N=\phi(z) 
\tag{20.20}
\end{equation}\]</span></p>
<p>For diseased cases the <span class="math inline">\(\text{pdf}\)</span> is a mixture of two unit variance distributions, one centered at zero and the other at <span class="math inline">\(\mu_\text{CBM}\)</span>, with mixing fractions <span class="math inline">\((1-\alpha)\)</span> and <span class="math inline">\(\alpha\)</span>, respectively:</p>
<p><span class="math display" id="eq:proper-roc-models-cbm-pdfd">\[\begin{equation}
\text{pdf}_D=\left( 1-\alpha \right)\phi(z) + \alpha \phi(z-\mu_\text{CBM})
\tag{20.21}
\end{equation}\]</span></p>
<p>The likelihood ratio for the CBM model is given by the ratio of the two pdfs:</p>
<p><span class="math display" id="eq:proper-roc-models-cbm-likelihood">\[\begin{equation}
\left.\begin{aligned}
l_\text{CBM}\left( z|a,b \right)&amp;=\frac{\left( 1-\alpha \right)\phi(z) + \alpha \phi(z-\mu_\text{CBM})}{\phi(z)}\\
&amp;=\left( 1-\alpha \right)+\alpha \, \exp\left(-\frac{\mu_\text{CBM}^2}{2}+z\,\mu_\text{CBM}  \right)
\end{aligned}\right\}
\tag{20.22}
\end{equation}\]</span></p>
<p>The function increases monotonically as <span class="math inline">\(z\)</span> increases proving that the predicted ROC curve is proper, i.e., its slope decreases monotonically as the operating point moves up the curve (causing both <span class="math inline">\(z\)</span> and the likelihood ratio to decrease). The slope at the origin (infinite <span class="math inline">\(z\)</span>) is infinite and the slope at the upper-right corner is <span class="math inline">\((1-\alpha)\)</span>. The predicted ROC coordinates are:</p>
<p><span class="math display" id="eq:proper-roc-models-cbm-fpf-tpf">\[\begin{equation}
\left.\begin{aligned}
\text{FPF}\left( \zeta \right) &amp;= \Phi\left( -\zeta \right)\\
\text{TPF}\left( \zeta \right) &amp;= \left( 1-\alpha \right)\Phi\left( -\zeta \right)+\alpha \,\Phi\left( \mu_\text{CBM}-\zeta \right)
\end{aligned}\right\}
\tag{20.23}
\end{equation}\]</span></p>
<p>Since on non-diseased cases the sampling behaviors are identical, the expression for <span class="math inline">\(\text{FPF}\left( \zeta \right)\)</span> is identical to that for the binormal model: the probability that the z-sample for a non-diseased case exceeds <span class="math inline">\(\zeta\)</span> is <span class="math inline">\(\Phi\left( -\zeta \right)\)</span>. The second Eqn. <a href="proper-roc-models.html#eq:proper-roc-models-cbm-fpf-tpf">(20.23)</a> can be understood as follows. <span class="math inline">\(\text{TPF}\left( \zeta \right)\)</span> is the probability that a diseased case z-sample exceeds <span class="math inline">\(\zeta\)</span>. There are two possibilities: the z-sample arose from the zero-centered distribution, which occurs with probability <span class="math inline">\(\left( 1-\alpha \right)\)</span>, or it arose from the <span class="math inline">\(\mu_\text{CBM}\)</span>-centered distribution, which occurs with probability <span class="math inline">\(\alpha\)</span>. In the former case, the probability that the z-sample exceeds <span class="math inline">\(\zeta\)</span> is <span class="math inline">\(\Phi\left( -\zeta \right)\)</span>. In the latter case, the probability is <span class="math inline">\(\Phi\left( \mu_\text{CBM}-\zeta \right)\)</span>. The net probability is the weighted sum of these component probabilities in proportion to their relative frequencies <span class="math inline">\(\left( 1-\alpha \right):\alpha\)</span>. A similar logic can be used to derive the AUC under the CBM fitted ROC curve:</p>
<p><span class="math display" id="eq:proper-roc-models-cbm-auc">\[\begin{equation}
\text{AUC}_\text{CBM}=0.5\left( 1-\alpha \right)+\alpha \,\Phi\left( \frac {\mu_\text{CBM}}{\sqrt{2}} \right)
\tag{20.24}
\end{equation}\]</span></p>
<p>In the limit <span class="math inline">\(\mu_\text{CBM} \rightarrow \infty\)</span>, <span class="math inline">\(\text{AUC}_\text{CBM} \rightarrow 0.5\left( 1+\alpha \right)\)</span> and in the limit <span class="math inline">\(\mu_\text{CBM} \rightarrow 0\)</span>, <span class="math inline">\(\text{AUC}_\text{CBM} \rightarrow 0.5\)</span>.</p>
</div>
<div id="proper-roc-models-cbm-code" class="section level3 hasAnchor">
<h3><span class="header-section-number">20.9.2</span> CBM code implementation<a href="proper-roc-models.html#proper-roc-models-cbm-code" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The following computes the y-coordinate of the ROC predicted by the CBM:</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="proper-roc-models.html#cb161-1"></a>CbmRocY &lt;-<span class="st"> </span><span class="cf">function</span> (x, mu, alpha) {</span>
<span id="cb161-2"><a href="proper-roc-models.html#cb161-2"></a>  y &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>alpha)<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pnorm</span>(<span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>x))) <span class="op">+</span><span class="st"> </span></span>
<span id="cb161-3"><a href="proper-roc-models.html#cb161-3"></a><span class="st">    </span>alpha<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pnorm</span>(<span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>x)<span class="op">-</span>mu))</span>
<span id="cb161-4"><a href="proper-roc-models.html#cb161-4"></a>  <span class="kw">return</span>(y)</span>
<span id="cb161-5"><a href="proper-roc-models.html#cb161-5"></a>}</span></code></pre></div>
<p>The plotting code follows:</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="proper-roc-models.html#cb162-1"></a>FPF &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="fl">0.0</span>, <span class="dv">1</span>, <span class="fl">0.001</span>)</span>
<span id="cb162-2"><a href="proper-roc-models.html#cb162-2"></a>alphaArr &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.2</span>, <span class="fl">0.8</span>)</span>
<span id="cb162-3"><a href="proper-roc-models.html#cb162-3"></a>muArr &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)</span>
<span id="cb162-4"><a href="proper-roc-models.html#cb162-4"></a>plotRoc &lt;-<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb162-5"><a href="proper-roc-models.html#cb162-5"></a>myLabelIndx &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb162-6"><a href="proper-roc-models.html#cb162-6"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>)</span>
<span id="cb162-7"><a href="proper-roc-models.html#cb162-7"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>) </span>
<span id="cb162-8"><a href="proper-roc-models.html#cb162-8"></a>  {</span>
<span id="cb162-9"><a href="proper-roc-models.html#cb162-9"></a>    {</span>
<span id="cb162-10"><a href="proper-roc-models.html#cb162-10"></a>      alpha &lt;-<span class="st"> </span>alphaArr[i]</span>
<span id="cb162-11"><a href="proper-roc-models.html#cb162-11"></a>      mu &lt;-<span class="st"> </span>muArr[j]</span>
<span id="cb162-12"><a href="proper-roc-models.html#cb162-12"></a>      TPF &lt;-<span class="st"> </span><span class="kw">CbmRocY</span>(FPF, mu, alpha)</span>
<span id="cb162-13"><a href="proper-roc-models.html#cb162-13"></a>      rocPlot &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">FPF =</span> FPF, <span class="dt">TPF =</span> TPF)</span>
<span id="cb162-14"><a href="proper-roc-models.html#cb162-14"></a>      plotRoc[[myLabelIndx]] &lt;-<span class="st"> </span><span class="kw">ggplot</span>(</span>
<span id="cb162-15"><a href="proper-roc-models.html#cb162-15"></a>        rocPlot, <span class="kw">aes</span>(<span class="dt">x =</span> FPF, <span class="dt">y =</span> TPF)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb162-16"><a href="proper-roc-models.html#cb162-16"></a><span class="st">        </span><span class="kw">geom_line</span>(<span class="dt">data =</span> rocPlot) <span class="op">+</span><span class="st"> </span></span>
<span id="cb162-17"><a href="proper-roc-models.html#cb162-17"></a><span class="st">        </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb162-18"><a href="proper-roc-models.html#cb162-18"></a><span class="st">        </span><span class="kw">scale_y_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="op">+</span></span>
<span id="cb162-19"><a href="proper-roc-models.html#cb162-19"></a><span class="st">        </span><span class="kw">ggtitle</span>(<span class="kw">paste0</span>(<span class="st">&quot;Plot &quot;</span>, </span>
<span id="cb162-20"><a href="proper-roc-models.html#cb162-20"></a>                   LETTERS[myLabelIndx], </span>
<span id="cb162-21"><a href="proper-roc-models.html#cb162-21"></a>                   <span class="st">&quot;:&quot;</span>, </span>
<span id="cb162-22"><a href="proper-roc-models.html#cb162-22"></a>                   <span class="kw">sprintf</span>(<span class="st">&quot; alpha = %4.2f, mu = %4.2f&quot;</span>, </span>
<span id="cb162-23"><a href="proper-roc-models.html#cb162-23"></a>                           alpha, mu)))</span>
<span id="cb162-24"><a href="proper-roc-models.html#cb162-24"></a>      myLabelIndx &lt;-<span class="st"> </span>myLabelIndx <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb162-25"><a href="proper-roc-models.html#cb162-25"></a>    }</span>
<span id="cb162-26"><a href="proper-roc-models.html#cb162-26"></a>  }</span></code></pre></div>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="proper-roc-models.html#cb163-1"></a>FPF &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="fl">0.0</span>, <span class="dv">1</span>, <span class="fl">0.001</span>)</span>
<span id="cb163-2"><a href="proper-roc-models.html#cb163-2"></a>cbmPdfs &lt;-<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb163-3"><a href="proper-roc-models.html#cb163-3"></a>myLabelIndx &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb163-4"><a href="proper-roc-models.html#cb163-4"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>)</span>
<span id="cb163-5"><a href="proper-roc-models.html#cb163-5"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>) </span>
<span id="cb163-6"><a href="proper-roc-models.html#cb163-6"></a>  {</span>
<span id="cb163-7"><a href="proper-roc-models.html#cb163-7"></a>    {</span>
<span id="cb163-8"><a href="proper-roc-models.html#cb163-8"></a>      alpha &lt;-<span class="st"> </span>alphaArr[i]</span>
<span id="cb163-9"><a href="proper-roc-models.html#cb163-9"></a>      mu &lt;-<span class="st"> </span>muArr[j]</span>
<span id="cb163-10"><a href="proper-roc-models.html#cb163-10"></a>      <span class="cf">if</span> (i <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {</span>
<span id="cb163-11"><a href="proper-roc-models.html#cb163-11"></a>        z1 &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="dt">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb163-12"><a href="proper-roc-models.html#cb163-12"></a>        z2 &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">3</span>, mu <span class="op">+</span><span class="st"> </span><span class="dv">3</span>, <span class="dt">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb163-13"><a href="proper-roc-models.html#cb163-13"></a>      } <span class="cf">else</span> {</span>
<span id="cb163-14"><a href="proper-roc-models.html#cb163-14"></a>        z1 &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="dt">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb163-15"><a href="proper-roc-models.html#cb163-15"></a>        z2 &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">3</span>, mu <span class="op">+</span><span class="st"> </span><span class="dv">3</span>, <span class="dt">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb163-16"><a href="proper-roc-models.html#cb163-16"></a>      }</span>
<span id="cb163-17"><a href="proper-roc-models.html#cb163-17"></a>      Pdf1 &lt;-<span class="st"> </span><span class="kw">dnorm</span>(z1)</span>
<span id="cb163-18"><a href="proper-roc-models.html#cb163-18"></a>      Pdf2 &lt;-<span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alpha) <span class="op">*</span><span class="st"> </span><span class="kw">dnorm</span>(z2) <span class="op">+</span><span class="st"> </span>alpha <span class="op">*</span><span class="st"> </span><span class="kw">dnorm</span>(z2, mu)</span>
<span id="cb163-19"><a href="proper-roc-models.html#cb163-19"></a>      df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb163-20"><a href="proper-roc-models.html#cb163-20"></a>        <span class="dt">z =</span> <span class="kw">c</span>(z1, z2), <span class="dt">pdf =</span> <span class="kw">c</span>(Pdf1, Pdf2), </span>
<span id="cb163-21"><a href="proper-roc-models.html#cb163-21"></a>        <span class="dt">truth =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&#39;non&#39;</span>, <span class="kw">length</span>(Pdf1)), </span>
<span id="cb163-22"><a href="proper-roc-models.html#cb163-22"></a>                  <span class="kw">rep</span>(<span class="st">&#39;dis&#39;</span>, <span class="kw">length</span>(Pdf2)))</span>
<span id="cb163-23"><a href="proper-roc-models.html#cb163-23"></a>      )</span>
<span id="cb163-24"><a href="proper-roc-models.html#cb163-24"></a>      </span>
<span id="cb163-25"><a href="proper-roc-models.html#cb163-25"></a>      cbmPdfs[[myLabelIndx]] &lt;-<span class="st"> </span><span class="kw">ggplot</span>(</span>
<span id="cb163-26"><a href="proper-roc-models.html#cb163-26"></a>        df, <span class="kw">aes</span>(<span class="dt">x =</span> z, <span class="dt">y =</span> pdf, <span class="dt">color =</span> truth)) <span class="op">+</span></span>
<span id="cb163-27"><a href="proper-roc-models.html#cb163-27"></a><span class="st">        </span><span class="kw">geom_line</span>(<span class="dt">data =</span> df) <span class="op">+</span></span>
<span id="cb163-28"><a href="proper-roc-models.html#cb163-28"></a><span class="st">        </span><span class="kw">scale_colour_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="st">&quot;black&quot;</span>,<span class="st">&quot;darkgrey&quot;</span>)) <span class="op">+</span></span>
<span id="cb163-29"><a href="proper-roc-models.html#cb163-29"></a><span class="st">        </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="op">+</span></span>
<span id="cb163-30"><a href="proper-roc-models.html#cb163-30"></a><span class="st">        </span><span class="kw">scale_y_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="op">+</span></span>
<span id="cb163-31"><a href="proper-roc-models.html#cb163-31"></a><span class="st">        </span><span class="co">#theme(legend.position = c(0.5, 0.2)) +</span></span>
<span id="cb163-32"><a href="proper-roc-models.html#cb163-32"></a><span class="st">        </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span></span>
<span id="cb163-33"><a href="proper-roc-models.html#cb163-33"></a><span class="st">        </span><span class="kw">ggtitle</span>(<span class="kw">paste0</span>(<span class="st">&quot;Plot &quot;</span>, </span>
<span id="cb163-34"><a href="proper-roc-models.html#cb163-34"></a>                   LETTERS[myLabelIndx], </span>
<span id="cb163-35"><a href="proper-roc-models.html#cb163-35"></a>                   <span class="st">&quot;:&quot;</span>, </span>
<span id="cb163-36"><a href="proper-roc-models.html#cb163-36"></a>                   <span class="kw">sprintf</span>(<span class="st">&quot; alpha = %5.3f, mu = %5.3f&quot;</span>, </span>
<span id="cb163-37"><a href="proper-roc-models.html#cb163-37"></a>                           alpha, mu)))</span>
<span id="cb163-38"><a href="proper-roc-models.html#cb163-38"></a>      myLabelIndx &lt;-<span class="st"> </span>myLabelIndx <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb163-39"><a href="proper-roc-models.html#cb163-39"></a>    }</span>
<span id="cb163-40"><a href="proper-roc-models.html#cb163-40"></a>  }</span></code></pre></div>
</div>
<div id="proper-roc-models-cbm-rocs" class="section level3 hasAnchor">
<h3><span class="header-section-number">20.9.3</span> CBM ROC plots<a href="proper-roc-models.html#proper-roc-models-cbm-rocs" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The following figures should further clarify these equations. Fig. <a href="proper-roc-models.html#fig:proper-roc-models-cbm-plots-1">20.4</a> shows ROC curves predicted by the CBM model; the values of the <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\mu\)</span> parameters are indicated in the legend. For small <span class="math inline">\(\alpha\)</span> and/or small <span class="math inline">\(\mu\)</span> the curve approaches the chance diagonal consistent with the notion that if the lesion is not visible performance can be no better than chance level.</p>
<div class="figure"><span style="display:block;" id="fig:proper-roc-models-cbm-plots-1"></span>
<img src="20a-proper-roc-models_files/figure-html/proper-roc-models-cbm-plots-1-1.png" alt="ROC curves predicted by the CBM model. The corresponding values of the parameters are indicated above the plots. For small $\alpha$ or small $\mu$ the curve approaches the chance diagonal, consistent with the notion that if the lesion is not visible, performance can be no better than chance level." width="672" />
<p class="caption">
FIGURE 20.4: ROC curves predicted by the CBM model. The corresponding values of the parameters are indicated above the plots. For small <span class="math inline">\(\alpha\)</span> or small <span class="math inline">\(\mu\)</span> the curve approaches the chance diagonal, consistent with the notion that if the lesion is not visible, performance can be no better than chance level.
</p>
</div>
<p>As one might expect as <span class="math inline">\(\mu\)</span> and/or <span class="math inline">\(\alpha\)</span> increases performance gets better and the curve more closely approaches the top-left corner. Try as one might, by varying the parameters, one can never get the predicted curve to cross the chance diagonal, confirming viscerally that one is dealing with a proper ROC model. A proof of this property is in Eqn. <a href="proper-roc-models.html#eq:proper-roc-models-cbm-likelihood">(20.22)</a> and the paragraph following it.</p>
<p>The pdf plots are shown next, Fig. <a href="proper-roc-models.html#fig:proper-roc-models-cbm-plots-2">20.5</a>.</p>
</div>
<div id="proper-roc-models-cbm-pdfs" class="section level3 hasAnchor">
<h3><span class="header-section-number">20.9.4</span> CBM pdf plots<a href="proper-roc-models.html#proper-roc-models-cbm-pdfs" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="figure"><span style="display:block;" id="fig:proper-roc-models-cbm-plots-2"></span>
<img src="20a-proper-roc-models_files/figure-html/proper-roc-models-cbm-plots-2-1.png" alt="Density functions predicted by CBM. The dark line is the diseased distribution. The grey line is the non-diseased distribution. The bimodal diseased distribution is clearly evident in plots B and D." width="672" />
<p class="caption">
FIGURE 20.5: Density functions predicted by CBM. The dark line is the diseased distribution. The grey line is the non-diseased distribution. The bimodal diseased distribution is clearly evident in plots B and D.
</p>
</div>
<p>The slope or likelihood ration plots are shown next, Fig. <a href="proper-roc-models.html#fig:proper-roc-models-cbm-plots-3">20.6</a>.</p>
</div>
<div id="proper-roc-models-cbm-slopes" class="section level3 hasAnchor">
<h3><span class="header-section-number">20.9.5</span> CBM likelihood ratio plots<a href="proper-roc-models.html#proper-roc-models-cbm-slopes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="figure"><span style="display:block;" id="fig:proper-roc-models-cbm-plots-3"></span>
<img src="20a-proper-roc-models_files/figure-html/proper-roc-models-cbm-plots-3-1.png" alt="The slope plots are labeled by the values of $\alpha$ and $\mu$. Close examination of the region near the flat part shows it does not plateau at zero; rather the minimum is at $(1 - \alpha)$." width="672" />
<p class="caption">
FIGURE 20.6: The slope plots are labeled by the values of <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\mu\)</span>. Close examination of the region near the flat part shows it does not plateau at zero; rather the minimum is at <span class="math inline">\((1 - \alpha)\)</span>.
</p>
</div>
<p>Fig. <a href="proper-roc-models.html#fig:proper-roc-models-cbm-plots-3">20.6</a> are the corresponding slope (or likelihood ratio) plots for the same parameter values as in the other figures in this section. All plots are monotonic with <span class="math inline">\(z\)</span>: as <span class="math inline">\(z\)</span> increases, the slope increases; this makes the reader using <span class="math inline">\(z\)</span>, under the CBM model, a likelihood ratio observer. In addition, according to Eqn. (20.26), the slope approaches <span class="math inline">\(1-\alpha\)</span> as <span class="math inline">\(z\)</span> approaches <span class="math inline">\(â\infty\)</span>, i.e., once again we encounter a proper ROC curve which approaches the upper-right corner with non-zero slope (except for the special case <span class="math inline">\(\alpha = 1\)</span>).</p>
</div>
</div>
<div id="proper-roc-models-bigamma" class="section level2 hasAnchor">
<h2><span class="header-section-number">20.10</span> The bigamma model (BGM)<a href="proper-roc-models.html#proper-roc-models-bigamma" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="proper-roc-models-bigamma-formulae" class="section level3 hasAnchor">
<h3><span class="header-section-number">20.10.1</span> BGM formulae<a href="proper-roc-models.html#proper-roc-models-bigamma-formulae" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The gamma function is defined by <span class="citation">(Abramowitz and Stegun <a href="#ref-abramowitz1964handbook" role="doc-biblioref">1964</a>)</span>:</p>
<p><span class="math display" id="eq:proper-roc-models-gamma">\[\begin{equation}
\Gamma\left( x \right) = \int_{0}^{\infty}t^{x-1}e^{-t} dt
\tag{20.25}
\end{equation}\]</span></p>
<p>A random variable <span class="math inline">\(X\)</span> has a gamma distribution if its <span class="math inline">\(\text{pdf}\)</span> is <span class="citation">(Larsen and Marx <a href="#ref-larsen2005introduction" role="doc-biblioref">2005</a>)</span>:</p>
<p><span class="math display" id="eq:proper-roc-models-gamma-pdf">\[\begin{equation}
\begin{matrix}
f\left( x |r,\lambda\right) = \frac{\lambda^r}{\Gamma\left( r \right)}x^{r-1}e^{-\lambda x}; &amp; 
x\ge 0, r&gt;0, \lambda &gt;0
\end{matrix}
\tag{20.26}
\end{equation}\]</span></p>
<p>It has the following interpretation: for integer <span class="math inline">\(r\)</span>, assuming events are Poisson distributed with rate parameter <span class="math inline">\(\lambda\)</span>, the <span class="math inline">\(\text{pdf}\)</span> of event <span class="math inline">\(r\)</span> follows Eqn. <a href="proper-roc-models.html#eq:proper-roc-models-gamma-pdf">(20.26)</a>. However, in this equation, <span class="math inline">\(r\)</span> is not restricted to integers. Alternatively, <span class="math inline">\(l/r\)</span> is called the scale parameter and <span class="math inline">\(r\)</span> is called the shape parameter of the gamma distribution.</p>
<p>The mean and variance of this distribution are given by:</p>
<p><span class="math display" id="eq:proper-roc-models-gamma-mean-var">\[\begin{equation}
\left.\begin{aligned}
E\left( X \right) &amp;= \frac{r}{\lambda} \\
Var\left( X \right) &amp;= \frac{r}{\lambda^2} \\
\end{aligned}\right\}
\tag{20.27}
\end{equation}\]</span></p>
<p>The constant-shape bigamma model is defined <span class="citation">(Dorfman et al. <a href="#ref-dorfman1997proper" role="doc-biblioref">1997</a>)</span> by the following pdfs (note <span class="math inline">\(\lambda = 1\)</span> for the non-diseased density and for either density <span class="math inline">\(x \ge 0\)</span>):</p>
<p><span class="math display" id="eq:proper-roc-models-gamma-pdfs">\[\begin{equation}
\left.\begin{aligned}
\text{pdf}_N\left( x \right) &amp;= f\left( x;r,1 \right)\\
&amp;= \frac{1}{\Gamma\left( r \right)}x^{r-1}e^{-x}\\
\text{pdf}_D\left( x \right) &amp;= f\left( x;r,\lambda \right)\\
&amp;= \frac{\lambda^r}{\Gamma\left( r \right)}x^{r-1}e^{-\lambda x} 
\end{aligned}\right\}
\tag{20.28}
\end{equation}\]</span></p>
<p>The reason for the name âbigammaâ is because it involves two gamma distributions (just as âbinormalâ refers to two normal distributions). If the variance of the diseased distribution is to be larger than that of the non-diseased one the following constraint must hold:</p>
<p><span class="math display" id="eq:proper-roc-models-bigamma-lambda-inequality">\[\begin{equation}
0 &lt; \lambda \le 1
\tag{20.29}
\end{equation}\]</span></p>
<p>The limitation <span class="math inline">\(x \ge 0\)</span> suggests that <span class="math inline">\(x\)</span> is equivalent to a likelihood ratio (the ratio of two pdfs must be non-negative), which will be shown shortly to be true. The model assumes the same shape parameter <span class="math inline">\(r\)</span> for non-diseased and diseased cases, which is the basic reason why it predicts proper ROC curves. The likelihood ratio function <span class="math inline">\(l(x)\)</span> is given by:</p>
<p><span class="math display" id="eq:proper-roc-models-bigamma-likelihood">\[\begin{equation}
\left.\begin{aligned}
l_\text{BG}\left( x;r,\lambda \right) &amp;= \frac{\text{pdf}_D\left( x \right)}{\text{pdf}_N\left( x \right)} \\
&amp;=\lambda^r e^{-\left( \lambda - 1 \right) x}
\end{aligned}\right\}
\tag{20.30}
\end{equation}\]</span></p>
<p>The subscript âBGâ is for bigamma model. Since the exponential is a monotonic function of its argument, the likelihood ratio is a monotonic function of <span class="math inline">\(x\)</span>, which implies that an observer using knowledge of this distribution and basing decisions on observed values of <span class="math inline">\(x\)</span> exceeding a threshold, is a likelihood ratio observer. Notice the usage of <span class="math inline">\(x\)</span> rather than <span class="math inline">\(z\)</span>; the latter denotes samples from normal distributions. The bigamma model observer bases decisions on the x-sample, not the z-sample. In addition, for notational consistency one uses the symbol <span class="math inline">\(\xi\)</span> to denote a threshold on the x-axis. If <span class="math inline">\(x &gt; \xi\)</span> the case is diagnosed as diseased and otherwise it is diagnosed non-diseased.</p>
<p>Since <span class="math inline">\(0 &lt; \lambda \le 1\)</span> the slope at the upper right corner (corresponding to <span class="math inline">\(x = 0\)</span>) is <span class="math inline">\(\lambda ^ r\)</span> and the slope is infinite at the origin (corresponding to <span class="math inline">\(x = \infty\)</span>). As with PROPROC and CBM, once again one encounters a proper ROC curve approaching the upper-right corner with finite slope. If <span class="math inline">\(\lambda &gt; 1\)</span> the slope is zero at the origin, which would cause the ROC curve to start out below the chance diagonal. Therefore, constraint <span class="math inline">\(0 &lt; \lambda \le 1\)</span> is needed not just to yield a wider distribution for diseased cases but to also assure the ROC curve is proper. If <span class="math inline">\(\lambda = 1\)</span> then regardless of the value of <span class="math inline">\(r\)</span>, the ROC curve is the chance diagonal because the two pdfs become identical.</p>
<p>The cumulative distribution function (CDF) of the gamma distribution is given by:</p>
<p><span class="math display" id="eq:proper-roc-models-gamma-cdf">\[\begin{equation}
F\left( x;r,\lambda \right) = \int_{0}^{x}f\left( u;r,\lambda \right) du
= \frac{\gamma\left( r, \lambda x \right)}{\Gamma\left( r \right)}
\tag{20.31}
\end{equation}\]</span></p>
<p>Here the lower incomplete gamma function <span class="citation">(Abramowitz and Stegun <a href="#ref-abramowitz1964handbook" role="doc-biblioref">1964</a>)</span> <span class="math inline">\(\gamma\left( s,x \right)\)</span> is defined by:</p>
<p><span class="math display" id="eq:proper-roc-models-gamma-incomplete">\[\begin{equation}
\gamma\left( s,x \right) = \int_{0}^{x} t^{s-1} e^{-t} dt
\tag{20.32}
\end{equation}\]</span></p>
<p>[Since <code>R</code> implements the CDF of the gamma distribution directly, as <code>pgamma()</code> one actually has no use for Eqn. <a href="proper-roc-models.html#eq:proper-roc-models-gamma-incomplete">(20.32)</a> which is included for pedagogic completeness.] The coordinates of the predicted ROC at threshold <span class="math inline">\(\xi\)</span> are (the complementary probability is needed as FPF and TPF are the probabilities of exceeding a threshold):</p>
<p><span class="math display" id="eq:proper-roc-models-gamma-fpf-tpf">\[\begin{equation}
\left.\begin{aligned}
\text{FPF}\left( \xi|r \right) &amp;= 1 - \frac{\gamma\left( r,\xi \right)}{\Gamma\left( r \right)} \\
&amp;=\int_{\xi}^{\infty} f\left( u;r,1 \right) \\
\text{TPF}\left( \xi|r, \lambda \right) &amp;= 1 - \frac{\gamma\left( r,\lambda \xi \right)}{\Gamma\left( r \right)} \\
&amp;=\int_{\xi}^{\infty} f\left( u;r,\lambda \right) \\
\end{aligned}\right\}
\tag{20.33}
\end{equation}\]</span></p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="proper-roc-models.html#cb164-1"></a>aucIntegrand &lt;-<span class="st"> </span><span class="cf">function</span> (FPF, r, lambda) </span>
<span id="cb164-2"><a href="proper-roc-models.html#cb164-2"></a>{</span>
<span id="cb164-3"><a href="proper-roc-models.html#cb164-3"></a>  y &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">pgamma</span>(<span class="kw">qgamma</span>(<span class="dv">1</span><span class="op">-</span>FPF, r), r, <span class="dt">scale =</span> <span class="dv">1</span><span class="op">/</span>lambda)</span>
<span id="cb164-4"><a href="proper-roc-models.html#cb164-4"></a>  <span class="kw">return</span>(y)  </span>
<span id="cb164-5"><a href="proper-roc-models.html#cb164-5"></a>}</span>
<span id="cb164-6"><a href="proper-roc-models.html#cb164-6"></a></span>
<span id="cb164-7"><a href="proper-roc-models.html#cb164-7"></a></span>
<span id="cb164-8"><a href="proper-roc-models.html#cb164-8"></a>biGammaRocY &lt;-<span class="st"> </span><span class="cf">function</span> (x, r, lambda) {</span>
<span id="cb164-9"><a href="proper-roc-models.html#cb164-9"></a>  y &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">pgamma</span>(x, r, <span class="dt">scale =</span> <span class="dv">1</span><span class="op">/</span>lambda)</span>
<span id="cb164-10"><a href="proper-roc-models.html#cb164-10"></a>  <span class="kw">return</span>(y)</span>
<span id="cb164-11"><a href="proper-roc-models.html#cb164-11"></a>}</span></code></pre></div>
</div>
<div id="proper-roc-models-bigamma-code" class="section level3 hasAnchor">
<h3><span class="header-section-number">20.10.2</span> BGM code implementation<a href="proper-roc-models.html#proper-roc-models-bigamma-code" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="proper-roc-models.html#cb165-1"></a>rArray &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">4.391</span>,<span class="dv">5</span>,<span class="dv">10</span>);lambdaArray &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.439</span>,<span class="fl">0.3</span>,<span class="fl">0.1</span>)</span>
<span id="cb165-2"><a href="proper-roc-models.html#cb165-2"></a><span class="co">#r &lt;-  4.391; lambda &lt;-  0.439 # from Dorfman paper</span></span>
<span id="cb165-3"><a href="proper-roc-models.html#cb165-3"></a>plotRoc &lt;-<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb165-4"><a href="proper-roc-models.html#cb165-4"></a>plotSlope &lt;-<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb165-5"><a href="proper-roc-models.html#cb165-5"></a>pdfs &lt;-<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb165-6"><a href="proper-roc-models.html#cb165-6"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(rArray))</span>
<span id="cb165-7"><a href="proper-roc-models.html#cb165-7"></a>{</span>
<span id="cb165-8"><a href="proper-roc-models.html#cb165-8"></a>  r &lt;-<span class="st"> </span>rArray[i];lambda &lt;-<span class="st"> </span>lambdaArray[i]</span>
<span id="cb165-9"><a href="proper-roc-models.html#cb165-9"></a>  AUC &lt;-<span class="st"> </span><span class="kw">integrate</span>(aucIntegrand,<span class="dv">0</span>,<span class="dv">1</span>, <span class="dt">r =</span> r, <span class="dt">lambda =</span> lambda)</span>
<span id="cb165-10"><a href="proper-roc-models.html#cb165-10"></a>  <span class="co"># cat(&quot;r = &quot;, r, &quot;, lambda = &quot;, lambda, &quot;, AUC = &quot;, AUC$value, &quot;\n&quot;)</span></span>
<span id="cb165-11"><a href="proper-roc-models.html#cb165-11"></a>  <span class="co"># left limit below gets the upper end of the ROC curve </span></span>
<span id="cb165-12"><a href="proper-roc-models.html#cb165-12"></a>  <span class="co"># the right limit gets the lower corner</span></span>
<span id="cb165-13"><a href="proper-roc-models.html#cb165-13"></a>  x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, r<span class="op">/</span>lambda <span class="op">+</span><span class="st"> </span><span class="dv">10</span><span class="op">*</span><span class="kw">sqrt</span>(r<span class="op">/</span>lambda<span class="op">^</span><span class="dv">2</span>), <span class="dt">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb165-14"><a href="proper-roc-models.html#cb165-14"></a>  FPF &lt;-<span class="st"> </span><span class="kw">biGammaRocY</span>(x, r, <span class="dv">1</span>)</span>
<span id="cb165-15"><a href="proper-roc-models.html#cb165-15"></a>  TPF &lt;-<span class="st"> </span><span class="kw">biGammaRocY</span>(x, r, lambda)</span>
<span id="cb165-16"><a href="proper-roc-models.html#cb165-16"></a>  </span>
<span id="cb165-17"><a href="proper-roc-models.html#cb165-17"></a>  rocPlot &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">FPF =</span> FPF, <span class="dt">TPF =</span> TPF)</span>
<span id="cb165-18"><a href="proper-roc-models.html#cb165-18"></a>  plotRoc[[i]] &lt;-<span class="st"> </span><span class="kw">ggplot</span>(</span>
<span id="cb165-19"><a href="proper-roc-models.html#cb165-19"></a>    rocPlot, <span class="kw">aes</span>(<span class="dt">x =</span> FPF, <span class="dt">y =</span> TPF)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb165-20"><a href="proper-roc-models.html#cb165-20"></a><span class="st">    </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb165-21"><a href="proper-roc-models.html#cb165-21"></a><span class="st">    </span><span class="kw">ggtitle</span>(<span class="kw">paste0</span>(<span class="st">&quot;Plot &quot;</span>, </span>
<span id="cb165-22"><a href="proper-roc-models.html#cb165-22"></a>           LETTERS[i], </span>
<span id="cb165-23"><a href="proper-roc-models.html#cb165-23"></a>           <span class="st">&quot;:&quot;</span>, </span>
<span id="cb165-24"><a href="proper-roc-models.html#cb165-24"></a>           <span class="kw">sprintf</span>(<span class="st">&quot; r = %3.2f, lambda = %3.2f&quot;</span>, </span>
<span id="cb165-25"><a href="proper-roc-models.html#cb165-25"></a>                   r, lambda)))</span>
<span id="cb165-26"><a href="proper-roc-models.html#cb165-26"></a></span>
<span id="cb165-27"><a href="proper-roc-models.html#cb165-27"></a></span>
<span id="cb165-28"><a href="proper-roc-models.html#cb165-28"></a>  <span class="co"># taking mean + 3 times the standard deviation</span></span>
<span id="cb165-29"><a href="proper-roc-models.html#cb165-29"></a>  x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="fl">0.01</span>, r<span class="op">/</span>lambda <span class="op">+</span><span class="st"> </span><span class="dv">3</span><span class="op">*</span><span class="kw">sqrt</span>(r<span class="op">/</span>lambda<span class="op">^</span><span class="dv">2</span>), <span class="dt">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb165-30"><a href="proper-roc-models.html#cb165-30"></a>  </span>
<span id="cb165-31"><a href="proper-roc-models.html#cb165-31"></a>  Pdf1 &lt;-<span class="st"> </span><span class="kw">dgamma</span>(x, r)</span>
<span id="cb165-32"><a href="proper-roc-models.html#cb165-32"></a>  Pdf2 &lt;-<span class="st"> </span><span class="kw">dgamma</span>(x, r, <span class="dt">scale =</span> <span class="dv">1</span><span class="op">/</span>lambda)</span>
<span id="cb165-33"><a href="proper-roc-models.html#cb165-33"></a>  </span>
<span id="cb165-34"><a href="proper-roc-models.html#cb165-34"></a>  df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">c</span>(x, x), <span class="dt">pdf =</span> <span class="kw">c</span>(Pdf1, Pdf2), </span>
<span id="cb165-35"><a href="proper-roc-models.html#cb165-35"></a>                   <span class="dt">truth =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&#39;non-diseased&#39;</span>, <span class="kw">length</span>(Pdf1)), </span>
<span id="cb165-36"><a href="proper-roc-models.html#cb165-36"></a>                             <span class="kw">rep</span>(<span class="st">&#39;diseased&#39;</span>, <span class="kw">length</span>(Pdf2))))</span>
<span id="cb165-37"><a href="proper-roc-models.html#cb165-37"></a>  </span>
<span id="cb165-38"><a href="proper-roc-models.html#cb165-38"></a>  pdfs[[i]] &lt;-<span class="st"> </span><span class="kw">ggplot</span>(</span>
<span id="cb165-39"><a href="proper-roc-models.html#cb165-39"></a>    df, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> pdf, <span class="dt">color =</span> truth)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb165-40"><a href="proper-roc-models.html#cb165-40"></a><span class="st">    </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb165-41"><a href="proper-roc-models.html#cb165-41"></a><span class="st">    </span><span class="kw">scale_colour_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;green&quot;</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb165-42"><a href="proper-roc-models.html#cb165-42"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.title =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb165-43"><a href="proper-roc-models.html#cb165-43"></a>          <span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="fl">0.9</span>, <span class="fl">0.9</span>))</span>
<span id="cb165-44"><a href="proper-roc-models.html#cb165-44"></a>  </span>
<span id="cb165-45"><a href="proper-roc-models.html#cb165-45"></a>  <span class="co"># may need to adjust limits to view detail of slope plot</span></span>
<span id="cb165-46"><a href="proper-roc-models.html#cb165-46"></a>  x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="fl">0.01</span>, <span class="dv">1</span>, <span class="dt">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb165-47"><a href="proper-roc-models.html#cb165-47"></a></span>
<span id="cb165-48"><a href="proper-roc-models.html#cb165-48"></a>  slope &lt;-<span class="st"> </span>(<span class="kw">dgamma</span>(x, r, <span class="dt">scale =</span> <span class="dv">1</span><span class="op">/</span>lambda))<span class="op">/</span><span class="kw">pgamma</span>(x, r)</span>
<span id="cb165-49"><a href="proper-roc-models.html#cb165-49"></a></span>
<span id="cb165-50"><a href="proper-roc-models.html#cb165-50"></a>  slopePlot &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> x, <span class="dt">slope =</span> slope)</span>
<span id="cb165-51"><a href="proper-roc-models.html#cb165-51"></a>  plotSlope[[i]] &lt;-<span class="st"> </span><span class="kw">ggplot</span>(slopePlot, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> slope)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>()</span>
<span id="cb165-52"><a href="proper-roc-models.html#cb165-52"></a>}</span></code></pre></div>
<p>The bigamma-model formulae, coded above, generates ROC plots, Fig. <a href="proper-roc-models.html#fig:proper-roc-models-bigamma-plots-1">20.7</a>, pdfs plots for non-diseased and diseased cases, Fig. <a href="proper-roc-models.html#fig:proper-roc-models-bigamma-plots-2">20.8</a> and likelihood ratio (slope) plots Fig. <a href="proper-roc-models.html#fig:proper-roc-models-bigamma-plots-3">20.9</a> for four pairs of values of the <span class="math inline">\((r, \lambda)\)</span> bigamma model parameters. Plot A is for <span class="math inline">\((r = 1, \lambda = 1)\)</span> when the ROC becomes the chance diagonal regardless of the value of <span class="math inline">\(r\)</span>. Plot B is for <span class="math inline">\((r = 4.39, \lambda = 0.439)\)</span> identical to those used for simulations in.<a href="#fn10" class="footnote-ref" id="fnref10"><sup>10</sup></a> Plot C is for $(r = 5, = 0.3) and Plot D is for $(r = 10, = 0.1).</p>
</div>
<div id="proper-roc-models-bigamma-rocs" class="section level3 hasAnchor">
<h3><span class="header-section-number">20.10.3</span> BGM ROC plots<a href="proper-roc-models.html#proper-roc-models-bigamma-rocs" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="figure"><span style="display:block;" id="fig:proper-roc-models-bigamma-plots-1"></span>
<img src="20a-proper-roc-models_files/figure-html/proper-roc-models-bigamma-plots-1-1.png" alt="ROC curves predicted by the bigamma model. The corresponding AUCs are 0.5, 0.879, 0.965 and 0.9999" width="672" />
<p class="caption">
FIGURE 20.7: ROC curves predicted by the bigamma model. The corresponding AUCs are 0.5, 0.879, 0.965 and 0.9999
</p>
</div>
<p>The slopes in Fig. <a href="proper-roc-models.html#fig:proper-roc-models-bigamma-plots-3">20.9</a> are consistent with the pdfs shown in Fig. <a href="proper-roc-models.html#fig:proper-roc-models-bigamma-plots-2">20.8</a>. For example, for plot D, the mean of the diseased distribution is 100 relative to 10 for the non-diseased distribution and performance is close to perfect.</p>
<p>The author is unaware of an analytic expression for AUC of the bigamma model. However the ROC curve can be numerically integrated using the <code>R</code> function <code>pgamma()</code>. Using this yields the following values of AUC of the ROCs shown in Fig. <a href="proper-roc-models.html#fig:proper-roc-models-bigamma-plots-1">20.7</a>: Plot A: AUC = 0.5, Plot B: AUC = 0.8790038, Plot C: AUC = 0.9645528 and Plot D: AUC = 0.9999984.<a href="#fn11" class="footnote-ref" id="fnref11"><sup>11</sup></a></p>
</div>
<div id="proper-roc-models-bigamma-pdfs" class="section level3 hasAnchor">
<h3><span class="header-section-number">20.10.4</span> BGM pdf plots<a href="proper-roc-models.html#proper-roc-models-bigamma-pdfs" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="figure"><span style="display:block;" id="fig:proper-roc-models-bigamma-plots-2"></span>
<img src="20a-proper-roc-models_files/figure-html/proper-roc-models-bigamma-plots-2-1.png" alt="Density functions predicted by bigamma model." width="672" />
<p class="caption">
FIGURE 20.8: Density functions predicted by bigamma model.
</p>
</div>
</div>
<div id="proper-roc-models-bigamma-slopes" class="section level3 hasAnchor">
<h3><span class="header-section-number">20.10.5</span> BGM likelihood ratio plots<a href="proper-roc-models.html#proper-roc-models-bigamma-slopes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="figure"><span style="display:block;" id="fig:proper-roc-models-bigamma-plots-3"></span>
<img src="20a-proper-roc-models_files/figure-html/proper-roc-models-bigamma-plots-3-1.png" alt="Likelihood ratio (or ROC slope) plots predicted by the bigamma model." width="672" />
<p class="caption">
FIGURE 20.9: Likelihood ratio (or ROC slope) plots predicted by the bigamma model.
</p>
</div>
<p>There used to be software called BIGAMMA, formerly MAXGAM <span class="citation">(Dorfman et al. <a href="#ref-dorfman1997proper" role="doc-biblioref">1997</a>)</span>, implementing the bigamma model, but the University of Iowa ROC website now states âBIGAMMA is not available for download at this time. Users who desire a proper ROC model should use PROPROC or CBMâ (<a href="http://perception.radiology.uiowa.edu" class="uri">http://perception.radiology.uiowa.edu</a>, accessed Apr.Â 29, 2017). I understand the de-emphasis of this method, as the proposed bigamma distribution is inconsistent with expectations based on the central limit theorem, namely, when many random processes contribute to a measurement, the net distribution tends to normality, independent of the distributions of the individual processes.</p>
</div>
</div>
<div id="proper-roc-models-discussion" class="section level2 hasAnchor">
<h2><span class="header-section-number">20.11</span> Discussion<a href="proper-roc-models.html#proper-roc-models-discussion" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>With the readily availability of CBM and RSM (both implemented in <code>RJafroc</code>) there is no excuse for not using them. These programs are âbullet-proofâ: they can fit any dataset that one cares to throw at them. The authorâs preference is to use RSM as it yields additional information about search and lesion-localization performance not available using CBM.</p>
<p>PROPOROC has some problems fitting degenerate datasets. These can be readily fixed but to my knowledge no one is actively maintaining this important contribution by Prof.Â Metz.</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-abramowitz1964handbook">
<p>Abramowitz, Milton, and Irene A Stegun. 1964. <em>Handbook of Mathematical Functions with Formulas, Graphs, and Mathematical Tables</em>. Vol. 55. US Government printing office.</p>
</div>
<div id="ref-andersson2008breast">
<p>Andersson, Ingvar, Debra M Ikeda, Sophia Zackrisson, Mark Ruschin, Tony Svahn, Pontus Timberg, and Anders Tingberg. 2008. âBreast Tomosynthesis and Digital Mammography: A Comparison of Breast Cancer Visibility and Birads Classification in a Population of Cancers with Subtle Mammographic Findings.â <em>European Radiology</em> 18 (12): 2817â25.</p>
</div>
<div id="ref-barrett2013foundations">
<p>Barrett, Harrison H, and Kyle J Myers. 2013. <em>Foundations of Image Science</em>. John Wiley &amp; Sons.</p>
</div>
<div id="ref-chakraborty2011estimating">
<p>Chakraborty, DP, and Tony Svahn. 2011. âEstimating the Parameters of a Model of Visual Search from Roc Data: An Alternate Method for Fitting Proper Roc Curves.â In <em>Medical Imaging 2011: Image Perception, Observer Performance, and Technology Assessment</em>, 7966:189â97. SPIE.</p>
</div>
<div id="ref-chakraborty2012inverse">
<p>Chakraborty, DP, Hong-Jun Yoon, and Claudia Mello-Thoms. 2012. âInverse Dependence of Search and Classification Performances in Lesion Localization Tasks.â In <em>Medical Imaging 2012: Image Perception, Observer Performance, and Technology Assessment</em>, 8318:129â40. SPIE.</p>
</div>
<div id="ref-dorfman2000contaminated3">
<p>Dorfman, Donald D, and Kevin S Berbaum. 2000a. âA Contaminated Binormal Model for Roc Data: Part Ii. A Formal Model.â <em>Academic Radiology</em> 7 (6): 427â37.</p>
</div>
<div id="ref-dorfman2000contaminated2">
<p>Dorfman, Donald D, and Kevin S Berbaum. 2000b. âA Contaminated Binormal Model for Roc Data: Part Iii. Initial Evaluation with Detection Roc Data.â <em>Academic Radiology</em> 7 (6): 438â47.</p>
</div>
<div id="ref-dorfman2000contaminated1">
<p>Dorfman, Donald D, Kevin S Berbaum, and Eric A Brandser. 2000. âA Contaminated Binormal Model for Roc Data: Part I. Some Interesting Examples of Binormal Degeneracy.â <em>Academic Radiology</em> 7 (6): 420â26.</p>
</div>
<div id="ref-dorfman1997proper">
<p>Dorfman, Donald D, Kevin S Berbaum, Charles E Metz, Russell V Lenth, James A Hanley, and Hatem Abu Dagga. 1997. âProper Receiver Operating Characteristic Analysis: The Bigamma Model.â <em>Academic Radiology</em> 4 (2): 138â49.</p>
</div>
<div id="ref-Egan1975">
<p>Egan, James P. 1975b. <em>Signal Detection Theory and ROC Analysis</em>. Book. First. Academic Press Series in Cognition and Perception. New York: Academic Press, Inc.</p>
</div>
<div id="ref-green1966signal">
<p>Green, David Marvin, John A Swets, and others. 1966. <em>Signal Detection Theory and Psychophysics</em>. Vol. 1. Wiley New York.</p>
</div>
<div id="ref-larsen2005introduction">
<p>Larsen, Richard J, and Morris L Marx. 2005. <em>An Introduction to Mathematical Statistics</em>. Prentice Hall.</p>
</div>
<div id="ref-metz1978rocmethodology">
<p>Metz, C. E. 1978. âBasic Principles of ROC Analysis.â Journal Article. <em>Seminars in Nuclear Medicine</em> 8 (4): 283â98. <a href="https://doi.org/10.1016/s0001-2998(78)80014-2">https://doi.org/10.1016/s0001-2998(78)80014-2</a>.</p>
</div>
<div id="ref-metz1999proper">
<p>Metz, Charles E, and Xiaochuan Pan. 1999. ââProperâ Binormal Roc Curves: Theory and Maximum-Likelihood Estimation.â <em>Journal of Mathematical Psychology</em> 43 (1): 1â33.</p>
</div>
<div id="ref-neyman1933ix">
<p>Neyman, Jerzy, and Egon Sharpe Pearson. 1933. âIX. On the Problem of the Most Efficient Tests of Statistical Hypotheses.â <em>Philosophical Transactions of the Royal Society of London. Series A, Containing Papers of a Mathematical or Physical Character</em> 231 (694-706): 289â337.</p>
</div>
<div id="ref-pan1997proper">
<p>Pan, Xiaochuan, and Charles E Metz. 1997. âThe âProperâ Binormal Model: Parametric Receiver Operating Characteristic Curve Estimation with Degenerate Data.â <em>Academic Radiology</em> 4 (5): 380â89.</p>
</div>
<div id="ref-swensson1996unified">
<p>Swensson, Richard G. 1996. âUnified Measurement of Observer Performance in Detecting and Localizing Target Objects on Images.â <em>Medical Physics</em> 23 (10): 1709â25.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="4">
<li id="fn4"><p>This is not to be confused with the RSM parameter with the same symbol.<a href="proper-roc-models.html#fnref4" class="footnote-back">â©ï¸</a></p></li>
<li id="fn5"><p>For a positive-directed decision variable, as in this book, the term âmonotonicâ is always meant to be âmonotonic increasingâ. It is possible for a transformation to be monotonic decreasing, as in <span class="math inline">\(l = 1/z\)</span>.<a href="proper-roc-models.html#fnref5" class="footnote-back">â©ï¸</a></p></li>
<li id="fn6"><p>I achieved this extraordinary precision by solving the quadratic equation in Mapleâ¢.<a href="proper-roc-models.html#fnref6" class="footnote-back">â©ï¸</a></p></li>
<li id="fn7"><p>One needs to think carefully about this sentence to eventually âget itâ.<a href="proper-roc-models.html#fnref7" class="footnote-back">â©ï¸</a></p></li>
<li id="fn8"><p>The 1999 publication is a difficult read but well worth it for deeper understanding.<a href="proper-roc-models.html#fnref8" class="footnote-back">â©ï¸</a></p></li>
<li id="fn9"><p>The two values of z corresponding to each cut implies, of course, that the binormal model based proper algorithm has to do a lot of bookkeeping, since, in general, each horizontal cut splits the decision axis into 3 regions.<a href="proper-roc-models.html#fnref9" class="footnote-back">â©ï¸</a></p></li>
<li id="fn10"><p>dorfman1997proper<a href="proper-roc-models.html#fnref10" class="footnote-back">â©ï¸</a></p></li>
<li id="fn11"><p>One can confirm that values of <span class="math inline">\(\lambda &gt; 1\)</span> yield ROC curves below the chance diagonal and AUC less than 0.5. These ROC curves are actually âreflectedâ versions of proper ROC curves; for each such curve the slope starts at a finite positive value near the origin and increases to infinity near the top right corner.<a href="proper-roc-models.html#fnref11" class="footnote-back">â©ï¸</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="degenerate-rocs.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="proproc-rocs.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["RJafrocRocBook.pdf", "RJafrocRocBook.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
