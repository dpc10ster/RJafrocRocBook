<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Proper ROC models | The RJafroc Roc Book</title>
  <meta name="description" content="Artificial intelligence and observer performance book based on RJafroc." />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Proper ROC models | The RJafroc Roc Book" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Artificial intelligence and observer performance book based on RJafroc." />
  <meta name="github-repo" content="dpc10ster/RJafrocRocBook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Proper ROC models | The RJafroc Roc Book" />
  
  <meta name="twitter:description" content="Artificial intelligence and observer performance book based on RJafroc." />
  

<meta name="author" content="Dev P. Chakraborty, PhD" />


<meta name="date" content="2023-03-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="binormal-model.html"/>
<link rel="next" href="proproc-rocs.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">RJafroc documentation</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#rationale-and-organization"><i class="fa fa-check"></i><b>0.1</b> Rationale and Organization</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#tba-acknowledgements"><i class="fa fa-check"></i><b>0.2</b> TBA Acknowledgements</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#temporary-comments"><i class="fa fa-check"></i><b>0.3</b> Temporary comments</a></li>
</ul></li>
<li class="part"><span><b>Overview</b></span></li>
<li class="chapter" data-level="1" data-path="overview.html"><a href="overview.html"><i class="fa fa-check"></i><b>1</b> An overview of the field</a>
<ul>
<li class="chapter" data-level="1.1" data-path="overview.html"><a href="overview.html#overview-how-much-finished"><i class="fa fa-check"></i><b>1.1</b> How much finished 55%</a></li>
<li class="chapter" data-level="1.2" data-path="overview.html"><a href="overview.html#preliminaries-intro"><i class="fa fa-check"></i><b>1.2</b> Introduction</a></li>
<li class="chapter" data-level="1.3" data-path="overview.html"><a href="overview.html#clinical-tasks"><i class="fa fa-check"></i><b>1.3</b> Clinical tasks</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="overview.html"><a href="overview.html#workflow-in-an-imaging-study"><i class="fa fa-check"></i><b>1.3.1</b> Workflow in an imaging study</a></li>
<li class="chapter" data-level="1.3.2" data-path="overview.html"><a href="overview.html#the-screening-and-diagnostic-workup-tasks"><i class="fa fa-check"></i><b>1.3.2</b> The screening and diagnostic workup tasks</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="overview.html"><a href="overview.html#imaging-device-development-and-its-clinical-deployment"><i class="fa fa-check"></i><b>1.4</b> Imaging device development and its clinical deployment</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="overview.html"><a href="overview.html#physical-measurements"><i class="fa fa-check"></i><b>1.4.1</b> Physical measurements</a></li>
<li class="chapter" data-level="1.4.2" data-path="overview.html"><a href="overview.html#quality-control-and-image-quality-optimization"><i class="fa fa-check"></i><b>1.4.2</b> Quality Control and Image quality optimization</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="overview.html"><a href="overview.html#image-quality-vs.-task-performance"><i class="fa fa-check"></i><b>1.5</b> Image quality vs.Â task performance</a></li>
<li class="chapter" data-level="1.6" data-path="overview.html"><a href="overview.html#why-physical-measures-are-not-enough"><i class="fa fa-check"></i><b>1.6</b> Why physical measures are not enough</a></li>
<li class="chapter" data-level="1.7" data-path="overview.html"><a href="overview.html#model-observers"><i class="fa fa-check"></i><b>1.7</b> Model observers</a></li>
<li class="chapter" data-level="1.8" data-path="overview.html"><a href="overview.html#measuring-observer-performance-four-paradigms"><i class="fa fa-check"></i><b>1.8</b> Measuring observer performance: four paradigms</a>
<ul>
<li class="chapter" data-level="1.8.1" data-path="overview.html"><a href="overview.html#basic-approach-to-the-analysis"><i class="fa fa-check"></i><b>1.8.1</b> Basic approach to the analysis</a></li>
<li class="chapter" data-level="1.8.2" data-path="overview.html"><a href="overview.html#historical-notes"><i class="fa fa-check"></i><b>1.8.2</b> Historical notes</a></li>
</ul></li>
<li class="chapter" data-level="1.9" data-path="overview.html"><a href="overview.html#hierarchy-of-assessment-methods"><i class="fa fa-check"></i><b>1.9</b> Hierarchy of assessment methods</a></li>
<li class="chapter" data-level="1.10" data-path="overview.html"><a href="overview.html#overview-of-the-book-and-how-to-use-it"><i class="fa fa-check"></i><b>1.10</b> Overview of the book and how to use it</a>
<ul>
<li class="chapter" data-level="1.10.1" data-path="overview.html"><a href="overview.html#overview-of-the-book"><i class="fa fa-check"></i><b>1.10.1</b> Overview of the book</a></li>
<li class="chapter" data-level="1.10.2" data-path="overview.html"><a href="overview.html#how-to-use-the-book"><i class="fa fa-check"></i><b>1.10.2</b> How to use the book</a></li>
</ul></li>
<li class="chapter" data-level="1.11" data-path="overview.html"><a href="overview.html#overview-Summary"><i class="fa fa-check"></i><b>1.11</b> Summary</a></li>
<li class="chapter" data-level="1.12" data-path="overview.html"><a href="overview.html#overview-Discussion"><i class="fa fa-check"></i><b>1.12</b> Discussion</a></li>
<li class="chapter" data-level="1.13" data-path="overview.html"><a href="overview.html#overview-references"><i class="fa fa-check"></i><b>1.13</b> Chapter References</a></li>
</ul></li>
<li class="part"><span><b>ROC paradigm</b></span></li>
<li class="chapter" data-level="2" data-path="binary-task.html"><a href="binary-task.html"><i class="fa fa-check"></i><b>2</b> The Binary Task</a>
<ul>
<li class="chapter" data-level="2.1" data-path="binary-task.html"><a href="binary-task.html#binary-task-how-much-finished"><i class="fa fa-check"></i><b>2.1</b> How much finished 90%</a></li>
<li class="chapter" data-level="2.2" data-path="binary-task.html"><a href="binary-task.html#binary-taskIntro"><i class="fa fa-check"></i><b>2.2</b> Introduction</a></li>
<li class="chapter" data-level="2.3" data-path="binary-task.html"><a href="binary-task.html#binary-task-2-2-table"><i class="fa fa-check"></i><b>2.3</b> The 2x2 table</a></li>
<li class="chapter" data-level="2.4" data-path="binary-task.html"><a href="binary-task.html#sensitivity-and-specificity"><i class="fa fa-check"></i><b>2.4</b> Sensitivity and specificity</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="binary-task.html"><a href="binary-task.html#estimating-sensitivity-and-specificity"><i class="fa fa-check"></i><b>2.4.1</b> Estimating sensitivity and specificity</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="binary-task.html"><a href="binary-task.html#disease-prevalence"><i class="fa fa-check"></i><b>2.5</b> Disease prevalence</a></li>
<li class="chapter" data-level="2.6" data-path="binary-task.html"><a href="binary-task.html#accuracy"><i class="fa fa-check"></i><b>2.6</b> Accuracy</a></li>
<li class="chapter" data-level="2.7" data-path="binary-task.html"><a href="binary-task.html#negative-and-positive-predictive-values"><i class="fa fa-check"></i><b>2.7</b> Negative and positive predictive values</a></li>
<li class="chapter" data-level="2.8" data-path="binary-task.html"><a href="binary-task.html#binary-taskNpvPpvCode"><i class="fa fa-check"></i><b>2.8</b> Examples: PPV, NPV and Accuracy</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="binary-task.html"><a href="binary-task.html#binary-task-npv-ppv-comments"><i class="fa fa-check"></i><b>2.8.1</b> Comments</a></li>
<li class="chapter" data-level="2.8.2" data-path="binary-task.html"><a href="binary-task.html#binary-task-npv-ppv-irrel-lab"><i class="fa fa-check"></i><b>2.8.2</b> PPV and NPV are irrelevant to laboratory tasks</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="binary-task.html"><a href="binary-task.html#binary-task-discussion"><i class="fa fa-check"></i><b>2.9</b> Discussion</a></li>
<li class="chapter" data-level="2.10" data-path="binary-task.html"><a href="binary-task.html#binary-task-references"><i class="fa fa-check"></i><b>2.10</b> Chapter References</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="binary-task-model.html"><a href="binary-task-model.html"><i class="fa fa-check"></i><b>3</b> Modeling the binary Task</a>
<ul>
<li class="chapter" data-level="3.1" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-how-much-finished"><i class="fa fa-check"></i><b>3.1</b> How much finished 95%</a></li>
<li class="chapter" data-level="3.2" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-intro"><i class="fa fa-check"></i><b>3.2</b> Introduction</a></li>
<li class="chapter" data-level="3.3" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-z-sample-model"><i class="fa fa-check"></i><b>3.3</b> Decision variable and reporting threshold</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="binary-task-model.html"><a href="binary-task-model.html#existence-of-a-decision-variable"><i class="fa fa-check"></i><b>3.3.1</b> Existence of a decision variable</a></li>
<li class="chapter" data-level="3.3.2" data-path="binary-task-model.html"><a href="binary-task-model.html#existence-of-a-reporting-threshold"><i class="fa fa-check"></i><b>3.3.2</b> Existence of a reporting threshold</a></li>
<li class="chapter" data-level="3.3.3" data-path="binary-task-model.html"><a href="binary-task-model.html#adequacy-of-the-training-session"><i class="fa fa-check"></i><b>3.3.3</b> Adequacy of the training session</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-example-1"><i class="fa fa-check"></i><b>3.4</b> Changing the reporting threshold: I</a></li>
<li class="chapter" data-level="3.5" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-example-2"><i class="fa fa-check"></i><b>3.5</b> Changing the reporting threshold: II</a></li>
<li class="chapter" data-level="3.6" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-equal-variance-binormal-model"><i class="fa fa-check"></i><b>3.6</b> The equal-variance binormal model</a></li>
<li class="chapter" data-level="3.7" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-normal-distribution"><i class="fa fa-check"></i><b>3.7</b> The normal distribution</a></li>
<li class="chapter" data-level="3.8" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-sensitivity-specificity"><i class="fa fa-check"></i><b>3.8</b> Analytic expressions for specificity and sensitivity</a></li>
<li class="chapter" data-level="3.9" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-sensitivity-specificity-inverse-variation"><i class="fa fa-check"></i><b>3.9</b> Inverse variation of sensitivity and specificity</a></li>
<li class="chapter" data-level="3.10" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-roc-curve"><i class="fa fa-check"></i><b>3.10</b> The ROC curve</a>
<ul>
<li class="chapter" data-level="3.10.1" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-chance-diagonal"><i class="fa fa-check"></i><b>3.10.1</b> The chance diagonal</a></li>
<li class="chapter" data-level="3.10.2" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-guessing-observer"><i class="fa fa-check"></i><b>3.10.2</b> The guessing observer</a></li>
<li class="chapter" data-level="3.10.3" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-symmetry-wrt-negative-diagonal"><i class="fa fa-check"></i><b>3.10.3</b> Symmetry with respect to negative diagonal</a></li>
<li class="chapter" data-level="3.10.4" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-auc-roc-important"><i class="fa fa-check"></i><b>3.10.4</b> Area under the ROC curve</a></li>
<li class="chapter" data-level="3.10.5" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-properties-roc"><i class="fa fa-check"></i><b>3.10.5</b> Properties of the equal-variance binormal model ROC curve</a></li>
<li class="chapter" data-level="3.10.6" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-comments"><i class="fa fa-check"></i><b>3.10.6</b> Comments</a></li>
<li class="chapter" data-level="3.10.7" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-mu-parameter-intepretation"><i class="fa fa-check"></i><b>3.10.7</b> Physical interpretation of the mu-parameter</a></li>
</ul></li>
<li class="chapter" data-level="3.11" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-confidence-intervals"><i class="fa fa-check"></i><b>3.11</b> Confidence intervals for an operating point</a></li>
<li class="chapter" data-level="3.12" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-beam-study"><i class="fa fa-check"></i><b>3.12</b> Variability: the Beam study</a></li>
<li class="chapter" data-level="3.13" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-discussion"><i class="fa fa-check"></i><b>3.13</b> Discussion</a></li>
<li class="chapter" data-level="3.14" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-demo"><i class="fa fa-check"></i><b>3.14</b> Appendix I</a>
<ul>
<li class="chapter" data-level="3.14.1" data-path="binary-task-model.html"><a href="binary-task-model.html#estimates-from-a-finite-sample"><i class="fa fa-check"></i><b>3.14.1</b> Estimates from a finite sample</a></li>
<li class="chapter" data-level="3.14.2" data-path="binary-task-model.html"><a href="binary-task-model.html#changing-the-seed-variable"><i class="fa fa-check"></i><b>3.14.2</b> Changing the seed variable</a></li>
<li class="chapter" data-level="3.14.3" data-path="binary-task-model.html"><a href="binary-task-model.html#increasing-the-numbers-of-cases"><i class="fa fa-check"></i><b>3.14.3</b> Increasing the numbers of cases</a></li>
</ul></li>
<li class="chapter" data-level="3.15" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-references"><i class="fa fa-check"></i><b>3.15</b> Chapter References</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ratings-paradigm.html"><a href="ratings-paradigm.html"><i class="fa fa-check"></i><b>4</b> Ratings Paradigm</a>
<ul>
<li class="chapter" data-level="4.1" data-path="ratings-paradigm.html"><a href="ratings-paradigm.html#ratings-paradigm-how-much-finished"><i class="fa fa-check"></i><b>4.1</b> How much finished 90%</a></li>
<li class="chapter" data-level="4.2" data-path="ratings-paradigm.html"><a href="ratings-paradigm.html#ratings-paradigm-introduction"><i class="fa fa-check"></i><b>4.2</b> Introduction</a></li>
<li class="chapter" data-level="4.3" data-path="ratings-paradigm.html"><a href="ratings-paradigm.html#ratings-paradigm-roc-counts-table"><i class="fa fa-check"></i><b>4.3</b> The ROC counts table</a></li>
<li class="chapter" data-level="4.4" data-path="ratings-paradigm.html"><a href="ratings-paradigm.html#ratings-task-operating-points-from-counts-table"><i class="fa fa-check"></i><b>4.4</b> Operating points from counts table</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="ratings-paradigm.html"><a href="ratings-paradigm.html#labeling-the-points"><i class="fa fa-check"></i><b>4.4.1</b> Labeling the points</a></li>
<li class="chapter" data-level="4.4.2" data-path="ratings-paradigm.html"><a href="ratings-paradigm.html#ratings-task-examples"><i class="fa fa-check"></i><b>4.4.2</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="ratings-paradigm.html"><a href="ratings-paradigm.html#ratings-task-code"><i class="fa fa-check"></i><b>4.5</b> Implemention in code</a></li>
<li class="chapter" data-level="4.6" data-path="ratings-paradigm.html"><a href="ratings-paradigm.html#ratings-task-relation-binary-to-rating"><i class="fa fa-check"></i><b>4.6</b> Relation between ratings paradigm and the binary paradigm</a></li>
<li class="chapter" data-level="4.7" data-path="ratings-paradigm.html"><a href="ratings-paradigm.html#binary-task-ratings-not-numerical-values"><i class="fa fa-check"></i><b>4.7</b> Ratings are not numerical values</a></li>
<li class="chapter" data-level="4.8" data-path="ratings-paradigm.html"><a href="ratings-paradigm.html#binary-task-clinical-operating-point"><i class="fa fa-check"></i><b>4.8</b> A single âclinicalâ operating point from ratings data</a></li>
<li class="chapter" data-level="4.9" data-path="ratings-paradigm.html"><a href="ratings-paradigm.html#binary-task-2afc"><i class="fa fa-check"></i><b>4.9</b> The forced choice paradigm</a></li>
<li class="chapter" data-level="4.10" data-path="ratings-paradigm.html"><a href="ratings-paradigm.html#binary-task-observer-studies-as-simulations"><i class="fa fa-check"></i><b>4.10</b> Observer performance studies as laboratory simulations of clinical tasks</a></li>
<li class="chapter" data-level="4.11" data-path="ratings-paradigm.html"><a href="ratings-paradigm.html#binary-task-discrete-vs-continuous-ratings"><i class="fa fa-check"></i><b>4.11</b> Discrete vs.Â continuous ratings: the Miller study</a></li>
<li class="chapter" data-level="4.12" data-path="ratings-paradigm.html"><a href="ratings-paradigm.html#binary-task-birads-rating-scale"><i class="fa fa-check"></i><b>4.12</b> The BI-RADS ratings scale and ROC studies</a>
<ul>
<li class="chapter" data-level="4.12.1" data-path="ratings-paradigm.html"><a href="ratings-paradigm.html#binary-task-birads-rating-scale-controversy"><i class="fa fa-check"></i><b>4.12.1</b> The controversy</a></li>
</ul></li>
<li class="chapter" data-level="4.13" data-path="ratings-paradigm.html"><a href="ratings-paradigm.html#ratings-paradigm-discussion"><i class="fa fa-check"></i><b>4.13</b> Discussion</a></li>
<li class="chapter" data-level="4.14" data-path="ratings-paradigm.html"><a href="ratings-paradigm.html#ratings-paradigm-references"><i class="fa fa-check"></i><b>4.14</b> Chapter References</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="empirical-auc.html"><a href="empirical-auc.html"><i class="fa fa-check"></i><b>5</b> Empirical AUC</a>
<ul>
<li class="chapter" data-level="5.1" data-path="empirical-auc.html"><a href="empirical-auc.html#empirical-auc-how-much-finished"><i class="fa fa-check"></i><b>5.1</b> How much finished 90%</a></li>
<li class="chapter" data-level="5.2" data-path="empirical-auc.html"><a href="empirical-auc.html#empirical-auc-introduction"><i class="fa fa-check"></i><b>5.2</b> Introduction</a></li>
<li class="chapter" data-level="5.3" data-path="empirical-auc.html"><a href="empirical-auc.html#empirical-roc-plot"><i class="fa fa-check"></i><b>5.3</b> The empirical ROC plot</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="empirical-auc.html"><a href="empirical-auc.html#notation-for-cases"><i class="fa fa-check"></i><b>5.3.1</b> Notation for cases</a></li>
<li class="chapter" data-level="5.3.2" data-path="empirical-auc.html"><a href="empirical-auc.html#an-empirical-operating-point"><i class="fa fa-check"></i><b>5.3.2</b> An empirical operating point</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="empirical-auc.html"><a href="empirical-auc.html#empirical-auc-operating-points"><i class="fa fa-check"></i><b>5.4</b> Empirical operating points from ratings data</a></li>
<li class="chapter" data-level="5.5" data-path="empirical-auc.html"><a href="empirical-auc.html#empirical-auc-area-under"><i class="fa fa-check"></i><b>5.5</b> AUC under the empirical ROC plot</a></li>
<li class="chapter" data-level="5.6" data-path="empirical-auc.html"><a href="empirical-auc.html#empirical-auc-wilcoxon"><i class="fa fa-check"></i><b>5.6</b> The Wilcoxon statistic</a></li>
<li class="chapter" data-level="5.7" data-path="empirical-auc.html"><a href="empirical-auc.html#empirical-auc-wilcoxon-bamber-theorem"><i class="fa fa-check"></i><b>5.7</b> Bamberâs Equivalence theorem</a></li>
<li class="chapter" data-level="5.8" data-path="empirical-auc.html"><a href="empirical-auc.html#empirical-auc-wilcoxon-bamber-theorem-importance"><i class="fa fa-check"></i><b>5.8</b> Importance of Bamberâs theorem</a></li>
<li class="chapter" data-level="5.9" data-path="empirical-auc.html"><a href="empirical-auc.html#empirical-auc-discussion-summary"><i class="fa fa-check"></i><b>5.9</b> Discussion / Summary</a></li>
<li class="chapter" data-level="5.10" data-path="empirical-auc.html"><a href="empirical-auc.html#empirical-auc-bamber-theorem-proof"><i class="fa fa-check"></i><b>5.10</b> Appendix: Bamber theorem proof</a></li>
<li class="chapter" data-level="5.11" data-path="empirical-auc.html"><a href="empirical-auc.html#empirical-auc-bamber-theorem-a0-term"><i class="fa fa-check"></i><b>5.11</b> Appendix: The <span class="math inline">\(A_0\)</span> term</a>
<ul>
<li class="chapter" data-level="5.11.1" data-path="empirical-auc.html"><a href="empirical-auc.html#upper-triangle"><i class="fa fa-check"></i><b>5.11.1</b> Upper triangle</a></li>
<li class="chapter" data-level="5.11.2" data-path="empirical-auc.html"><a href="empirical-auc.html#lowest-trapezoid"><i class="fa fa-check"></i><b>5.11.2</b> Lowest trapezoid</a></li>
</ul></li>
<li class="chapter" data-level="5.12" data-path="empirical-auc.html"><a href="empirical-auc.html#empirical-auc-references"><i class="fa fa-check"></i><b>5.12</b> Chapter References</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="binormal-model.html"><a href="binormal-model.html"><i class="fa fa-check"></i><b>6</b> Binormal model</a>
<ul>
<li class="chapter" data-level="6.1" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-how-much-finished"><i class="fa fa-check"></i><b>6.1</b> How much finished 97%</a></li>
<li class="chapter" data-level="6.2" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-introduction"><i class="fa fa-check"></i><b>6.2</b> Introduction</a></li>
<li class="chapter" data-level="6.3" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-definition"><i class="fa fa-check"></i><b>6.3</b> Binormal model</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="binormal-model.html"><a href="binormal-model.html#binned-data"><i class="fa fa-check"></i><b>6.3.1</b> Binned data</a></li>
<li class="chapter" data-level="6.3.2" data-path="binormal-model.html"><a href="binormal-model.html#sensitivity-and-specificity-1"><i class="fa fa-check"></i><b>6.3.2</b> Sensitivity and specificity</a></li>
<li class="chapter" data-level="6.3.3" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-in-conventional-notation"><i class="fa fa-check"></i><b>6.3.3</b> Binormal model in conventional notation</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-roc-curve"><i class="fa fa-check"></i><b>6.4</b> ROC curve</a></li>
<li class="chapter" data-level="6.5" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-pdfs"><i class="fa fa-check"></i><b>6.5</b> Density functions</a></li>
<li class="chapter" data-level="6.6" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-invariance-property"><i class="fa fa-check"></i><b>6.6</b> Invariance property of pdfs</a></li>
<li class="chapter" data-level="6.7" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-full-auc"><i class="fa fa-check"></i><b>6.7</b> Az and d-prime measures</a></li>
<li class="chapter" data-level="6.8" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-fitting"><i class="fa fa-check"></i><b>6.8</b> Fitting the binormal model</a></li>
<li class="chapter" data-level="6.9" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-partial-auc"><i class="fa fa-check"></i><b>6.9</b> Partial AUC measures</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-meaning-partial-auc-definitions"><i class="fa fa-check"></i><b>6.9.1</b> Measure emphasizing high specificity</a></li>
<li class="chapter" data-level="6.9.2" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-metz-partial-auc"><i class="fa fa-check"></i><b>6.9.2</b> Measure emphasizing high sensitivity</a></li>
<li class="chapter" data-level="6.9.3" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-metz-partial-auc-example"><i class="fa fa-check"></i><b>6.9.3</b> Numerical examples</a></li>
</ul></li>
<li class="chapter" data-level="6.10" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-partial-auc-comments"><i class="fa fa-check"></i><b>6.10</b> Comments on partial AUC measures</a></li>
<li class="chapter" data-level="6.11" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-discussion"><i class="fa fa-check"></i><b>6.11</b> Discussion</a></li>
<li class="chapter" data-level="6.12" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-curve-fitting"><i class="fa fa-check"></i><b>6.12</b> Appendix: Fitting an ROC curve</a>
<ul>
<li class="chapter" data-level="6.12.1" data-path="binormal-model.html"><a href="binormal-model.html#java-fitted-roc-curve"><i class="fa fa-check"></i><b>6.12.1</b> JAVA fitted ROC curve</a></li>
<li class="chapter" data-level="6.12.2" data-path="binormal-model.html"><a href="binormal-model.html#simplistic-straight-line-fit-to-the-roc-curve"><i class="fa fa-check"></i><b>6.12.2</b> Simplistic straight line fit to the ROC curve</a></li>
<li class="chapter" data-level="6.12.3" data-path="binormal-model.html"><a href="binormal-model.html#maximum-likelihood-estimation-mle"><i class="fa fa-check"></i><b>6.12.3</b> Maximum likelihood estimation (MLE)</a></li>
<li class="chapter" data-level="6.12.4" data-path="binormal-model.html"><a href="binormal-model.html#code-implementing-mle"><i class="fa fa-check"></i><b>6.12.4</b> Code implementing MLE</a></li>
<li class="chapter" data-level="6.12.5" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-curve-fitting-validation"><i class="fa fa-check"></i><b>6.12.5</b> Validating the fit</a></li>
<li class="chapter" data-level="6.12.6" data-path="binormal-model.html"><a href="binormal-model.html#estimating-the-covariance-matrix"><i class="fa fa-check"></i><b>6.12.6</b> Estimating the covariance matrix</a></li>
<li class="chapter" data-level="6.12.7" data-path="binormal-model.html"><a href="binormal-model.html#estimating-the-variance-of-az"><i class="fa fa-check"></i><b>6.12.7</b> Estimating the variance of Az</a></li>
</ul></li>
<li class="chapter" data-level="6.13" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-improper-curves"><i class="fa fa-check"></i><b>6.13</b> Appendix: Improper ROCs</a>
<ul>
<li class="chapter" data-level="6.13.1" data-path="binormal-model.html"><a href="binormal-model.html#reason-for-improper-rocs"><i class="fa fa-check"></i><b>6.13.1</b> Reason for improper ROCs</a></li>
</ul></li>
<li class="chapter" data-level="6.14" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-degeneracy"><i class="fa fa-check"></i><b>6.14</b> Degenerate datasets</a>
<ul>
<li class="chapter" data-level="6.14.1" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-understanding-degenerate-datasets"><i class="fa fa-check"></i><b>6.14.1</b> Understanding degenerate datasets</a></li>
<li class="chapter" data-level="6.14.2" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-exact-fit-not-unique"><i class="fa fa-check"></i><b>6.14.2</b> The exact fit is not unique</a></li>
<li class="chapter" data-level="6.14.3" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-spread-ratings"><i class="fa fa-check"></i><b>6.14.3</b> On instructing an observer to âspread their ratingsâ</a></li>
<li class="chapter" data-level="6.14.4" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-reasonable-fit"><i class="fa fa-check"></i><b>6.14.4</b> A reasonable fit to the degenerate dataset</a></li>
</ul></li>
<li class="chapter" data-level="6.15" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-references"><i class="fa fa-check"></i><b>6.15</b> Chapter References</a></li>
</ul></li>
<li class="part"><span><b>Advanced topics</b></span></li>
<li class="chapter" data-level="7" data-path="proper-roc-models.html"><a href="proper-roc-models.html"><i class="fa fa-check"></i><b>7</b> Proper ROC models</a>
<ul>
<li class="chapter" data-level="7.1" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-how-much-finished"><i class="fa fa-check"></i><b>7.1</b> How much finished 50%</a></li>
<li class="chapter" data-level="7.2" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-introduction"><i class="fa fa-check"></i><b>7.2</b> Introduction</a></li>
<li class="chapter" data-level="7.3" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-likelihood-ratio-theorem1"><i class="fa fa-check"></i><b>7.3</b> ROC slope equals likelihood ratio</a></li>
<li class="chapter" data-level="7.4" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-likelihood-ratio-theorem2"><i class="fa fa-check"></i><b>7.4</b> The likelihood ratio observer maximizes AUC</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="proper-roc-models.html"><a href="proper-roc-models.html#explanation"><i class="fa fa-check"></i><b>7.4.1</b> Explanation</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-likelihood-ratio-observer"><i class="fa fa-check"></i><b>7.5</b> The likelihood ratio observer</a></li>
<li class="chapter" data-level="7.6" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-proproc"><i class="fa fa-check"></i><b>7.6</b> PROPROC</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-proproc-formulae"><i class="fa fa-check"></i><b>7.6.1</b> PROPROC formulae</a></li>
<li class="chapter" data-level="7.6.2" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-proproc-code"><i class="fa fa-check"></i><b>7.6.2</b> PROPROC code implementation</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-cbm"><i class="fa fa-check"></i><b>7.7</b> The contaminated binormal model (CBM)</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-cbm-formulae"><i class="fa fa-check"></i><b>7.7.1</b> CBM formulae</a></li>
<li class="chapter" data-level="7.7.2" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-cbm-code"><i class="fa fa-check"></i><b>7.7.2</b> CBM code implementation</a></li>
<li class="chapter" data-level="7.7.3" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-cbm-rocs"><i class="fa fa-check"></i><b>7.7.3</b> CBM ROC plots</a></li>
<li class="chapter" data-level="7.7.4" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-cbm-pdfs"><i class="fa fa-check"></i><b>7.7.4</b> CBM pdf plots</a></li>
<li class="chapter" data-level="7.7.5" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-cbm-slopes"><i class="fa fa-check"></i><b>7.7.5</b> CBM likelihood ratio plots</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-bigamma"><i class="fa fa-check"></i><b>7.8</b> The bigamma model (BGM)</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-bigamma-formulae"><i class="fa fa-check"></i><b>7.8.1</b> BGM formulae</a></li>
<li class="chapter" data-level="7.8.2" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-bigamma-code"><i class="fa fa-check"></i><b>7.8.2</b> BGM code implementation</a></li>
<li class="chapter" data-level="7.8.3" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-bigamma-rocs"><i class="fa fa-check"></i><b>7.8.3</b> BGM ROC plots</a></li>
<li class="chapter" data-level="7.8.4" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-bigamma-pdfs"><i class="fa fa-check"></i><b>7.8.4</b> BGM pdf plots</a></li>
<li class="chapter" data-level="7.8.5" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-bigamma-slopes"><i class="fa fa-check"></i><b>7.8.5</b> BGM likelihood ratio plots</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-discussion"><i class="fa fa-check"></i><b>7.9</b> Discussion</a></li>
<li class="chapter" data-level="7.10" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-references"><i class="fa fa-check"></i><b>7.10</b> Chapter References</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="proproc-rocs.html"><a href="proproc-rocs.html"><i class="fa fa-check"></i><b>8</b> PROPROC ROC curves</a>
<ul>
<li class="chapter" data-level="8.1" data-path="proproc-rocs.html"><a href="proproc-rocs.html#helper-functions"><i class="fa fa-check"></i><b>8.1</b> Helper functions</a></li>
<li class="chapter" data-level="8.2" data-path="proproc-rocs.html"><a href="proproc-rocs.html#definitions-of-proproc-parameters-in-terms-of-binormal-model-parameters"><i class="fa fa-check"></i><b>8.2</b> Definitions of PROPROC parameters in terms of binormal model parameters</a></li>
<li class="chapter" data-level="8.3" data-path="proproc-rocs.html"><a href="proproc-rocs.html#main-code-and-output"><i class="fa fa-check"></i><b>8.3</b> Main code and output</a></li>
<li class="chapter" data-level="8.4" data-path="proproc-rocs.html"><a href="proproc-rocs.html#discussion"><i class="fa fa-check"></i><b>8.4</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="metz-eqn-36.html"><a href="metz-eqn-36.html"><i class="fa fa-check"></i><b>9</b> Metz Eqn 36 numerical check</a>
<ul>
<li class="chapter" data-level="9.1" data-path="metz-eqn-36.html"><a href="metz-eqn-36.html#helper-functions-1"><i class="fa fa-check"></i><b>9.1</b> Helper functions</a></li>
<li class="chapter" data-level="9.2" data-path="metz-eqn-36.html"><a href="metz-eqn-36.html#main-code-and-output-1"><i class="fa fa-check"></i><b>9.2</b> Main code and output</a></li>
<li class="chapter" data-level="9.3" data-path="metz-eqn-36.html"><a href="metz-eqn-36.html#discussion-1"><i class="fa fa-check"></i><b>9.3</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html"><i class="fa fa-check"></i><b>10</b> Bivariate binormal model</a>
<ul>
<li class="chapter" data-level="10.1" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-how-much-finished"><i class="fa fa-check"></i><b>10.1</b> TBA How much finished</a></li>
<li class="chapter" data-level="10.2" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-introduction"><i class="fa fa-check"></i><b>10.2</b> Introduction</a></li>
<li class="chapter" data-level="10.3" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-bivariate-density"><i class="fa fa-check"></i><b>10.3</b> Bivariate density function</a></li>
<li class="chapter" data-level="10.4" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-formulae"><i class="fa fa-check"></i><b>10.4</b> The bivariate binormal model</a></li>
<li class="chapter" data-level="10.5" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-multivariate-density-visualization"><i class="fa fa-check"></i><b>10.5</b> Visualizing the bivariate density function</a></li>
<li class="chapter" data-level="10.6" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-multivariate-density-estimation"><i class="fa fa-check"></i><b>10.6</b> Estimating bivariate binormal model parameters</a></li>
<li class="chapter" data-level="10.7" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-multivariate-density-examples"><i class="fa fa-check"></i><b>10.7</b> Examples of bivariate normal probability integrals</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-multivariate-density-estimation-code"><i class="fa fa-check"></i><b>10.7.1</b> Code listing</a></li>
<li class="chapter" data-level="10.7.2" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-examples-integrals"><i class="fa fa-check"></i><b>10.7.2</b> Examples of bivariate normal probability integrals</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-likelihood"><i class="fa fa-check"></i><b>10.8</b> Likelihood function</a></li>
<li class="chapter" data-level="10.9" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-corroc2"><i class="fa fa-check"></i><b>10.9</b> CORROC2 software</a>
<ul>
<li class="chapter" data-level="10.9.1" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-corroc2-details"><i class="fa fa-check"></i><b>10.9.1</b> Details of CORROC2 software</a></li>
<li class="chapter" data-level="10.9.2" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-corroc2-data-input"><i class="fa fa-check"></i><b>10.9.2</b> CORROC2 data input</a></li>
<li class="chapter" data-level="10.9.3" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-corroc2-output"><i class="fa fa-check"></i><b>10.9.3</b> CORROC2 output</a></li>
<li class="chapter" data-level="10.9.4" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-corroc2-covariance-matrix"><i class="fa fa-check"></i><b>10.9.4</b> Covariance matrix</a></li>
<li class="chapter" data-level="10.9.5" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-corroc2-output-restof"><i class="fa fa-check"></i><b>10.9.5</b> Rest of CORROC2 output</a></li>
</ul></li>
<li class="chapter" data-level="10.10" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-corroc2-application"><i class="fa fa-check"></i><b>10.10</b> Application to a real dataset</a>
<ul>
<li class="chapter" data-level="10.10.1" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-corroc2-application-code-output"><i class="fa fa-check"></i><b>10.10.1</b> Code Output</a></li>
<li class="chapter" data-level="10.10.2" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-corroc2-application-debug-window"><i class="fa fa-check"></i><b>10.10.2</b> Contents of the Debug window, as viewed from the Mac side</a></li>
<li class="chapter" data-level="10.10.3" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-corroc2-application-corrocii-input"><i class="fa fa-check"></i><b>10.10.3</b> Contents of CorrocIIinput.txt</a></li>
</ul></li>
<li class="chapter" data-level="10.11" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-corroc2-discussion"><i class="fa fa-check"></i><b>10.11</b> Discussion / Summary</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>REFERENCES</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The RJafroc Roc Book</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="proper-roc-models" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">Chapter 7</span> Proper ROC models<a href="proper-roc-models.html#proper-roc-models" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="proper-roc-models-how-much-finished" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> How much finished 50%<a href="proper-roc-models.html#proper-roc-models-how-much-finished" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="proper-roc-models-introduction" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> Introduction<a href="proper-roc-models.html#proper-roc-models-introduction" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The binormal model has been widely used to fit ROC datasets in a wide range of applications not limited to medical imaging. However, binormal model fits almost invariably lead to ROC curves that inappropriately cross the chance diagonal leading to a prediction of a region of the ROC curve where performance is worse than chance even for expert observers. By convention, such curves are termed âimproperâ. A chance line crossing near the upper right corner of the ROC plot occurs when <span class="math inline">\(b &lt; 1\)</span> and near the origin if <span class="math inline">\(b &gt; 1\)</span>.</p>
<blockquote>
<p>Since <span class="math inline">\(b\)</span> is a continuous-variable parameter there is zero probability that an estimate of <span class="math inline">\(b\)</span> will be exactly equal to one, the only condition under which there is no âhookâ. Therefore, every fitted binormal model ROC curve is âimproperâ.</p>
</blockquote>
<p>The improper behavior is often not readily visible. One may need to âzoom-inâ on the upper-right corner to see it. Any fit that predicts worse than chance level performance anywhere on the ROC plot, visible or not, is scientifically indefensible. Much effort has gone into developing models that always predict proper ROC curves, i.e., those that do not cross the chance diagonal. These are called âproperâ ROC curves (some of literature uses the quotes and some does not). There are at least four methods for fitting proper ROC curves, and these are listed in reverse chronological order.</p>
<ul>
<li><p>The most recent (2016) one <span class="citation">(<a href="#ref-chakraborty2011estimating" role="doc-biblioref">DP Chakraborty and Svahn 2011</a>; <a href="#ref-chakraborty2012inverse" role="doc-biblioref">DP Chakraborty, Yoon, and Mello-Thoms 2012</a>)</span> is based on the radiological search model (RSM) and is implemented in the <code>RJafroc</code> package.</p></li>
<li><p>A method <span class="citation">(<a href="#ref-dorfman2000contaminated1" role="doc-biblioref">Dorfman, Berbaum, and Brandser 2000</a>; <a href="#ref-dorfman2000contaminated2" role="doc-biblioref">Dorfman and Berbaum 2000b</a>, <a href="#ref-dorfman2000contaminated3" role="doc-biblioref">2000a</a>)</span> based on the contaminated binormal model (CBM), available as part of DBM-MRMC software from a University of Iowa website and also implemented in the <code>RJafroc</code> package.</p></li>
<li><p>The binormal model-based proper ROC fitting algorithm <span class="citation">(<a href="#ref-metz1999proper" role="doc-biblioref">Charles E. Metz and Pan 1999</a>; <a href="#ref-pan1997proper" role="doc-biblioref">Pan and Metz 1997</a>)</span> developed by Metz and Pan implemented in PROPROC software available as part of DBM-MRMC software.</p></li>
<li><p>The bigamma model <span class="citation">(<a href="#ref-dorfman1997proper" role="doc-biblioref">Dorfman et al. 1997</a>)</span> fitting algorithm for which no software currently exists as far as I am aware.</p></li>
<li><p>LROCFIT, based on the location ROC (LROC) paradigm <span class="citation">(<a href="#ref-swensson1996unified" role="doc-biblioref">Swensson 1996</a>)</span>, which also predicts proper ROC curves, but the data has to be acquired according to the LROC paradigm while all of the other methods described in this chapter work with ROC data (no localization information).</p></li>
</ul>
<p>A related issue is data degeneracy that occurs when a reader fails to provide an interior ROC point. The binormal model does not yield reasonable fits to such data and the researcher has no option but to discard the data or use the empirical AUC.</p>
<blockquote>
<p>To understand how proper ROCs can be generated we need to understand a quantity called the likelihood ratio and the fact that slope of the ROC curve always equals the likelihood ratio, independent of parametric assumptions.</p>
</blockquote>
</div>
<div id="proper-roc-models-likelihood-ratio-theorem1" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> ROC slope equals likelihood ratio<a href="proper-roc-models.html#proper-roc-models-likelihood-ratio-theorem1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>According to the binormal model:</p>
<p><span class="math display" id="eq:proper-roc-models-binormal-model">\[\begin{equation}
\left.\begin{aligned}
\text{FPF}&amp;=\Phi\left( -z \right)\\
\text{TPF}&amp;=\Phi\left( a-bz \right)
\end{aligned}
\right\}
\tag{7.1}
\end{equation}\]</span></p>
<p>The slope <span class="math inline">\(m\left( z|a,b \right)\)</span> of the ROC curve is:</p>
<p><span class="math display" id="eq:proper-roc-models-slope">\[\begin{equation}
\left.\begin{aligned}
m\left( z|a,b \right)&amp;=\frac{\frac{\partial \left( TPF \right)}{\partial z}}{\frac{\partial \left( FPF \right)}{\partial z}}\\
&amp;=\frac{b\phi\left( a-bz \right)}{\phi\left( -z \right)}\\
&amp;=b\exp\left( -\frac{\left( bz-a \right)^2 - z^2}{2} \right)
\end{aligned}\right\}
\tag{7.2}
\end{equation}\]</span></p>
<p>The probability density functions (pdfs) for the binormal model were defined earlier and are reproduced here (N = non-diseased, D = diseased):</p>
<p><span class="math display" id="eq:proper-roc-models-pdfs">\[\begin{equation}
\left.\begin{aligned}
\text{pdf}_N\left( z \right) &amp;= \frac{1}{\sqrt{2\pi}}\exp\left( -\frac{z^2}{2} \right) \\
\text{pdf}_D\left( z \right) &amp;= \frac{b}{\sqrt{2\pi}}\exp\left( -\frac{\left( bz-a \right)^2}{2} \right) \\
\end{aligned}\right\}
\tag{7.3}
\end{equation}\]</span></p>
<p>The likelihood ratio is defined by (the subscript âBINâ is for âbinormal modelâ):</p>
<p><span class="math display" id="eq:proper-roc-models-likelihood-ratio">\[\begin{equation}
\left.\begin{aligned}
l_{\text{BIN}}\left( z | a,b\right) &amp;\equiv \frac{\text{pdf}_D\left( z \right)}{\text{pdf}_N\left( z \right)} \\
&amp;= b\exp\left( -\frac{\left( bz-a \right)^2 -z^2}{2} \right) \\
\end{aligned}\right\}
\tag{7.4}
\end{equation}\]</span></p>
<p>It is seen from Eqn. <a href="proper-roc-models.html#eq:proper-roc-models-slope">(7.2)</a> and Eqn. <a href="proper-roc-models.html#eq:proper-roc-models-likelihood-ratio">(7.4)</a> that the likelihood ratio equals the slope of the ROC curve:</p>
<p><span class="math display" id="eq:proper-roc-models-likelihood-ratio-theorem">\[\begin{equation}
l_{\text{BIN}}\left( z | a,b\right) = m\left( z | a,b\right)
\tag{7.5}
\end{equation}\]</span></p>
<p>While illustrated for the binormal model, this theorem is actually independent of any distributional assumptions <span class="citation">(<a href="#ref-Egan1975" role="doc-biblioref">Egan 1975b</a>)</span>. The reason for the name âlikelihood ratioâ is that early researchers in the field used the term âlikelihood functionâ for what statisticians now term âprobability density functionâ. Hence the ratio of two likelihood functions was termed a âlikelihood ratioâ when in fact it is a ratio of two pdfs.</p>
</div>
<div id="proper-roc-models-likelihood-ratio-theorem2" class="section level2 hasAnchor" number="7.4">
<h2><span class="header-section-number">7.4</span> The likelihood ratio observer maximizes AUC<a href="proper-roc-models.html#proper-roc-models-likelihood-ratio-theorem2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>An observer who maximizes TPF at each FPF for all values <span class="math inline">\(0 \le \text{FPF} \le 1\)</span> is called a Neyman-Pearson observer <span class="citation">(<a href="#ref-neyman1933ix" role="doc-biblioref">Neyman and Pearson 1933</a>)</span>. It can be shown that the Neyman-Pearson observer uses the likelihood ratio as the decision variable <span class="citation">(<a href="#ref-green1966signal" role="doc-biblioref">Green, Swets, et al. 1966</a>)</span>.</p>
<blockquote>
<p>A consequence is that AUC for a likelihood ratio observer represents an upper limit on performance, and such an observer is called an âideal observerâ. Moreover use of the likelihood ratio as the decision variable always yields proper ROC curves.</p>
</blockquote>
<p>These statements call for an explanation.</p>
<div id="explanation" class="section level3 hasAnchor" number="7.4.1">
<h3><span class="header-section-number">7.4.1</span> Explanation<a href="proper-roc-models.html#explanation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>So far the decision rule has been that if the z-sample for a case satisfies <span class="math inline">\(z \ge \zeta\)</span> the case is diagnosed as diseased and otherwise it is diagnosed as non-diseased.</p>
<p>The likelihood ratio involves a deeper concept. It is assumed that the observer knows the pdfs of non-diseased and diseased cases as functions of z. The observer computes the ratio <span class="math inline">\(l(z)\)</span> at the observed z-sample. If <span class="math inline">\(l(z) \ge \lambda\)</span> the case is diagnosed as diseased and otherwise the case is diagnosed as non-diseased. Note the difference:</p>
<ul>
<li><p>Binormal model observer: <span class="math inline">\(z \ge \zeta\)</span></p></li>
<li><p>Likelihood ratio observer: <span class="math inline">\(l(z) \ge \lambda\)</span></p></li>
</ul>
<p>A word on notation: when the decision variable was <span class="math inline">\(z\)</span> I used the corresponding Greek character <span class="math inline">\(\zeta\)</span> to denote a threshold on the z-axis. Since likelihood ratio is denoted <span class="math inline">\(l\)</span>, the corresponding Greek character is <span class="math inline">\(\lambda\)</span>.</p>
<p>The observer has transformed the decision variable <span class="math inline">\(z\)</span> to a new variable <span class="math inline">\(l(z)\)</span> and uses the new variable to make decisions. Varying <span class="math inline">\(\lambda\)</span> allows the observer to generate the <em>likelihood ratio ROC curve</em> which is âproperâ.</p>
<p>If the decision variable <span class="math inline">\(z\)</span> results in improper ROC curves, as does the z-sample in the binormal model, the transformation will not be monotonic <a href="#fn11" class="footnote-ref" id="fnref11"><sup>11</sup></a>. If the transformation were monotonic, that would imply that z was already equivalent to the likelihood ratio.</p>
<p>To summarize these concepts the likelihood ratio observer transforms <span class="math inline">\(z\)</span> to <span class="math inline">\(l(z)\)</span>:</p>
<p><span class="math display" id="eq:proper-roc-models-likelihood-ratio-definition">\[\begin{equation}
l\left( z \right) \equiv  \frac{\text{pdf}_D\left( z \right)}{\text{pdf}_N\left( z \right)}
\tag{7.6}
\end{equation}\]</span></p>
<p>Then the decision variable <span class="math inline">\(M\left( l\left( z \right) \right)\)</span> will yield a proper ROC curve. Here <span class="math inline">\(M\left( \right)\)</span> is an arbitrary monotonic increasing function of its argument, i.e.Â if <span class="math inline">\(x_2 &gt; x_1\)</span>:</p>
<p><span class="math display" id="eq:proper-roc-models-definition-monotonic">\[\begin{equation}
M\left( x_2 \right) \ge M\left( x_1 \right)
\tag{7.7}
\end{equation}\]</span></p>
<p>The transformation allows flat portions.</p>
</div>
</div>
<div id="proper-roc-models-likelihood-ratio-observer" class="section level2 hasAnchor" number="7.5">
<h2><span class="header-section-number">7.5</span> The likelihood ratio observer<a href="proper-roc-models.html#proper-roc-models-likelihood-ratio-observer" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote>
<p>An observer using the likelihood ratio or any monotonic transformation of it as the decision variable is termed a likelihood ratio observer.</p>
</blockquote>
<p>In Fig. <a href="proper-roc-models.html#fig:proper-roc-models-plots-2">7.1</a> plots A-F, all of which apply to <span class="math inline">\(a = 0.7\)</span> and <span class="math inline">\(b = 0.5\)</span>, the ordinate is labeled <span class="math inline">\(\text{lr}\)</span> for likelihood ratio.</p>
<div class="figure"><span style="display:block;" id="fig:proper-roc-models-plots-2"></span>
<img src="07-proper-roc-models_files/figure-html/proper-roc-models-plots-2-1.png" alt="These plots of likelihood ratio $\text{lr}$ of the ROC curves as functions of z for $a = 0.7, b = 0.5$. They correspond to different ranges along the z-axis, starting with a 'birds-eye' view (panel A) and gradually focusing in on the region near the minimum (panel F). " width="672" />
<p class="caption">
FIGURE 7.1: These plots of likelihood ratio <span class="math inline">\(\text{lr}\)</span> of the ROC curves as functions of z for <span class="math inline">\(a = 0.7, b = 0.5\)</span>. They correspond to different ranges along the z-axis, starting with a âbirds-eyeâ view (panel A) and gradually focusing in on the region near the minimum (panel F).
</p>
</div>
<p>Focusing on plot A in Fig. <a href="proper-roc-models.html#fig:proper-roc-models-plots-2">7.1</a> in which range of z is -5 to 8, imagine a sliding threshold <span class="math inline">\(\lambda\)</span> moving down along the ordinate, starting from very high values, <span class="math inline">\(\approx 1.5 \times 10^{11}\)</span>. The decision rule is to diagnose the case as âdiseasedâ if <span class="math inline">\(\text{lr} \ge \lambda\)</span>, and otherwise the case is diagnosed as ânon-diseasedâ. In plot A the likelihood ratio <span class="math inline">\(\text{lr}\)</span> seems, for all practical purposes, to be monotonically related to z, so on the surface it makes no difference which decision rule is used, that based on <span class="math inline">\(\text{lr} \ge \lambda\)</span> or that based on <span class="math inline">\(z \ge \zeta\)</span>. The same conclusion is reached for Plot B, which focuses on the range (-3,5). Plot C showing the range (-3,3) reveals the first hint of something different going on, for now the ordinate <span class="math inline">\(\text{lr}\)</span> is not monotonically related to <span class="math inline">\(z\)</span> since the <span class="math inline">\(\text{lr}\)</span> function has a minimum. For <span class="math inline">\(\text{lr} &gt; \approx 1\)</span> there are two values of <span class="math inline">\(\zeta\)</span> corresponding to a each value of <span class="math inline">\(\lambda\)</span>. This behavior is amplified in the remaining plots, as one âhomes-inâ on the minimum. Taking the clearest example, plot F, for <span class="math inline">\(\lambda = 0.37\)</span> the two values are (-0.728, 0.206). These are denoted by <span class="math inline">\(\zeta_L=-0.728\)</span> and <span class="math inline">\(\zeta_U=0.206\)</span>. The likelihood ratio observer using threshold <span class="math inline">\(\lambda=0.37\)</span> declares all cases with <span class="math inline">\(\text{lr} \ge 0.37\)</span> as diseased, and non-diseased otherwise. The corresponding z-sample binormal model observer must declare cases with <span class="math inline">\(z \ge \zeta_U\)</span> <strong>and</strong> cases with <span class="math inline">\(z &lt; \zeta_L\)</span> as diseased, and non-diseased otherwise. The z-sample rule is more complicated and non-intuitive: why should cases with very low z-samples be declared diseased? The reason is that according to the z-sample based model assumed by the observer <strong>both</strong> very high and very low values of z are consistent with the case being diseased.</p>
<blockquote>
<p>Since likelihood ratio decreases as one moves down the y-axis in Fig. <a href="proper-roc-models.html#fig:proper-roc-models-plots-2">7.1</a>) the slope of the likelihood ratio generated ROC curve decreases monotonically as the operating point moves up the curve. Since likelihood ratio is the ratio of two probabilities, it - and consequently the slope of the ROC - is always non-negative. This rules out chance line crossings and âhooksâ. The likelihood ratio observer always generates a proper ROC curve.</p>
</blockquote>
<p>Recall that the observer needs to know the two pdfs and compute a ratio based on the observed z-sample. Since the pdfs defined above were specific to the binormal model the likelihood ratio observer described above is, more carefully stated, a <em>binormal-model-based likelihood ratio observer</em>.</p>
<blockquote>
<p>It can be shown that the likelihood ratio observer achieves the highest ROC curve (in the Neyman-Pearson sense) and consequently the highest AUC when compared to observers using other decision rules. In this sense the likelihood ratio observer is an <strong>ideal observer</strong>.</p>
</blockquote>
<p>The observer can use a decision rule that is based on any monotonic increasing transformation of the likelihood ratio and the resulting ROC curve will be identical to that based on the likelihood ratio; the slope of the resulting curve always equals the likelihood ratio (i.e., before the monotonic transformation). For example, the monotonic transformation could yield a variable ranging from -infinity to plus infinity but the slope of the resulting ROC curve will still be that for the likelihood ratio observer prior to the transformation.</p>
<p>Since AUC of the likelihood ratio observer is optimal with respect to other observers using different decision rules or different underlying models of the decision variable, <strong>the AUC achieved by the likelihood ratio observer is unique regardless of the model used to fit the proper ROC curve.</strong> The shapes of the predicted proper ROC curves could be model dependent and differ from each other but the AUCs will all be the same. This is demonstrated in book Chapter TBA 18 for RSM, PROPROC and CBM models fitted to a large number of datasets.</p>
</div>
<div id="proper-roc-models-proproc" class="section level2 hasAnchor" number="7.6">
<h2><span class="header-section-number">7.6</span> PROPROC<a href="proper-roc-models.html#proper-roc-models-proproc" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>An algorithm <span class="citation">(<a href="#ref-metz1999proper" role="doc-biblioref">Charles E. Metz and Pan 1999</a>)</span>, based on the observer using the binormal model likelihood ratio, has been implemented. The software is called PROPROC, for proper ROC. <a href="#fn12" class="footnote-ref" id="fnref12"><sup>12</sup></a></p>
<div id="proper-roc-models-proproc-formulae" class="section level3 hasAnchor" number="7.6.1">
<h3><span class="header-section-number">7.6.1</span> PROPROC formulae<a href="proper-roc-models.html#proper-roc-models-proproc-formulae" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The method uses two parameters <span class="math inline">\(c,d_a\)</span> defined as follows:</p>
<p><span class="math display" id="eq:proper-roc-models-proproc-parameters">\[\begin{equation}
\left.\begin{aligned}
c &amp;= \frac{b-1}{b+1} \\
d_a &amp;= \frac{\sqrt{2}a}{1+b^2} \\
\end{aligned}\right\}
\tag{7.8}
\end{equation}\]</span></p>
<p>Allowed values of the parameters are as follows:</p>
<p><span class="math display" id="eq:proper-roc-models-proproc-parameter-ranges">\[\begin{equation}
\left.\begin{aligned}
&amp; -1 &lt; c &lt; 1 \\
&amp; 0 &lt; d_a &lt; \infty \\
\end{aligned}\right\}
\tag{7.9}
\end{equation}\]</span></p>
<p>Eqn. <a href="proper-roc-models.html#eq:proper-roc-models-proproc-parameters">(7.8)</a> can be solved for the <span class="math inline">\(a,b\)</span> parameters as functions of the <span class="math inline">\(c.d_a\)</span> parameters:</p>
<p><span class="math display" id="eq:proper-roc-models-proproc-parameters-transform">\[\begin{equation}
\left.\begin{aligned}
a &amp;= \frac{d_a}{\sqrt{2}}\sqrt{1+{{\left( \frac{c+1}{c-1} \right)^2}}} \\
b &amp;= -\frac{c+1}{c-1} \\
\end{aligned}\right\}
\tag{7.10}
\end{equation}\]</span></p>
<p>Since <span class="math inline">\(b &lt; 1\)</span> with most clinical datasets, one expects to find <span class="math inline">\(c &lt; 0\)</span>. The proper ROC curve is defined by <span class="citation">(<a href="#ref-metz1999proper" role="doc-biblioref">Charles E. Metz and Pan 1999</a>)</span> (the threshold variable <span class="math inline">\(v\)</span>, which is the PROPROC analog of <span class="math inline">\(\zeta\)</span>, is defined below):</p>
<p><span class="math display" id="eq:proper-roc-models-v-range">\[\begin{equation}
\left.\begin{aligned}
FPF\left( v \right) &amp;= \Phi\left( -\left( 1-c \right)v -\frac{d_a}{2}\sqrt{1+c^2}  \right) \\
&amp;+\Phi\left( -\left( 1-c \right)v +\frac{d_a}{2c}\sqrt{1+c^2} \right)  -H(c) \\
TPF\left( v \right) &amp;= \Phi\left( -\left( 1+c \right)v +\frac{d_a}{2}\sqrt{1+c^2}  \right)  \\ &amp;+\Phi\left( -\left( 1+c \right)v +\frac{d_a}{2c}\sqrt{1+c^2} \right)  -H(c) \\
\end{aligned}\right\}
\tag{7.11}
\end{equation}\]</span></p>
<p>The (Heaviside) step function <span class="math inline">\(H(x)\)</span> is defined by:</p>
<p><span class="math display" id="eq:proper-roc-models-heaviside">\[\begin{equation}
\left.\begin{aligned}
H\left( x &lt; 0 \right) &amp;= 0 \\
H\left( x &gt; 0 \right) &amp;= 1 \\
\end{aligned}\right\}
\tag{7.12}
\end{equation}\]</span></p>
<p>The function is discontinuous, but its value at <span class="math inline">\(x = 0\)</span> is irrelevant because <span class="math inline">\(c = 0\)</span> implies <span class="math inline">\(b = 1\)</span>, in which case the equal variance binormal model applies, which predicts proper ROCs.</p>
<p>Depending on the value of <span class="math inline">\(c\)</span> the threshold variable <span class="math inline">\(v\)</span> in Eqn. <a href="proper-roc-models.html#eq:proper-roc-models-v-range">(7.11)</a> has different ranges:</p>
<p><span class="math display" id="eq:proper-roc-models-limits-v">\[\begin{equation}
\left.\begin{aligned}
\begin{matrix}
\frac{d_a}{4c}\sqrt{1+c^2} \le v \le \infty &amp; \text{if} &amp; c&lt;0
\end{matrix}\\
\begin{matrix}
-\infty \le v \le \infty &amp; \text{if} &amp; c=0
\end{matrix}\\
\begin{matrix}
-\infty \le v \le\frac{d_a}{4c}\sqrt{1+c^2} \le v &amp; \text{if} &amp; c&lt;0
\end{matrix}\\
\\
\end{aligned}\right\}
\tag{7.13}
\end{equation}\]</span></p>
<p>PROPROC software implements a maximum likelihood method to estimate the <span class="math inline">\(c, d_a\)</span> parameters from ratings data. The 1999 publication <span class="citation">(<a href="#ref-metz1999proper" role="doc-biblioref">Charles E. Metz and Pan 1999</a>)</span> states, without proof, that the area under the proper ROC is give by:</p>
<p><span class="math display" id="eq:proper-roc-models-metz-36">\[\begin{equation}
A_{\text{prop}}=\Phi\left( \frac{d_a}{\sqrt{2}} \right) + 2F\left\{-\frac{d_a}{\sqrt{2}},0;-\frac{1-c^2}{1+c^2}  \right\}
\tag{7.14}
\end{equation}\]</span></p>
<p>Here <span class="math inline">\(F(X,Y;\rho)\)</span> is the bivariate standard-normal (i.e., zero means and unit variances) cumulative distribution function (CDF) with correlation coefficient <span class="math inline">\(\rho\)</span>. In the notation of book Chapter 21:</p>
<p><span class="math display" id="eq:proper-roc-models-def-bivariate-cdf">\[\begin{equation}
F\left( X,Y;\rho \right)=\int_{x=-\infty}^{X}
\int_{y=-\infty}^{Y}
dx dy ~ ~  f\left(
\left( \begin{matrix}
x \\
y
\end{matrix}
\right) \bigg\rvert
\left( \begin{matrix}
0 \\
0
\end{matrix}  \right),
\left( \begin{matrix}
1 &amp; \rho \\
\rho &amp; 1
\end{matrix} \right)
\right)
\tag{7.15}
\end{equation}\]</span></p>
<p>Here <span class="math inline">\(f\)</span> is the pdf of a standard-normal bivariate distribution with correlation <span class="math inline">\(\rho\)</span>, i.e., the mean is the zero column vector of length 2 and the 2 x 2 covariance matrix has ones along the diagonal and <span class="math inline">\(\rho\)</span> along the off-diagonal.</p>
<p>The first term in Eqn. <a href="proper-roc-models.html#eq:proper-roc-models-metz-36">(7.14)</a> is equal to the area under the binormal model ROC curve Eqn. <a href="binormal-model.html#eq:binormal-model-ab-2az">(6.19)</a>. Therefore,</p>
<p><span class="math display" id="eq:proper-roc-models-area-proproc2">\[\begin{equation}
A_{\text{prop}}=A_z+2F\left( -\frac{d_a}{\sqrt{2}},0;-\frac{1-c^2}{1+c^2} \right)
\tag{7.16}
\end{equation}\]</span></p>
<p>Since F (a CDF, which is a probability) is non-negative,</p>
<p><span class="math display" id="eq:proper-roc-models-area-proproc-az-inequality">\[\begin{equation}
A_{\text{prop}}\ge A_z
\tag{7.17}
\end{equation}\]</span></p>
<p>This reinforces the result stated earlier.</p>
</div>
<div id="proper-roc-models-proproc-code" class="section level3 hasAnchor" number="7.6.2">
<h3><span class="header-section-number">7.6.2</span> PROPROC code implementation<a href="proper-roc-models.html#proper-roc-models-proproc-code" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here is the code to generate PROPROC ROC curve and slope plots.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb22-1"><a href="proper-roc-models.html#cb22-1"></a></span>
<span id="cb22-2"><a href="proper-roc-models.html#cb22-2"></a>c1Arr <span class="ot">&lt;-</span>   <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1322804</span>, <span class="fl">0.2225588</span>)</span>
<span id="cb22-3"><a href="proper-roc-models.html#cb22-3"></a>daArr  <span class="ot">&lt;-</span>  <span class="fu">c</span>(<span class="fl">1.197239</span>,<span class="fl">1.740157</span>)</span>
<span id="cb22-4"><a href="proper-roc-models.html#cb22-4"></a>plotRoc <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb22-5"><a href="proper-roc-models.html#cb22-5"></a>plotSlope <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb22-6"><a href="proper-roc-models.html#cb22-6"></a></span>
<span id="cb22-7"><a href="proper-roc-models.html#cb22-7"></a>npts <span class="ot">&lt;-</span>  <span class="dv">10000</span></span>
<span id="cb22-8"><a href="proper-roc-models.html#cb22-8"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span>
<span id="cb22-9"><a href="proper-roc-models.html#cb22-9"></a>{</span>
<span id="cb22-10"><a href="proper-roc-models.html#cb22-10"></a>  <span class="co"># initialize proproc c and d_a parameters</span></span>
<span id="cb22-11"><a href="proper-roc-models.html#cb22-11"></a>  <span class="co"># cant use c, as it is an operator in R</span></span>
<span id="cb22-12"><a href="proper-roc-models.html#cb22-12"></a>  c1 <span class="ot">&lt;-</span> c1Arr[i]</span>
<span id="cb22-13"><a href="proper-roc-models.html#cb22-13"></a>  d_a <span class="ot">&lt;-</span> daArr[i]</span>
<span id="cb22-14"><a href="proper-roc-models.html#cb22-14"></a>  </span>
<span id="cb22-15"><a href="proper-roc-models.html#cb22-15"></a>  ret <span class="ot">&lt;-</span> <span class="fu">GetLimits</span>(d_a,c1)</span>
<span id="cb22-16"><a href="proper-roc-models.html#cb22-16"></a>  LL <span class="ot">&lt;-</span> ret<span class="sc">$</span>LL</span>
<span id="cb22-17"><a href="proper-roc-models.html#cb22-17"></a>  UL <span class="ot">&lt;-</span> ret<span class="sc">$</span>UL</span>
<span id="cb22-18"><a href="proper-roc-models.html#cb22-18"></a>  </span>
<span id="cb22-19"><a href="proper-roc-models.html#cb22-19"></a>  lambda  <span class="ot">&lt;-</span>  <span class="fu">seq</span> (LL, UL, <span class="at">length.out =</span> npts)</span>
<span id="cb22-20"><a href="proper-roc-models.html#cb22-20"></a>  TPF  <span class="ot">&lt;-</span>  <span class="fu">TruePositiveFraction</span> (lambda, d_a, c1)</span>
<span id="cb22-21"><a href="proper-roc-models.html#cb22-21"></a>  FPF <span class="ot">&lt;-</span> <span class="fu">FalsePositiveFraction</span> (lambda, d_a, c1)</span>
<span id="cb22-22"><a href="proper-roc-models.html#cb22-22"></a>  FPF <span class="ot">&lt;-</span> <span class="fu">rev</span>(FPF);TPF <span class="ot">&lt;-</span> <span class="fu">rev</span>(TPF)</span>
<span id="cb22-23"><a href="proper-roc-models.html#cb22-23"></a>  df2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">FPF =</span> FPF, <span class="at">TPF =</span> TPF)</span>
<span id="cb22-24"><a href="proper-roc-models.html#cb22-24"></a>  plotRoc[[i]] <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df2, <span class="fu">aes</span>(<span class="at">x =</span> FPF, <span class="at">y =</span> TPF)) <span class="sc">+</span> </span>
<span id="cb22-25"><a href="proper-roc-models.html#cb22-25"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb22-26"><a href="proper-roc-models.html#cb22-26"></a>    <span class="fu">ggtitle</span>(<span class="fu">paste0</span>(<span class="st">&quot;Plot &quot;</span>, </span>
<span id="cb22-27"><a href="proper-roc-models.html#cb22-27"></a>                   LETTERS[i], </span>
<span id="cb22-28"><a href="proper-roc-models.html#cb22-28"></a>                   <span class="st">&quot;:&quot;</span>, </span>
<span id="cb22-29"><a href="proper-roc-models.html#cb22-29"></a>                   <span class="fu">sprintf</span>(<span class="st">&quot; c = %5.3f, d_a = %5.3f&quot;</span>, </span>
<span id="cb22-30"><a href="proper-roc-models.html#cb22-30"></a>                           c1, d_a)))</span>
<span id="cb22-31"><a href="proper-roc-models.html#cb22-31"></a>  </span>
<span id="cb22-32"><a href="proper-roc-models.html#cb22-32"></a>  <span class="co"># Implement Eqn. 36 from Metz-Pan paper </span></span>
<span id="cb22-33"><a href="proper-roc-models.html#cb22-33"></a>  rho <span class="ot">&lt;-</span> <span class="sc">-</span>(<span class="dv">1</span><span class="sc">-</span>c1<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>c1<span class="sc">^</span><span class="dv">2</span>);sigma <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">1</span>, rho), <span class="fu">c</span>(rho, <span class="dv">1</span>))</span>
<span id="cb22-34"><a href="proper-roc-models.html#cb22-34"></a>  lower <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="sc">-</span><span class="cn">Inf</span>,<span class="dv">2</span>);upper <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span>d_a<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span>),<span class="dv">0</span>)</span>
<span id="cb22-35"><a href="proper-roc-models.html#cb22-35"></a>  A_prop <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(d_a<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span>)) <span class="sc">+</span> </span>
<span id="cb22-36"><a href="proper-roc-models.html#cb22-36"></a>    <span class="dv">2</span> <span class="sc">*</span> <span class="fu">pmvnorm</span>(lower, upper, <span class="at">sigma =</span> sigma)</span>
<span id="cb22-37"><a href="proper-roc-models.html#cb22-37"></a>  A_prop <span class="ot">&lt;-</span>  <span class="fu">as.numeric</span>(A_prop)</span>
<span id="cb22-38"><a href="proper-roc-models.html#cb22-38"></a>  </span>
<span id="cb22-39"><a href="proper-roc-models.html#cb22-39"></a>  <span class="co"># may need to adjust limits to view detail of slope plot</span></span>
<span id="cb22-40"><a href="proper-roc-models.html#cb22-40"></a>  ret <span class="ot">&lt;-</span> <span class="fu">Transform2ab</span>(d_a, c1)</span>
<span id="cb22-41"><a href="proper-roc-models.html#cb22-41"></a>  a <span class="ot">&lt;-</span> ret<span class="sc">$</span>a;b <span class="ot">&lt;-</span> ret<span class="sc">$</span>b</span>
<span id="cb22-42"><a href="proper-roc-models.html#cb22-42"></a>  <span class="cf">if</span> (i <span class="sc">==</span> <span class="dv">1</span>) z <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">0</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb22-43"><a href="proper-roc-models.html#cb22-43"></a>  <span class="cf">if</span> (i <span class="sc">==</span> <span class="dv">2</span>) z <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">5</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb22-44"><a href="proper-roc-models.html#cb22-44"></a>  slope <span class="ot">&lt;-</span>b<span class="sc">*</span><span class="fu">dnorm</span>(a<span class="sc">-</span>b<span class="sc">*</span>z)<span class="sc">/</span><span class="fu">dnorm</span>(<span class="sc">-</span>z)</span>
<span id="cb22-45"><a href="proper-roc-models.html#cb22-45"></a>  </span>
<span id="cb22-46"><a href="proper-roc-models.html#cb22-46"></a>  slopePlot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">z =</span> z, <span class="at">slope =</span> slope)</span>
<span id="cb22-47"><a href="proper-roc-models.html#cb22-47"></a>  plotSlope[[i]] <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb22-48"><a href="proper-roc-models.html#cb22-48"></a>    slopePlot, <span class="fu">aes</span>(<span class="at">x =</span> z, <span class="at">y =</span> slope)) <span class="sc">+</span> </span>
<span id="cb22-49"><a href="proper-roc-models.html#cb22-49"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb22-50"><a href="proper-roc-models.html#cb22-50"></a>    <span class="fu">ggtitle</span>(<span class="fu">paste0</span>(<span class="st">&quot;Plot &quot;</span>, </span>
<span id="cb22-51"><a href="proper-roc-models.html#cb22-51"></a>                   LETTERS[i<span class="sc">+</span><span class="dv">2</span>], </span>
<span id="cb22-52"><a href="proper-roc-models.html#cb22-52"></a>                   <span class="st">&quot;:&quot;</span>, </span>
<span id="cb22-53"><a href="proper-roc-models.html#cb22-53"></a>                   <span class="fu">sprintf</span>(<span class="st">&quot; c = %5.3f, d_a = %5.3f&quot;</span>, </span>
<span id="cb22-54"><a href="proper-roc-models.html#cb22-54"></a>                           c1, d_a)))</span>
<span id="cb22-55"><a href="proper-roc-models.html#cb22-55"></a>}</span></code></pre></div>
<p>The analytic expressions for PROPROC ROC curves are implemented in the preceding code which plots PROPROC ROC curves predicted by the model parameters <span class="math inline">\((c,d_a)\)</span> and also plots the slopes as a function of binormal model decision variable <span class="math inline">\(z\)</span>.</p>
<p>The dataset <span class="citation">(<a href="#ref-andersson2008breast" role="doc-biblioref">Andersson et al. 2008</a>)</span> is from an FROC study in breast tomosynthesis. Highest rating ROC data were analyzed by PROPROC and the resulting parameter values were used. The radiologists were chosen as they demonstrate significant differences in the shapes of their respective proper ROC curves and slope plots.</p>
<p>In Fig. <a href="proper-roc-models.html#fig:proper-roc-models-plots-3">7.2</a> plot A is the ROC for <span class="math inline">\(c = -0.132, d_a = 1.197\)</span> while plot B is the ROC for <span class="math inline">\(c = 0.226, d_a = 1.74\)</span>. Plots C and D are the corresponding slope plots.</p>
<p>Code explanation: at lines 12-13 the <span class="math inline">\(c\)</span> and <span class="math inline">\(d_a\)</span> parameters are initialized. Lines 15-17 initializes the upper and lower limits of the v-variable defined in Eqn. <a href="proper-roc-models.html#eq:proper-roc-models-v-range">(7.11)</a>, equivalent to <span class="math inline">\(\lambda\)</span> in our notation. Line 19 defines an array of 10,000 <span class="math inline">\(\lambda\)</span> values at which to evaluate the model and generate the ROC curve. Lines 20-22 calculate the ordinate and abscissa arrays for the predicted ROC curve. Lines 23-30 saves the plots to list arrays for subsequent plotting. Lines 22-27 computes the PROPROC predicted AUC <span class="math inline">\(A_{\text{prop}}\)</span> using Eqn. <a href="proper-roc-models.html#eq:proper-roc-models-metz-36">(7.14)</a>, i.e., Metzâs magic equation. Lines 29-34 computes the slope arrays using the binormal model and Eqn. <a href="proper-roc-models.html#eq:proper-roc-models-likelihood-ratio-definition">(7.6)</a>. The rest of the code generates the slope plot arrays.</p>
<div class="figure"><span style="display:block;" id="fig:proper-roc-models-plots-3"></span>
<img src="07-proper-roc-models_files/figure-html/proper-roc-models-plots-3-1.png" alt="The plots are labeled by the values of $c$ and $d_a$. Plots A and B are proper ROC plots while plots C and D are the corresponding slope plots. In plot A the slope is infinite near the origin finite at the upper-right corner. In plot B the slope is finite near the origin and zero at the upper-right corner." width="672" />
<p class="caption">
FIGURE 7.2: The plots are labeled by the values of <span class="math inline">\(c\)</span> and <span class="math inline">\(d_a\)</span>. Plots A and B are proper ROC plots while plots C and D are the corresponding slope plots. In plot A the slope is infinite near the origin finite at the upper-right corner. In plot B the slope is finite near the origin and zero at the upper-right corner.
</p>
</div>
<p>Plot A is for a negative value of <span class="math inline">\(c\)</span> which implies <span class="math inline">\(b &lt; 1\)</span>. The slope of the proper ROC is infinite near the origin, corresponding to the very large values of slope in plot C at large likelihood ratio threshold <span class="math inline">\(\lambda\)</span>), and the slope approaches a non-zero value near the upper right corner of the ROC, corresponding to the non-zero minimum slope in plot C approached as one lowers the likelihood threshold <span class="math inline">\(\lambda\)</span>).</p>
<p>Plot B is for a positive value of <span class="math inline">\(c\)</span> which implies <span class="math inline">\(b &gt; 1\)</span>. This time the slope of the ROC near the origin is large but finite, corresponding to the peak in plot D at intermediate likelihood threshold <span class="math inline">\(\lambda\)</span>, and the slope approaches zero near the upper right corner, corresponding to the zero minimum slope in Plot D approached as one lowers the likelihood threshold <span class="math inline">\(\lambda\)</span> to zero.</p>
<p>To better understand the relation between the ROC plots and the slope plots one moves up the ROC curve by âslicingâ the slope axis in plots C and D with a downward sliding horizontal cut, i.e., the threshold <span class="math inline">\(\lambda\)</span> is being lowered starting with a high value. In plot A the slope of the ROC curve starts at the origin with an infinite value corresponding to large slope at the top-right corner in plot C. In plot B the slope of the ROC curve starts at the origin with a finite value corresponding to the finite peak in plot D. Above the peak, there are no solutions for <span class="math inline">\(z\)</span>. The slope decreases monotonically to zero corresponding to the flattening out of the slope at zero for <span class="math inline">\(z \approx 2\)</span>.</p>
<p>Alternatively, one can think of horizontally shrinking each of plots C and D to zero width, and all that remains is the slope axis with a thick vertical line superimposed on it corresponding to the horizontally collapsed curve. In plot C this vertical line extends from positive infinity down to about 0.1 and represents the range of decision variable samples encountered by the observer using the likelihood ratio scale. In plot D this vertical line extends from <span class="math inline">\(\approx 9.4\)</span> to zero. Values outside of these ranges are not possible for the given parameter values of the underlying binormal model.</p>
<p>The two values of z that can occur for each value of <span class="math inline">\(\lambda\)</span> implies that the binormal model based proper ROC algorithm has to do a lot of bookkeeping.</p>
</div>
</div>
<div id="proper-roc-models-cbm" class="section level2 hasAnchor" number="7.7">
<h2><span class="header-section-number">7.7</span> The contaminated binormal model (CBM)<a href="proper-roc-models.html#proper-roc-models-cbm" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The contaminated binormal model <span class="citation">(<a href="#ref-dorfman2000contaminated1" role="doc-biblioref">Dorfman, Berbaum, and Brandser 2000</a>; <a href="#ref-dorfman2000contaminated2" role="doc-biblioref">Dorfman and Berbaum 2000b</a>, <a href="#ref-dorfman2000contaminated3" role="doc-biblioref">2000a</a>)</span>, or CBM, is an alternate model for decision variable sampling in an ROC study. Like the binormal model, it is a two-parameter model, excluding cutoffs. The first parameter is <span class="math inline">\(\mu_\text{CBM}\)</span>, the separation of two unit-variance normal distributions. The sampling for non-diseased cases is from the <span class="math inline">\(N(0,1)\)</span> distribution, while sampling for diseased cases is from the <span class="math inline">\(N(\mu_\text{CBM},1)\)</span> distribution, provided the disease is visible, otherwise it is from the <span class="math inline">\(N(0,1)\)</span> distribution. In other words, for diseased cases the sampling is from a mixture distribution of two unit variance normal distributions, one centered at <span class="math inline">\(\mu\)</span> and the other centered at 0, with mixing fraction <span class="math inline">\(\alpha\)</span>, the fraction of diseased cases where the abnormality is actually visible. The binning is accomplished, as usual, by the cutoff vector <span class="math inline">\(\overrightarrow{\zeta}=\left( \zeta_1,...,\zeta_{\text{ROC}-1} \right)\)</span>, where <span class="math inline">\(R_\text{ROC}\)</span> is the number of ROC bins. Defining dummy cutoffs <span class="math inline">\(\zeta_0=-\infty\)</span> and <span class="math inline">\(\zeta_{\text{ROC}}=\infty\)</span>, the binning rule is as before:</p>
<p><span class="math display">\[\begin{equation}
\begin{matrix}
\text{if} &amp; \zeta_{r-1} \le z &lt; \zeta_r &amp; \text{rating} = r
\end{matrix}
\end{equation}\]</span></p>
<p>Therefore, CBM is characterized by the parameters <span class="math inline">\(\mu, \alpha, \zeta_r\)</span> where <span class="math inline">\(r=1,2,...,R_{\text{ROC}-1}\)</span>. The parameters <span class="math inline">\(\mu, \alpha\)</span> can be used to predict the ROC curve and the area under the curve.</p>
<div id="proper-roc-models-cbm-formulae" class="section level3 hasAnchor" number="7.7.1">
<h3><span class="header-section-number">7.7.1</span> CBM formulae<a href="proper-roc-models.html#proper-roc-models-cbm-formulae" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For non-diseased cases, the <span class="math inline">\(\text{pdf}\)</span> is the same as for the binormal model:</p>
<p><span class="math display" id="eq:proper-roc-models-cbm-pdfn">\[\begin{equation}
\text{pdf}_N=\phi(z)
\tag{7.18}
\end{equation}\]</span></p>
<p>For diseased cases the <span class="math inline">\(\text{pdf}\)</span> is a mixture of two unit variance distributions, one centered at zero and the other at <span class="math inline">\(\mu_\text{CBM}\)</span>, with mixing fractions <span class="math inline">\((1-\alpha)\)</span> and <span class="math inline">\(\alpha\)</span>, respectively:</p>
<p><span class="math display" id="eq:proper-roc-models-cbm-pdfd">\[\begin{equation}
\text{pdf}_D=\left( 1-\alpha \right)\phi(z) + \alpha \phi(z-\mu_\text{CBM})
\tag{7.19}
\end{equation}\]</span></p>
<p>The likelihood ratio for the CBM model is given by the ratio of the two pdfs:</p>
<p><span class="math display" id="eq:proper-roc-models-cbm-likelihood">\[\begin{equation}
\left.\begin{aligned}
l_\text{CBM}\left( z|a,b \right)&amp;=\frac{\left( 1-\alpha \right)\phi(z) + \alpha \phi(z-\mu_\text{CBM})}{\phi(z)}\\
&amp;=\left( 1-\alpha \right)+\alpha \, \exp\left(-\frac{\mu_\text{CBM}^2}{2}+z\,\mu_\text{CBM}  \right)
\end{aligned}\right\}
\tag{7.20}
\end{equation}\]</span></p>
<p>The function increases monotonically as <span class="math inline">\(z\)</span> increases proving that the predicted ROC curve is proper, i.e., its slope decreases monotonically as the operating point moves up the curve (causing both <span class="math inline">\(z\)</span> and the likelihood ratio to decrease). The slope at the origin (infinite <span class="math inline">\(z\)</span>) is infinite and the slope at the upper-right corner is <span class="math inline">\((1-\alpha)\)</span>. The predicted ROC coordinates are:</p>
<p><span class="math display" id="eq:proper-roc-models-cbm-fpf-tpf">\[\begin{equation}
\left.\begin{aligned}
\text{FPF}\left( \zeta \right) &amp;= \Phi\left( -\zeta \right)\\
\text{TPF}\left( \zeta \right) &amp;= \left( 1-\alpha \right)\Phi\left( -\zeta \right)+\alpha \,\Phi\left( \mu_\text{CBM}-\zeta \right)
\end{aligned}\right\}
\tag{7.21}
\end{equation}\]</span></p>
<p>Since on non-diseased cases the sampling behaviors are identical, the expression for <span class="math inline">\(\text{FPF}\left( \zeta \right)\)</span> is identical to that for the binormal model: the probability that the z-sample for a non-diseased case exceeds <span class="math inline">\(\zeta\)</span> is <span class="math inline">\(\Phi\left( -\zeta \right)\)</span>. The second Eqn. <a href="proper-roc-models.html#eq:proper-roc-models-cbm-fpf-tpf">(7.21)</a> can be understood as follows. <span class="math inline">\(\text{TPF}\left( \zeta \right)\)</span> is the probability that a diseased case z-sample exceeds <span class="math inline">\(\zeta\)</span>. There are two possibilities: the z-sample arose from the zero-centered distribution, which occurs with probability <span class="math inline">\(\left( 1-\alpha \right)\)</span>, or it arose from the <span class="math inline">\(\mu_\text{CBM}\)</span>-centered distribution, which occurs with probability <span class="math inline">\(\alpha\)</span>. In the former case, the probability that the z-sample exceeds <span class="math inline">\(\zeta\)</span> is <span class="math inline">\(\Phi\left( -\zeta \right)\)</span>. In the latter case, the probability is <span class="math inline">\(\Phi\left( \mu_\text{CBM}-\zeta \right)\)</span>. The net probability is the weighted sum of these component probabilities in proportion to their relative frequencies <span class="math inline">\(\left( 1-\alpha \right):\alpha\)</span>. A similar logic can be used to derive the AUC under the CBM fitted ROC curve:</p>
<p><span class="math display" id="eq:proper-roc-models-cbm-auc">\[\begin{equation}
\text{AUC}_\text{CBM}=0.5\left( 1-\alpha \right)+\alpha \,\Phi\left( \frac {\mu_\text{CBM}}{\sqrt{2}} \right)
\tag{7.22}
\end{equation}\]</span></p>
<p>In the limit <span class="math inline">\(\mu_\text{CBM} \rightarrow \infty\)</span>, <span class="math inline">\(\text{AUC}_\text{CBM} \rightarrow 0.5\left( 1+\alpha \right)\)</span> and in the limit <span class="math inline">\(\mu_\text{CBM} \rightarrow 0\)</span>, <span class="math inline">\(\text{AUC}_\text{CBM} \rightarrow 0.5\)</span>.</p>
</div>
<div id="proper-roc-models-cbm-code" class="section level3 hasAnchor" number="7.7.2">
<h3><span class="header-section-number">7.7.2</span> CBM code implementation<a href="proper-roc-models.html#proper-roc-models-cbm-code" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The following computes the y-coordinate of the ROC predicted by the CBM:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="proper-roc-models.html#cb23-1" aria-hidden="true" tabindex="-1"></a>CbmRocY <span class="ot">&lt;-</span> <span class="cf">function</span> (x, mu, alpha) {</span>
<span id="cb23-2"><a href="proper-roc-models.html#cb23-2" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span>alpha)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">pnorm</span>(<span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>x))) <span class="sc">+</span> </span>
<span id="cb23-3"><a href="proper-roc-models.html#cb23-3" aria-hidden="true" tabindex="-1"></a>    alpha<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">pnorm</span>(<span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>x)<span class="sc">-</span>mu))</span>
<span id="cb23-4"><a href="proper-roc-models.html#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(y)</span>
<span id="cb23-5"><a href="proper-roc-models.html#cb23-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The plotting code follows:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="proper-roc-models.html#cb24-1" aria-hidden="true" tabindex="-1"></a>FPF <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.0</span>, <span class="dv">1</span>, <span class="fl">0.001</span>)</span>
<span id="cb24-2"><a href="proper-roc-models.html#cb24-2" aria-hidden="true" tabindex="-1"></a>alphaArr <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.8</span>)</span>
<span id="cb24-3"><a href="proper-roc-models.html#cb24-3" aria-hidden="true" tabindex="-1"></a>muArr <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)</span>
<span id="cb24-4"><a href="proper-roc-models.html#cb24-4" aria-hidden="true" tabindex="-1"></a>plotRoc <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb24-5"><a href="proper-roc-models.html#cb24-5" aria-hidden="true" tabindex="-1"></a>myLabelIndx <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb24-6"><a href="proper-roc-models.html#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span>
<span id="cb24-7"><a href="proper-roc-models.html#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>) </span>
<span id="cb24-8"><a href="proper-roc-models.html#cb24-8" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb24-9"><a href="proper-roc-models.html#cb24-9" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb24-10"><a href="proper-roc-models.html#cb24-10" aria-hidden="true" tabindex="-1"></a>      alpha <span class="ot">&lt;-</span> alphaArr[i]</span>
<span id="cb24-11"><a href="proper-roc-models.html#cb24-11" aria-hidden="true" tabindex="-1"></a>      mu <span class="ot">&lt;-</span> muArr[j]</span>
<span id="cb24-12"><a href="proper-roc-models.html#cb24-12" aria-hidden="true" tabindex="-1"></a>      TPF <span class="ot">&lt;-</span> <span class="fu">CbmRocY</span>(FPF, mu, alpha)</span>
<span id="cb24-13"><a href="proper-roc-models.html#cb24-13" aria-hidden="true" tabindex="-1"></a>      rocPlot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">FPF =</span> FPF, <span class="at">TPF =</span> TPF)</span>
<span id="cb24-14"><a href="proper-roc-models.html#cb24-14" aria-hidden="true" tabindex="-1"></a>      plotRoc[[myLabelIndx]] <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb24-15"><a href="proper-roc-models.html#cb24-15" aria-hidden="true" tabindex="-1"></a>        rocPlot, <span class="fu">aes</span>(<span class="at">x =</span> FPF, <span class="at">y =</span> TPF)) <span class="sc">+</span> </span>
<span id="cb24-16"><a href="proper-roc-models.html#cb24-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_line</span>(<span class="at">data =</span> rocPlot) <span class="sc">+</span> </span>
<span id="cb24-17"><a href="proper-roc-models.html#cb24-17" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span> </span>
<span id="cb24-18"><a href="proper-roc-models.html#cb24-18" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb24-19"><a href="proper-roc-models.html#cb24-19" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggtitle</span>(<span class="fu">paste0</span>(<span class="st">&quot;Plot &quot;</span>, </span>
<span id="cb24-20"><a href="proper-roc-models.html#cb24-20" aria-hidden="true" tabindex="-1"></a>                   LETTERS[myLabelIndx], </span>
<span id="cb24-21"><a href="proper-roc-models.html#cb24-21" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;:&quot;</span>, </span>
<span id="cb24-22"><a href="proper-roc-models.html#cb24-22" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">sprintf</span>(<span class="st">&quot; alpha = %4.2f, mu = %4.2f&quot;</span>, </span>
<span id="cb24-23"><a href="proper-roc-models.html#cb24-23" aria-hidden="true" tabindex="-1"></a>                           alpha, mu)))</span>
<span id="cb24-24"><a href="proper-roc-models.html#cb24-24" aria-hidden="true" tabindex="-1"></a>      myLabelIndx <span class="ot">&lt;-</span> myLabelIndx <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb24-25"><a href="proper-roc-models.html#cb24-25" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb24-26"><a href="proper-roc-models.html#cb24-26" aria-hidden="true" tabindex="-1"></a>  }</span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="proper-roc-models.html#cb25-1" aria-hidden="true" tabindex="-1"></a>FPF <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.0</span>, <span class="dv">1</span>, <span class="fl">0.001</span>)</span>
<span id="cb25-2"><a href="proper-roc-models.html#cb25-2" aria-hidden="true" tabindex="-1"></a>cbmPdfs <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb25-3"><a href="proper-roc-models.html#cb25-3" aria-hidden="true" tabindex="-1"></a>myLabelIndx <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb25-4"><a href="proper-roc-models.html#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span>
<span id="cb25-5"><a href="proper-roc-models.html#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>) </span>
<span id="cb25-6"><a href="proper-roc-models.html#cb25-6" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb25-7"><a href="proper-roc-models.html#cb25-7" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb25-8"><a href="proper-roc-models.html#cb25-8" aria-hidden="true" tabindex="-1"></a>      alpha <span class="ot">&lt;-</span> alphaArr[i]</span>
<span id="cb25-9"><a href="proper-roc-models.html#cb25-9" aria-hidden="true" tabindex="-1"></a>      mu <span class="ot">&lt;-</span> muArr[j]</span>
<span id="cb25-10"><a href="proper-roc-models.html#cb25-10" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (i <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb25-11"><a href="proper-roc-models.html#cb25-11" aria-hidden="true" tabindex="-1"></a>        z1 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb25-12"><a href="proper-roc-models.html#cb25-12" aria-hidden="true" tabindex="-1"></a>        z2 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, mu <span class="sc">+</span> <span class="dv">3</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb25-13"><a href="proper-roc-models.html#cb25-13" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb25-14"><a href="proper-roc-models.html#cb25-14" aria-hidden="true" tabindex="-1"></a>        z1 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb25-15"><a href="proper-roc-models.html#cb25-15" aria-hidden="true" tabindex="-1"></a>        z2 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, mu <span class="sc">+</span> <span class="dv">3</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb25-16"><a href="proper-roc-models.html#cb25-16" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb25-17"><a href="proper-roc-models.html#cb25-17" aria-hidden="true" tabindex="-1"></a>      Pdf1 <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(z1)</span>
<span id="cb25-18"><a href="proper-roc-models.html#cb25-18" aria-hidden="true" tabindex="-1"></a>      Pdf2 <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> alpha) <span class="sc">*</span> <span class="fu">dnorm</span>(z2) <span class="sc">+</span> alpha <span class="sc">*</span> <span class="fu">dnorm</span>(z2, mu)</span>
<span id="cb25-19"><a href="proper-roc-models.html#cb25-19" aria-hidden="true" tabindex="-1"></a>      df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb25-20"><a href="proper-roc-models.html#cb25-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">z =</span> <span class="fu">c</span>(z1, z2), <span class="at">pdf =</span> <span class="fu">c</span>(Pdf1, Pdf2), </span>
<span id="cb25-21"><a href="proper-roc-models.html#cb25-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">truth =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&#39;non&#39;</span>, <span class="fu">length</span>(Pdf1)), </span>
<span id="cb25-22"><a href="proper-roc-models.html#cb25-22" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">rep</span>(<span class="st">&#39;dis&#39;</span>, <span class="fu">length</span>(Pdf2)))</span>
<span id="cb25-23"><a href="proper-roc-models.html#cb25-23" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb25-24"><a href="proper-roc-models.html#cb25-24" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb25-25"><a href="proper-roc-models.html#cb25-25" aria-hidden="true" tabindex="-1"></a>      cbmPdfs[[myLabelIndx]] <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb25-26"><a href="proper-roc-models.html#cb25-26" aria-hidden="true" tabindex="-1"></a>        df, <span class="fu">aes</span>(<span class="at">x =</span> z, <span class="at">y =</span> pdf, <span class="at">color =</span> truth)) <span class="sc">+</span></span>
<span id="cb25-27"><a href="proper-roc-models.html#cb25-27" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_line</span>(<span class="at">data =</span> df) <span class="sc">+</span></span>
<span id="cb25-28"><a href="proper-roc-models.html#cb25-28" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_colour_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>,<span class="st">&quot;darkgrey&quot;</span>)) <span class="sc">+</span></span>
<span id="cb25-29"><a href="proper-roc-models.html#cb25-29" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb25-30"><a href="proper-roc-models.html#cb25-30" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb25-31"><a href="proper-roc-models.html#cb25-31" aria-hidden="true" tabindex="-1"></a>        <span class="co">#theme(legend.position = c(0.5, 0.2)) +</span></span>
<span id="cb25-32"><a href="proper-roc-models.html#cb25-32" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb25-33"><a href="proper-roc-models.html#cb25-33" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggtitle</span>(<span class="fu">paste0</span>(<span class="st">&quot;Plot &quot;</span>, </span>
<span id="cb25-34"><a href="proper-roc-models.html#cb25-34" aria-hidden="true" tabindex="-1"></a>                   LETTERS[myLabelIndx], </span>
<span id="cb25-35"><a href="proper-roc-models.html#cb25-35" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;:&quot;</span>, </span>
<span id="cb25-36"><a href="proper-roc-models.html#cb25-36" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">sprintf</span>(<span class="st">&quot; alpha = %5.3f, mu = %5.3f&quot;</span>, </span>
<span id="cb25-37"><a href="proper-roc-models.html#cb25-37" aria-hidden="true" tabindex="-1"></a>                           alpha, mu)))</span>
<span id="cb25-38"><a href="proper-roc-models.html#cb25-38" aria-hidden="true" tabindex="-1"></a>      myLabelIndx <span class="ot">&lt;-</span> myLabelIndx <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb25-39"><a href="proper-roc-models.html#cb25-39" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb25-40"><a href="proper-roc-models.html#cb25-40" aria-hidden="true" tabindex="-1"></a>  }</span></code></pre></div>
</div>
<div id="proper-roc-models-cbm-rocs" class="section level3 hasAnchor" number="7.7.3">
<h3><span class="header-section-number">7.7.3</span> CBM ROC plots<a href="proper-roc-models.html#proper-roc-models-cbm-rocs" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The following figures should further clarify these equations. Fig. <a href="proper-roc-models.html#fig:proper-roc-models-cbm-plots-1">7.3</a> shows ROC curves predicted by the CBM model; the values of the <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\mu\)</span> parameters are indicated in the legend. For small <span class="math inline">\(\alpha\)</span> and/or small <span class="math inline">\(\mu\)</span> the curve approaches the chance diagonal consistent with the notion that if the lesion is not visible performance can be no better than chance level.</p>
<div class="figure"><span style="display:block;" id="fig:proper-roc-models-cbm-plots-1"></span>
<img src="07-proper-roc-models_files/figure-html/proper-roc-models-cbm-plots-1-1.png" alt="ROC curves predicted by the CBM model. The corresponding values of the parameters are indicated above the plots. For small $\alpha$ or small $\mu$ the curve approaches the chance diagonal, consistent with the notion that if the lesion is not visible, performance can be no better than chance level." width="672" />
<p class="caption">
FIGURE 7.3: ROC curves predicted by the CBM model. The corresponding values of the parameters are indicated above the plots. For small <span class="math inline">\(\alpha\)</span> or small <span class="math inline">\(\mu\)</span> the curve approaches the chance diagonal, consistent with the notion that if the lesion is not visible, performance can be no better than chance level.
</p>
</div>
<p>As one might expect as <span class="math inline">\(\mu\)</span> and/or <span class="math inline">\(\alpha\)</span> increases performance gets better and the curve more closely approaches the top-left corner. Try as one might, by varying the parameters, one can never get the predicted curve to cross the chance diagonal, confirming viscerally that one is dealing with a proper ROC model. A proof of this property is in Eqn. <a href="proper-roc-models.html#eq:proper-roc-models-cbm-likelihood">(7.20)</a> and the paragraph following it.</p>
<p>The pdf plots are shown next, Fig. <a href="proper-roc-models.html#fig:proper-roc-models-cbm-plots-2">7.4</a>.</p>
</div>
<div id="proper-roc-models-cbm-pdfs" class="section level3 hasAnchor" number="7.7.4">
<h3><span class="header-section-number">7.7.4</span> CBM pdf plots<a href="proper-roc-models.html#proper-roc-models-cbm-pdfs" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="figure"><span style="display:block;" id="fig:proper-roc-models-cbm-plots-2"></span>
<img src="07-proper-roc-models_files/figure-html/proper-roc-models-cbm-plots-2-1.png" alt="Density functions predicted by CBM. The dark line is the diseased distribution. The grey line is the non-diseased distribution. The bimodal diseased distribution is clearly evident in plots B and D." width="672" />
<p class="caption">
FIGURE 7.4: Density functions predicted by CBM. The dark line is the diseased distribution. The grey line is the non-diseased distribution. The bimodal diseased distribution is clearly evident in plots B and D.
</p>
</div>
<p>Likelihood ratio plots are shown next, Fig. <a href="proper-roc-models.html#fig:proper-roc-models-cbm-plots-3">7.5</a>.</p>
</div>
<div id="proper-roc-models-cbm-slopes" class="section level3 hasAnchor" number="7.7.5">
<h3><span class="header-section-number">7.7.5</span> CBM likelihood ratio plots<a href="proper-roc-models.html#proper-roc-models-cbm-slopes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="figure"><span style="display:block;" id="fig:proper-roc-models-cbm-plots-3"></span>
<img src="07-proper-roc-models_files/figure-html/proper-roc-models-cbm-plots-3-1.png" alt="The slope plots are labeled by the values of $\alpha$ and $\mu$. Close examination of the region near the flat part shows it does not plateau at zero; rather the minimum is at $(1 - \alpha)$." width="672" />
<p class="caption">
FIGURE 7.5: The slope plots are labeled by the values of <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\mu\)</span>. Close examination of the region near the flat part shows it does not plateau at zero; rather the minimum is at <span class="math inline">\((1 - \alpha)\)</span>.
</p>
</div>
<p>Fig. <a href="proper-roc-models.html#fig:proper-roc-models-cbm-plots-3">7.5</a> are the corresponding slope (or likelihood ratio) plots for the same parameter values as in the other figures in this section. All plots are monotonic with <span class="math inline">\(z\)</span>: as <span class="math inline">\(z\)</span> increases, the slope increases; this makes the reader using <span class="math inline">\(z\)</span>, under the CBM model, a likelihood ratio observer. In addition, according to Eqn. (20.26), the slope approaches <span class="math inline">\(1-\alpha\)</span> as <span class="math inline">\(z\)</span> approaches <span class="math inline">\(â\infty\)</span>, i.e., once again we encounter a proper ROC curve which approaches the upper-right corner with non-zero slope (except for the special case <span class="math inline">\(\alpha = 1\)</span>).</p>
</div>
</div>
<div id="proper-roc-models-bigamma" class="section level2 hasAnchor" number="7.8">
<h2><span class="header-section-number">7.8</span> The bigamma model (BGM)<a href="proper-roc-models.html#proper-roc-models-bigamma" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="proper-roc-models-bigamma-formulae" class="section level3 hasAnchor" number="7.8.1">
<h3><span class="header-section-number">7.8.1</span> BGM formulae<a href="proper-roc-models.html#proper-roc-models-bigamma-formulae" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The gamma function is defined by <span class="citation">(<a href="#ref-abramowitz1964handbook" role="doc-biblioref">Abramowitz and Stegun 1964</a>)</span>:</p>
<p><span class="math display" id="eq:proper-roc-models-gamma">\[\begin{equation}
\Gamma\left( x \right) = \int_{0}^{\infty}t^{x-1}e^{-t} dt
\tag{7.23}
\end{equation}\]</span></p>
<p>A random variable <span class="math inline">\(X\)</span> has a gamma distribution if its <span class="math inline">\(\text{pdf}\)</span> is <span class="citation">(<a href="#ref-larsen2005introduction" role="doc-biblioref">Larsen and Marx 2005</a>)</span>:</p>
<p><span class="math display" id="eq:proper-roc-models-gamma-pdf">\[\begin{equation}
\begin{matrix}
f\left( x |r,\lambda\right) = \frac{\lambda^r}{\Gamma\left( r \right)}x^{r-1}e^{-\lambda x}; &amp;
x\ge 0, r&gt;0, \lambda &gt;0
\end{matrix}
\tag{7.24}
\end{equation}\]</span></p>
<p>It has the following interpretation: for integer <span class="math inline">\(r\)</span>, assuming events are Poisson distributed with rate parameter <span class="math inline">\(\lambda\)</span>, the <span class="math inline">\(\text{pdf}\)</span> of event <span class="math inline">\(r\)</span> follows Eqn. <a href="proper-roc-models.html#eq:proper-roc-models-gamma-pdf">(7.24)</a>. However, in this equation, <span class="math inline">\(r\)</span> is not restricted to integers. Alternatively, <span class="math inline">\(l/r\)</span> is called the scale parameter and <span class="math inline">\(r\)</span> is called the shape parameter of the gamma distribution.</p>
<p>The mean and variance of this distribution are given by:</p>
<p><span class="math display" id="eq:proper-roc-models-gamma-mean-var">\[\begin{equation}
\left.\begin{aligned}
E\left( X \right) &amp;= \frac{r}{\lambda} \\
Var\left( X \right) &amp;= \frac{r}{\lambda^2} \\
\end{aligned}\right\}
\tag{7.25}
\end{equation}\]</span></p>
<p>The constant-shape bigamma model is defined <span class="citation">(<a href="#ref-dorfman1997proper" role="doc-biblioref">Dorfman et al. 1997</a>)</span> by the following pdfs (note <span class="math inline">\(\lambda = 1\)</span> for the non-diseased density and for either density <span class="math inline">\(x \ge 0\)</span>):</p>
<p><span class="math display" id="eq:proper-roc-models-gamma-pdfs">\[\begin{equation}
\left.\begin{aligned}
\text{pdf}_N\left( x \right) &amp;= f\left( x;r,1 \right)\\
&amp;= \frac{1}{\Gamma\left( r \right)}x^{r-1}e^{-x}\\
\text{pdf}_D\left( x \right) &amp;= f\left( x;r,\lambda \right)\\
&amp;= \frac{\lambda^r}{\Gamma\left( r \right)}x^{r-1}e^{-\lambda x}
\end{aligned}\right\}
\tag{7.26}
\end{equation}\]</span></p>
<p>The reason for the name âbigammaâ is because it involves two gamma distributions (just as âbinormalâ refers to two normal distributions). If the variance of the diseased distribution is to be larger than that of the non-diseased one the following constraint must hold:</p>
<p><span class="math display" id="eq:proper-roc-models-bigamma-lambda-inequality">\[\begin{equation}
0 &lt; \lambda \le 1
\tag{7.27}
\end{equation}\]</span></p>
<p>The limitation <span class="math inline">\(x \ge 0\)</span> suggests that <span class="math inline">\(x\)</span> is equivalent to a likelihood ratio (the ratio of two pdfs must be non-negative), which will be shown shortly to be true. The model assumes the same shape parameter <span class="math inline">\(r\)</span> for non-diseased and diseased cases, which is the basic reason why it predicts proper ROC curves. The likelihood ratio function <span class="math inline">\(l(x)\)</span> is given by:</p>
<p><span class="math display" id="eq:proper-roc-models-bigamma-likelihood">\[\begin{equation}
\left.\begin{aligned}
l_\text{BG}\left( x;r,\lambda \right) &amp;= \frac{\text{pdf}_D\left( x \right)}{\text{pdf}_N\left( x \right)} \\
&amp;=\lambda^r e^{-\left( \lambda - 1 \right) x}
\end{aligned}\right\}
\tag{7.28}
\end{equation}\]</span></p>
<p>The subscript âBGâ is for bigamma model. Since the exponential is a monotonic function of its argument, the likelihood ratio is a monotonic function of <span class="math inline">\(x\)</span>, which implies that an observer using knowledge of this distribution and basing decisions on observed values of <span class="math inline">\(x\)</span> exceeding a threshold, is a likelihood ratio observer. Notice the usage of <span class="math inline">\(x\)</span> rather than <span class="math inline">\(z\)</span>; the latter denotes samples from normal distributions. The bigamma model observer bases decisions on the x-sample, not the z-sample. In addition, for notational consistency one uses the symbol <span class="math inline">\(\xi\)</span> to denote a threshold on the x-axis. If <span class="math inline">\(x &gt; \xi\)</span> the case is diagnosed as diseased and otherwise it is diagnosed non-diseased.</p>
<p>Since <span class="math inline">\(0 &lt; \lambda \le 1\)</span> the slope at the upper right corner (corresponding to <span class="math inline">\(x = 0\)</span>) is <span class="math inline">\(\lambda ^ r\)</span> and the slope is infinite at the origin (corresponding to <span class="math inline">\(x = \infty\)</span>). As with PROPROC and CBM, once again one encounters a proper ROC curve approaching the upper-right corner with finite slope. If <span class="math inline">\(\lambda &gt; 1\)</span> the slope is zero at the origin, which would cause the ROC curve to start out below the chance diagonal. Therefore, constraint <span class="math inline">\(0 &lt; \lambda \le 1\)</span> is needed not just to yield a wider distribution for diseased cases but to also assure the ROC curve is proper. If <span class="math inline">\(\lambda = 1\)</span> then regardless of the value of <span class="math inline">\(r\)</span>, the ROC curve is the chance diagonal because the two pdfs become identical.</p>
<p>The cumulative distribution function (CDF) of the gamma distribution is given by:</p>
<p><span class="math display" id="eq:proper-roc-models-gamma-cdf">\[\begin{equation}
F\left( x;r,\lambda \right) = \int_{0}^{x}f\left( u;r,\lambda \right) du
= \frac{\gamma\left( r, \lambda x \right)}{\Gamma\left( r \right)}
\tag{7.29}
\end{equation}\]</span></p>
<p>Here the lower incomplete gamma function <span class="citation">(<a href="#ref-abramowitz1964handbook" role="doc-biblioref">Abramowitz and Stegun 1964</a>)</span> <span class="math inline">\(\gamma\left( s,x \right)\)</span> is defined by:</p>
<p><span class="math display" id="eq:proper-roc-models-gamma-incomplete">\[\begin{equation}
\gamma\left( s,x \right) = \int_{0}^{x} t^{s-1} e^{-t} dt
\tag{7.30}
\end{equation}\]</span></p>
<p>[Since <code>R</code> implements the CDF of the gamma distribution directly, as <code>pgamma()</code> one actually has no use for Eqn. <a href="proper-roc-models.html#eq:proper-roc-models-gamma-incomplete">(7.30)</a> which is included for pedagogic completeness.] The coordinates of the predicted ROC at threshold <span class="math inline">\(\xi\)</span> are (the complementary probability is needed as FPF and TPF are the probabilities of exceeding a threshold):</p>
<p><span class="math display" id="eq:proper-roc-models-gamma-fpf-tpf">\[\begin{equation}
\left.\begin{aligned}
\text{FPF}\left( \xi|r \right) &amp;= 1 - \frac{\gamma\left( r,\xi \right)}{\Gamma\left( r \right)} \\
&amp;=\int_{\xi}^{\infty} f\left( u;r,1 \right) \\
\text{TPF}\left( \xi|r, \lambda \right) &amp;= 1 - \frac{\gamma\left( r,\lambda \xi \right)}{\Gamma\left( r \right)} \\
&amp;=\int_{\xi}^{\infty} f\left( u;r,\lambda \right) \\
\end{aligned}\right\}
\tag{7.31}
\end{equation}\]</span></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="proper-roc-models.html#cb26-1" aria-hidden="true" tabindex="-1"></a>aucIntegrand <span class="ot">&lt;-</span> <span class="cf">function</span> (FPF, r, lambda) </span>
<span id="cb26-2"><a href="proper-roc-models.html#cb26-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb26-3"><a href="proper-roc-models.html#cb26-3" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pgamma</span>(<span class="fu">qgamma</span>(<span class="dv">1</span><span class="sc">-</span>FPF, r), r, <span class="at">scale =</span> <span class="dv">1</span><span class="sc">/</span>lambda)</span>
<span id="cb26-4"><a href="proper-roc-models.html#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(y)  </span>
<span id="cb26-5"><a href="proper-roc-models.html#cb26-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-6"><a href="proper-roc-models.html#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="proper-roc-models.html#cb26-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-8"><a href="proper-roc-models.html#cb26-8" aria-hidden="true" tabindex="-1"></a>biGammaRocY <span class="ot">&lt;-</span> <span class="cf">function</span> (x, r, lambda) {</span>
<span id="cb26-9"><a href="proper-roc-models.html#cb26-9" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pgamma</span>(x, r, <span class="at">scale =</span> <span class="dv">1</span><span class="sc">/</span>lambda)</span>
<span id="cb26-10"><a href="proper-roc-models.html#cb26-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(y)</span>
<span id="cb26-11"><a href="proper-roc-models.html#cb26-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="proper-roc-models-bigamma-code" class="section level3 hasAnchor" number="7.8.2">
<h3><span class="header-section-number">7.8.2</span> BGM code implementation<a href="proper-roc-models.html#proper-roc-models-bigamma-code" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="proper-roc-models.html#cb27-1" aria-hidden="true" tabindex="-1"></a>rArray <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">4.391</span>,<span class="dv">5</span>,<span class="dv">10</span>);lambdaArray <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.439</span>,<span class="fl">0.3</span>,<span class="fl">0.1</span>)</span>
<span id="cb27-2"><a href="proper-roc-models.html#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co">#r &lt;-  4.391; lambda &lt;-  0.439 # from Dorfman paper</span></span>
<span id="cb27-3"><a href="proper-roc-models.html#cb27-3" aria-hidden="true" tabindex="-1"></a>plotRoc <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb27-4"><a href="proper-roc-models.html#cb27-4" aria-hidden="true" tabindex="-1"></a>plotSlope <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb27-5"><a href="proper-roc-models.html#cb27-5" aria-hidden="true" tabindex="-1"></a>pdfs <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb27-6"><a href="proper-roc-models.html#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(rArray))</span>
<span id="cb27-7"><a href="proper-roc-models.html#cb27-7" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb27-8"><a href="proper-roc-models.html#cb27-8" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> rArray[i];lambda <span class="ot">&lt;-</span> lambdaArray[i]</span>
<span id="cb27-9"><a href="proper-roc-models.html#cb27-9" aria-hidden="true" tabindex="-1"></a>  AUC <span class="ot">&lt;-</span> <span class="fu">integrate</span>(aucIntegrand,<span class="dv">0</span>,<span class="dv">1</span>, <span class="at">r =</span> r, <span class="at">lambda =</span> lambda)</span>
<span id="cb27-10"><a href="proper-roc-models.html#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># cat(&quot;r = &quot;, r, &quot;, lambda = &quot;, lambda, &quot;, AUC = &quot;, AUC$value, &quot;\n&quot;)</span></span>
<span id="cb27-11"><a href="proper-roc-models.html#cb27-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># left limit below gets the upper end of the ROC curve </span></span>
<span id="cb27-12"><a href="proper-roc-models.html#cb27-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># the right limit gets the lower corner</span></span>
<span id="cb27-13"><a href="proper-roc-models.html#cb27-13" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, r<span class="sc">/</span>lambda <span class="sc">+</span> <span class="dv">10</span><span class="sc">*</span><span class="fu">sqrt</span>(r<span class="sc">/</span>lambda<span class="sc">^</span><span class="dv">2</span>), <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb27-14"><a href="proper-roc-models.html#cb27-14" aria-hidden="true" tabindex="-1"></a>  FPF <span class="ot">&lt;-</span> <span class="fu">biGammaRocY</span>(x, r, <span class="dv">1</span>)</span>
<span id="cb27-15"><a href="proper-roc-models.html#cb27-15" aria-hidden="true" tabindex="-1"></a>  TPF <span class="ot">&lt;-</span> <span class="fu">biGammaRocY</span>(x, r, lambda)</span>
<span id="cb27-16"><a href="proper-roc-models.html#cb27-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-17"><a href="proper-roc-models.html#cb27-17" aria-hidden="true" tabindex="-1"></a>  rocPlot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">FPF =</span> FPF, <span class="at">TPF =</span> TPF)</span>
<span id="cb27-18"><a href="proper-roc-models.html#cb27-18" aria-hidden="true" tabindex="-1"></a>  plotRoc[[i]] <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb27-19"><a href="proper-roc-models.html#cb27-19" aria-hidden="true" tabindex="-1"></a>    rocPlot, <span class="fu">aes</span>(<span class="at">x =</span> FPF, <span class="at">y =</span> TPF)) <span class="sc">+</span> </span>
<span id="cb27-20"><a href="proper-roc-models.html#cb27-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb27-21"><a href="proper-roc-models.html#cb27-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="fu">paste0</span>(<span class="st">&quot;Plot &quot;</span>, </span>
<span id="cb27-22"><a href="proper-roc-models.html#cb27-22" aria-hidden="true" tabindex="-1"></a>           LETTERS[i], </span>
<span id="cb27-23"><a href="proper-roc-models.html#cb27-23" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;:&quot;</span>, </span>
<span id="cb27-24"><a href="proper-roc-models.html#cb27-24" aria-hidden="true" tabindex="-1"></a>           <span class="fu">sprintf</span>(<span class="st">&quot; r = %3.2f, lambda = %3.2f&quot;</span>, </span>
<span id="cb27-25"><a href="proper-roc-models.html#cb27-25" aria-hidden="true" tabindex="-1"></a>                   r, lambda)))</span>
<span id="cb27-26"><a href="proper-roc-models.html#cb27-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-27"><a href="proper-roc-models.html#cb27-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-28"><a href="proper-roc-models.html#cb27-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># taking mean + 3 times the standard deviation</span></span>
<span id="cb27-29"><a href="proper-roc-models.html#cb27-29" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.01</span>, r<span class="sc">/</span>lambda <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span><span class="fu">sqrt</span>(r<span class="sc">/</span>lambda<span class="sc">^</span><span class="dv">2</span>), <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb27-30"><a href="proper-roc-models.html#cb27-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-31"><a href="proper-roc-models.html#cb27-31" aria-hidden="true" tabindex="-1"></a>  Pdf1 <span class="ot">&lt;-</span> <span class="fu">dgamma</span>(x, r)</span>
<span id="cb27-32"><a href="proper-roc-models.html#cb27-32" aria-hidden="true" tabindex="-1"></a>  Pdf2 <span class="ot">&lt;-</span> <span class="fu">dgamma</span>(x, r, <span class="at">scale =</span> <span class="dv">1</span><span class="sc">/</span>lambda)</span>
<span id="cb27-33"><a href="proper-roc-models.html#cb27-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-34"><a href="proper-roc-models.html#cb27-34" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(x, x), <span class="at">pdf =</span> <span class="fu">c</span>(Pdf1, Pdf2), </span>
<span id="cb27-35"><a href="proper-roc-models.html#cb27-35" aria-hidden="true" tabindex="-1"></a>                   <span class="at">truth =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&#39;non-diseased&#39;</span>, <span class="fu">length</span>(Pdf1)), </span>
<span id="cb27-36"><a href="proper-roc-models.html#cb27-36" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">rep</span>(<span class="st">&#39;diseased&#39;</span>, <span class="fu">length</span>(Pdf2))))</span>
<span id="cb27-37"><a href="proper-roc-models.html#cb27-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-38"><a href="proper-roc-models.html#cb27-38" aria-hidden="true" tabindex="-1"></a>  pdfs[[i]] <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb27-39"><a href="proper-roc-models.html#cb27-39" aria-hidden="true" tabindex="-1"></a>    df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> pdf, <span class="at">color =</span> truth)) <span class="sc">+</span> </span>
<span id="cb27-40"><a href="proper-roc-models.html#cb27-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb27-41"><a href="proper-roc-models.html#cb27-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;green&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb27-42"><a href="proper-roc-models.html#cb27-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb27-43"><a href="proper-roc-models.html#cb27-43" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.9</span>, <span class="fl">0.9</span>))</span>
<span id="cb27-44"><a href="proper-roc-models.html#cb27-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-45"><a href="proper-roc-models.html#cb27-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># may need to adjust limits to view detail of slope plot</span></span>
<span id="cb27-46"><a href="proper-roc-models.html#cb27-46" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.01</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb27-47"><a href="proper-roc-models.html#cb27-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-48"><a href="proper-roc-models.html#cb27-48" aria-hidden="true" tabindex="-1"></a>  slope <span class="ot">&lt;-</span> (<span class="fu">dgamma</span>(x, r, <span class="at">scale =</span> <span class="dv">1</span><span class="sc">/</span>lambda))<span class="sc">/</span><span class="fu">pgamma</span>(x, r)</span>
<span id="cb27-49"><a href="proper-roc-models.html#cb27-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-50"><a href="proper-roc-models.html#cb27-50" aria-hidden="true" tabindex="-1"></a>  slopePlot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">slope =</span> slope)</span>
<span id="cb27-51"><a href="proper-roc-models.html#cb27-51" aria-hidden="true" tabindex="-1"></a>  plotSlope[[i]] <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(slopePlot, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> slope)) <span class="sc">+</span> <span class="fu">geom_line</span>()</span>
<span id="cb27-52"><a href="proper-roc-models.html#cb27-52" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The bigamma-model formulae, coded above, generates ROC plots, Fig. <a href="proper-roc-models.html#fig:proper-roc-models-bigamma-plots-1">7.6</a>, pdfs plots for non-diseased and diseased cases, Fig. <a href="proper-roc-models.html#fig:proper-roc-models-bigamma-plots-2">7.7</a> and likelihood ratio (slope) plots Fig. <a href="proper-roc-models.html#fig:proper-roc-models-bigamma-plots-3">7.8</a> for four pairs of values of the <span class="math inline">\((r, \lambda)\)</span> bigamma model parameters. Plot A is for <span class="math inline">\((r = 1, \lambda = 1)\)</span> when the ROC becomes the chance diagonal regardless of the value of <span class="math inline">\(r\)</span>. Plot B is for <span class="math inline">\((r = 4.39, \lambda = 0.439)\)</span> identical to those used for simulations in <a href="#fn13" class="footnote-ref" id="fnref13"><sup>13</sup></a>. Plot C is for $(r = 5, = 0.3) and Plot D is for $(r = 10, = 0.1).</p>
</div>
<div id="proper-roc-models-bigamma-rocs" class="section level3 hasAnchor" number="7.8.3">
<h3><span class="header-section-number">7.8.3</span> BGM ROC plots<a href="proper-roc-models.html#proper-roc-models-bigamma-rocs" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="figure"><span style="display:block;" id="fig:proper-roc-models-bigamma-plots-1"></span>
<img src="07-proper-roc-models_files/figure-html/proper-roc-models-bigamma-plots-1-1.png" alt="ROC curves predicted by the bigamma model. The corresponding AUCs are 0.5, 0.879, 0.965 and 0.9999" width="672" />
<p class="caption">
FIGURE 7.6: ROC curves predicted by the bigamma model. The corresponding AUCs are 0.5, 0.879, 0.965 and 0.9999
</p>
</div>
<p>The slopes in Fig. <a href="proper-roc-models.html#fig:proper-roc-models-bigamma-plots-3">7.8</a> are consistent with the pdfs shown in Fig. <a href="proper-roc-models.html#fig:proper-roc-models-bigamma-plots-2">7.7</a>. For example, for plot D, the mean of the diseased distribution is 100 relative to 10 for the non-diseased distribution and performance is close to perfect.</p>
<p>The author is unaware of an analytic expression for AUC of the bigamma model. However the ROC curve can be numerically integrated using the <code>R</code> function <code>pgamma()</code>. Using this yields the following values of AUC of the ROCs shown in Fig. <a href="proper-roc-models.html#fig:proper-roc-models-bigamma-plots-1">7.6</a>: Plot A: AUC = 0.5, Plot B: AUC = 0.8790038, Plot C: AUC = 0.9645528 and Plot D: AUC = 0.9999984. <a href="#fn14" class="footnote-ref" id="fnref14"><sup>14</sup></a></p>
</div>
<div id="proper-roc-models-bigamma-pdfs" class="section level3 hasAnchor" number="7.8.4">
<h3><span class="header-section-number">7.8.4</span> BGM pdf plots<a href="proper-roc-models.html#proper-roc-models-bigamma-pdfs" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="figure"><span style="display:block;" id="fig:proper-roc-models-bigamma-plots-2"></span>
<img src="07-proper-roc-models_files/figure-html/proper-roc-models-bigamma-plots-2-1.png" alt="Density functions predicted by bigamma model." width="672" />
<p class="caption">
FIGURE 7.7: Density functions predicted by bigamma model.
</p>
</div>
</div>
<div id="proper-roc-models-bigamma-slopes" class="section level3 hasAnchor" number="7.8.5">
<h3><span class="header-section-number">7.8.5</span> BGM likelihood ratio plots<a href="proper-roc-models.html#proper-roc-models-bigamma-slopes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="figure"><span style="display:block;" id="fig:proper-roc-models-bigamma-plots-3"></span>
<img src="07-proper-roc-models_files/figure-html/proper-roc-models-bigamma-plots-3-1.png" alt="Likelihood ratio (or ROC slope) plots predicted by the bigamma model." width="672" />
<p class="caption">
FIGURE 7.8: Likelihood ratio (or ROC slope) plots predicted by the bigamma model.
</p>
</div>
<p>There used to be software called BIGAMMA, formerly MAXGAM <span class="citation">(<a href="#ref-dorfman1997proper" role="doc-biblioref">Dorfman et al. 1997</a>)</span>, implementing the bigamma model, but the University of Iowa ROC website now states âBIGAMMA is not available for download at this time. Users who desire a proper ROC model should use PROPROC or CBMâ (<a href="http://perception.radiology.uiowa.edu" class="uri">http://perception.radiology.uiowa.edu</a>, accessed Apr.Â 29, 2017). I understand the de-emphasis of this method, as the proposed bigamma distribution is inconsistent with expectations based on the central limit theorem, namely, when many random processes contribute to a measurement, the net distribution tends to normality, independent of the distributions of the individual processes.</p>
</div>
</div>
<div id="proper-roc-models-discussion" class="section level2 hasAnchor" number="7.9">
<h2><span class="header-section-number">7.9</span> Discussion<a href="proper-roc-models.html#proper-roc-models-discussion" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>With the readily availability of CBM and RSM (both implemented in <code>RJafroc</code>) there is no excuse for not using them. These programs are indeed âbullet-proofâ: they can fit any dataset that one cares to throw at them. The authorâs preference is to use RSM as it yields additional information about search and lesion-localization performance not available using CBM. PROPOROC has some problems fitting degenerate datasets that can be readily fixed but to my knowledge no one is actively maintaining this important contribution by Prof.Â Metz.</p>
</div>
<div id="proper-roc-models-references" class="section level2 hasAnchor" number="7.10">
<h2><span class="header-section-number">7.10</span> Chapter References<a href="proper-roc-models.html#proper-roc-models-references" class="anchor-section" aria-label="Anchor link to header"></a></h2>

</div>
</div>
<h3>REFERENCES<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-abramowitz1964handbook" class="csl-entry">
Abramowitz, Milton, and Irene A Stegun. 1964. <em>Handbook of Mathematical Functions with Formulas, Graphs, and Mathematical Tables</em>. Vol. 55. US Government printing office.
</div>
<div id="ref-andersson2008breast" class="csl-entry">
Andersson, Ingvar, Debra M Ikeda, Sophia Zackrisson, Mark Ruschin, Tony Svahn, Pontus Timberg, and Anders Tingberg. 2008. <span>âBreast Tomosynthesis and Digital Mammography: A Comparison of Breast Cancer Visibility and BIRADS Classification in a Population of Cancers with Subtle Mammographic Findings.â</span> <em>European Radiology</em> 18 (12): 2817â25.
</div>
<div id="ref-chakraborty2011estimating" class="csl-entry">
Chakraborty, DP, and Tony Svahn. 2011. <span>âEstimating the Parameters of a Model of Visual Search from ROC Data: An Alternate Method for Fitting Proper ROC Curves.â</span> In <em>Medical Imaging 2011: Image Perception, Observer Performance, and Technology Assessment</em>, 7966:189â97. SPIE.
</div>
<div id="ref-chakraborty2012inverse" class="csl-entry">
Chakraborty, DP, Hong-Jun Yoon, and Claudia Mello-Thoms. 2012. <span>âInverse Dependence of Search and Classification Performances in Lesion Localization Tasks.â</span> In <em>Medical Imaging 2012: Image Perception, Observer Performance, and Technology Assessment</em>, 8318:129â40. SPIE.
</div>
<div id="ref-dorfman2000contaminated3" class="csl-entry">
Dorfman, Donald D, and Kevin S Berbaum. 2000a. <span>âA Contaminated Binormal Model for ROC Data: Part II. A Formal Model.â</span> <em>Academic Radiology</em> 7 (6): 427â37.
</div>
<div id="ref-dorfman2000contaminated2" class="csl-entry">
âââ. 2000b. <span>âA Contaminated Binormal Model for ROC Data: Part III. Initial Evaluation with Detection ROC Data.â</span> <em>Academic Radiology</em> 7 (6): 438â47.
</div>
<div id="ref-dorfman2000contaminated1" class="csl-entry">
Dorfman, Donald D, Kevin S Berbaum, and Eric A Brandser. 2000. <span>âA Contaminated Binormal Model for ROC Data: Part i. Some Interesting Examples of Binormal Degeneracy.â</span> <em>Academic Radiology</em> 7 (6): 420â26.
</div>
<div id="ref-dorfman1997proper" class="csl-entry">
Dorfman, Donald D, Kevin S Berbaum, Charles E Metz, Russell V Lenth, James A Hanley, and Hatem Abu Dagga. 1997. <span>âProper Receiver Operating Characteristic Analysis: The Bigamma Model.â</span> <em>Academic Radiology</em> 4 (2): 138â49.
</div>
<div id="ref-Egan1975" class="csl-entry">
Egan, James P. 1975b. <em>Signal Detection Theory and <span>ROC</span> Analysis</em>. Book. First. Academic Press Series in Cognition and Perception. New York: Academic Press, Inc.
</div>
<div id="ref-green1966signal" class="csl-entry">
Green, David Marvin, John A Swets, et al. 1966. <em>Signal Detection Theory and Psychophysics</em>. Vol. 1. Wiley New York.
</div>
<div id="ref-larsen2005introduction" class="csl-entry">
Larsen, Richard J, and Morris L Marx. 2005. <em>An Introduction to Mathematical Statistics</em>. Prentice Hall Hoboken, NJ.
</div>
<div id="ref-metz1999proper" class="csl-entry">
Metz, Charles E, and Xiaochuan Pan. 1999. <span>â<span>âProperâ</span> Binormal ROC Curves: Theory and Maximum-Likelihood Estimation.â</span> <em>Journal of Mathematical Psychology</em> 43 (1): 1â33.
</div>
<div id="ref-neyman1933ix" class="csl-entry">
Neyman, Jerzy, and Egon Sharpe Pearson. 1933. <span>âIX. On the Problem of the Most Efficient Tests of Statistical Hypotheses.â</span> <em>Philosophical Transactions of the Royal Society of London. Series A, Containing Papers of a Mathematical or Physical Character</em> 231 (694-706): 289â337.
</div>
<div id="ref-pan1997proper" class="csl-entry">
Pan, Xiaochuan, and Charles E Metz. 1997. <span>âThe <span>âProperâ</span> Binormal Model: Parametric Receiver Operating Characteristic Curve Estimation with Degenerate Data.â</span> <em>Academic Radiology</em> 4 (5): 380â89.
</div>
<div id="ref-swensson1996unified" class="csl-entry">
Swensson, Richard G. 1996. <span>âUnified Measurement of Observer Performance in Detecting and Localizing Target Objects on Images.â</span> <em>Medical Physics</em> 23 (10): 1709â25.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="11">
<li id="fn11"><p>For a positive-directed decision variable, as in this book, the term âmonotonicâ is always meant to be âmonotonic increasingâ. It is possible for a transformation to be monotonic decreasing, as in <span class="math inline">\(l = 1/z\)</span>.<a href="proper-roc-models.html#fnref11" class="footnote-back">â©ï¸</a></p></li>
<li id="fn12"><p>The 1999 publication is a difficult read but well worth it for deeper understanding.<a href="proper-roc-models.html#fnref12" class="footnote-back">â©ï¸</a></p></li>
<li id="fn13"><p>dorfman1997proper<a href="proper-roc-models.html#fnref13" class="footnote-back">â©ï¸</a></p></li>
<li id="fn14"><p>One can confirm that values of <span class="math inline">\(\lambda &gt; 1\)</span> yield ROC curves below the chance diagonal and AUC less than 0.5. These ROC curves are actually âreflectedâ versions of proper ROC curves; for each such curve the slope starts at a finite positive value near the origin and increases to infinity near the top right corner.<a href="proper-roc-models.html#fnref14" class="footnote-back">â©ï¸</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="binormal-model.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="proproc-rocs.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["RJafrocRocBook.pdf", "RJafrocRocBook.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
