<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Binormal model | The RJafroc Roc Book</title>
  <meta name="description" content="Artificial intelligence and observer performance book based on RJafroc." />
  <meta name="generator" content="bookdown 0.32 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Binormal model | The RJafroc Roc Book" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Artificial intelligence and observer performance book based on RJafroc." />
  <meta name="github-repo" content="dpc10ster/RJafrocRocBook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Binormal model | The RJafroc Roc Book" />
  
  <meta name="twitter:description" content="Artificial intelligence and observer performance book based on RJafroc." />
  

<meta name="author" content="Dev P. Chakraborty, PhD" />


<meta name="date" content="2023-02-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="empirical-auc.html"/>
<link rel="next" href="sources-of-variability.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">RJafroc documentation</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#rationale-and-organization"><i class="fa fa-check"></i><b>0.1</b> Rationale and Organization</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#tba-acknowledgements"><i class="fa fa-check"></i><b>0.2</b> TBA Acknowledgements</a></li>
</ul></li>
<li class="part"><span><b>ROC paradigm</b></span></li>
<li class="chapter" data-level="1" data-path="preliminaries.html"><a href="preliminaries.html"><i class="fa fa-check"></i><b>1</b> Preliminaries</a><ul>
<li class="chapter" data-level="1.1" data-path="preliminaries.html"><a href="preliminaries.html#preliminaries-how-much-finished"><i class="fa fa-check"></i><b>1.1</b> TBA How much finished</a></li>
<li class="chapter" data-level="1.2" data-path="preliminaries.html"><a href="preliminaries.html#preliminariesIntro"><i class="fa fa-check"></i><b>1.2</b> Introduction</a></li>
<li class="chapter" data-level="1.3" data-path="preliminaries.html"><a href="preliminaries.html#clinical-tasks"><i class="fa fa-check"></i><b>1.3</b> Clinical tasks</a><ul>
<li class="chapter" data-level="1.3.1" data-path="preliminaries.html"><a href="preliminaries.html#workflow-in-an-imaging-study"><i class="fa fa-check"></i><b>1.3.1</b> Workflow in an imaging study</a></li>
<li class="chapter" data-level="1.3.2" data-path="preliminaries.html"><a href="preliminaries.html#the-screening-and-diagnostic-workup-tasks"><i class="fa fa-check"></i><b>1.3.2</b> The screening and diagnostic workup tasks</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="preliminaries.html"><a href="preliminaries.html#imaging-device-development-and-its-clinical-deployment"><i class="fa fa-check"></i><b>1.4</b> Imaging device development and its clinical deployment</a><ul>
<li class="chapter" data-level="1.4.1" data-path="preliminaries.html"><a href="preliminaries.html#physical-measurements"><i class="fa fa-check"></i><b>1.4.1</b> Physical measurements</a></li>
<li class="chapter" data-level="1.4.2" data-path="preliminaries.html"><a href="preliminaries.html#quality-control-and-image-quality-optimization"><i class="fa fa-check"></i><b>1.4.2</b> Quality Control and Image quality optimization</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="preliminaries.html"><a href="preliminaries.html#image-quality-vs.-task-performance"><i class="fa fa-check"></i><b>1.5</b> Image quality vs. task performance</a></li>
<li class="chapter" data-level="1.6" data-path="preliminaries.html"><a href="preliminaries.html#why-physical-measures-of-image-quality-are-not-enough"><i class="fa fa-check"></i><b>1.6</b> Why physical measures of image quality are not enough</a></li>
<li class="chapter" data-level="1.7" data-path="preliminaries.html"><a href="preliminaries.html#model-observers"><i class="fa fa-check"></i><b>1.7</b> Model observers</a></li>
<li class="chapter" data-level="1.8" data-path="preliminaries.html"><a href="preliminaries.html#measuring-observer-performance-four-paradigms"><i class="fa fa-check"></i><b>1.8</b> Measuring observer performance: four paradigms</a><ul>
<li class="chapter" data-level="1.8.1" data-path="preliminaries.html"><a href="preliminaries.html#basic-approach-to-the-analysis"><i class="fa fa-check"></i><b>1.8.1</b> Basic approach to the analysis</a></li>
<li class="chapter" data-level="1.8.2" data-path="preliminaries.html"><a href="preliminaries.html#historical-notes"><i class="fa fa-check"></i><b>1.8.2</b> Historical notes</a></li>
</ul></li>
<li class="chapter" data-level="1.9" data-path="preliminaries.html"><a href="preliminaries.html#hierarchy-of-assessment-methods"><i class="fa fa-check"></i><b>1.9</b> Hierarchy of assessment methods</a></li>
<li class="chapter" data-level="1.10" data-path="preliminaries.html"><a href="preliminaries.html#overview-of-the-book-and-how-to-use-it"><i class="fa fa-check"></i><b>1.10</b> Overview of the book and how to use it</a><ul>
<li class="chapter" data-level="1.10.1" data-path="preliminaries.html"><a href="preliminaries.html#overview-of-the-book"><i class="fa fa-check"></i><b>1.10.1</b> Overview of the book</a></li>
<li class="chapter" data-level="1.10.2" data-path="preliminaries.html"><a href="preliminaries.html#how-to-use-the-book"><i class="fa fa-check"></i><b>1.10.2</b> How to use the book</a></li>
</ul></li>
<li class="chapter" data-level="1.11" data-path="preliminaries.html"><a href="preliminaries.html#preliminaries-Summary"><i class="fa fa-check"></i><b>1.11</b> Summary</a></li>
<li class="chapter" data-level="1.12" data-path="preliminaries.html"><a href="preliminaries.html#preliminaries-Discussion"><i class="fa fa-check"></i><b>1.12</b> Discussion</a></li>
<li class="chapter" data-level="1.13" data-path="preliminaries.html"><a href="preliminaries.html#preliminaries-references"><i class="fa fa-check"></i><b>1.13</b> References</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="binary-task.html"><a href="binary-task.html"><i class="fa fa-check"></i><b>2</b> The Binary Task</a><ul>
<li class="chapter" data-level="2.1" data-path="binary-task.html"><a href="binary-task.html#binary-task-how-much-finished"><i class="fa fa-check"></i><b>2.1</b> TBA How much finished</a></li>
<li class="chapter" data-level="2.2" data-path="binary-task.html"><a href="binary-task.html#binary-taskIntro"><i class="fa fa-check"></i><b>2.2</b> Introduction</a></li>
<li class="chapter" data-level="2.3" data-path="binary-task.html"><a href="binary-task.html#binary-taskTruth"><i class="fa fa-check"></i><b>2.3</b> The fundamental 2x2 table</a></li>
<li class="chapter" data-level="2.4" data-path="binary-task.html"><a href="binary-task.html#sensitivity-and-specificity"><i class="fa fa-check"></i><b>2.4</b> Sensitivity and specificity</a><ul>
<li class="chapter" data-level="2.4.1" data-path="binary-task.html"><a href="binary-task.html#reasons-for-the-names-sensitivity-and-specificity"><i class="fa fa-check"></i><b>2.4.1</b> Reasons for the names sensitivity and specificity</a></li>
<li class="chapter" data-level="2.4.2" data-path="binary-task.html"><a href="binary-task.html#estimating-sensitivity-and-specificity"><i class="fa fa-check"></i><b>2.4.2</b> Estimating sensitivity and specificity</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="binary-task.html"><a href="binary-task.html#disease-prevalence"><i class="fa fa-check"></i><b>2.5</b> Disease prevalence</a></li>
<li class="chapter" data-level="2.6" data-path="binary-task.html"><a href="binary-task.html#accuracy"><i class="fa fa-check"></i><b>2.6</b> Accuracy</a></li>
<li class="chapter" data-level="2.7" data-path="binary-task.html"><a href="binary-task.html#negative-and-positive-predictive-values"><i class="fa fa-check"></i><b>2.7</b> Negative and positive predictive values</a><ul>
<li class="chapter" data-level="2.7.1" data-path="binary-task.html"><a href="binary-task.html#binary-taskNpvPpvCode"><i class="fa fa-check"></i><b>2.7.1</b> Example calculation of PPV, NPV and accuracy</a></li>
<li class="chapter" data-level="2.7.2" data-path="binary-task.html"><a href="binary-task.html#binary-taskNpvPpvComments"><i class="fa fa-check"></i><b>2.7.2</b> Comments</a></li>
<li class="chapter" data-level="2.7.3" data-path="binary-task.html"><a href="binary-task.html#binary-taskNpvPpvIrrel2LabTasks"><i class="fa fa-check"></i><b>2.7.3</b> PPV and NPV are irrelevant to laboratory tasks</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="binary-task.html"><a href="binary-task.html#binary-task-Summary"><i class="fa fa-check"></i><b>2.8</b> Summary</a></li>
<li class="chapter" data-level="2.9" data-path="binary-task.html"><a href="binary-task.html#binary-task-Discussion"><i class="fa fa-check"></i><b>2.9</b> Discussion</a></li>
<li class="chapter" data-level="2.10" data-path="binary-task.html"><a href="binary-task.html#binary-task-references"><i class="fa fa-check"></i><b>2.10</b> References</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="binary-task-model.html"><a href="binary-task-model.html"><i class="fa fa-check"></i><b>3</b> Modeling the Binary Task</a><ul>
<li class="chapter" data-level="3.1" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-how-much-finished"><i class="fa fa-check"></i><b>3.1</b> TBA How much finished</a></li>
<li class="chapter" data-level="3.2" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-intro"><i class="fa fa-check"></i><b>3.2</b> Introduction</a></li>
<li class="chapter" data-level="3.3" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-z-sample-model"><i class="fa fa-check"></i><b>3.3</b> Decision variable and decision threshold</a><ul>
<li class="chapter" data-level="3.3.1" data-path="binary-task-model.html"><a href="binary-task-model.html#existence-of-a-decision-variable"><i class="fa fa-check"></i><b>3.3.1</b> Existence of a decision variable</a></li>
<li class="chapter" data-level="3.3.2" data-path="binary-task-model.html"><a href="binary-task-model.html#existence-of-a-decision-threshold"><i class="fa fa-check"></i><b>3.3.2</b> Existence of a decision threshold</a></li>
<li class="chapter" data-level="3.3.3" data-path="binary-task-model.html"><a href="binary-task-model.html#adequacy-of-the-training-session"><i class="fa fa-check"></i><b>3.3.3</b> Adequacy of the training session</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-example-1"><i class="fa fa-check"></i><b>3.4</b> Changing the decision threshold: Example I</a></li>
<li class="chapter" data-level="3.5" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-example-2"><i class="fa fa-check"></i><b>3.5</b> Changing the decision threshold: Example II</a></li>
<li class="chapter" data-level="3.6" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-equal-variance-binormal-model"><i class="fa fa-check"></i><b>3.6</b> The equal-variance binormal model</a></li>
<li class="chapter" data-level="3.7" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-normal-distribution"><i class="fa fa-check"></i><b>3.7</b> The normal distribution</a></li>
<li class="chapter" data-level="3.8" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-sensitivity-specificity"><i class="fa fa-check"></i><b>3.8</b> Analytic expressions for specificity and sensitivity</a></li>
<li class="chapter" data-level="3.9" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-sensitivity-specificity-demo"><i class="fa fa-check"></i><b>3.9</b> Demonstration of the concepts of sensitivity and specificity</a><ul>
<li class="chapter" data-level="3.9.1" data-path="binary-task-model.html"><a href="binary-task-model.html#estimating-mu-from-a-finite-sample"><i class="fa fa-check"></i><b>3.9.1</b> Estimating mu from a finite sample</a></li>
<li class="chapter" data-level="3.9.2" data-path="binary-task-model.html"><a href="binary-task-model.html#changing-the-seed-variable-case-sampling-variability"><i class="fa fa-check"></i><b>3.9.2</b> Changing the seed variable: case-sampling variability</a></li>
<li class="chapter" data-level="3.9.3" data-path="binary-task-model.html"><a href="binary-task-model.html#increasing-the-numbers-of-cases"><i class="fa fa-check"></i><b>3.9.3</b> Increasing the numbers of cases</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-sensitivity-specificity-inverse-variation"><i class="fa fa-check"></i><b>3.10</b> Inverse variation of sensitivity and specificity and the need for a single FOM</a></li>
<li class="chapter" data-level="3.11" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-roc-curve"><i class="fa fa-check"></i><b>3.11</b> The ROC curve</a><ul>
<li class="chapter" data-level="3.11.1" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-chance-diagonal"><i class="fa fa-check"></i><b>3.11.1</b> The chance diagonal</a></li>
<li class="chapter" data-level="3.11.2" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-guessing-observer"><i class="fa fa-check"></i><b>3.11.2</b> The guessing observer</a></li>
<li class="chapter" data-level="3.11.3" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-symmetry-wrt-negative-diagonal"><i class="fa fa-check"></i><b>3.11.3</b> Symmetry with respect to negative diagonal</a></li>
<li class="chapter" data-level="3.11.4" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-auc-roc-important"><i class="fa fa-check"></i><b>3.11.4</b> Area under the ROC curve</a></li>
<li class="chapter" data-level="3.11.5" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-properties-roc"><i class="fa fa-check"></i><b>3.11.5</b> Properties of the equal-variance binormal model ROC curve</a></li>
<li class="chapter" data-level="3.11.6" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-comments"><i class="fa fa-check"></i><b>3.11.6</b> Comments</a></li>
<li class="chapter" data-level="3.11.7" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-mu-parameter-intepretation"><i class="fa fa-check"></i><b>3.11.7</b> Physical interpretation of the mu-parameter</a></li>
</ul></li>
<li class="chapter" data-level="3.12" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-confidence-intervals"><i class="fa fa-check"></i><b>3.12</b> Assigning confidence intervals to an operating point</a></li>
<li class="chapter" data-level="3.13" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-beam-study"><i class="fa fa-check"></i><b>3.13</b> Variability in sensitivity and specificity: the Beam et al study</a></li>
<li class="chapter" data-level="3.14" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-summary"><i class="fa fa-check"></i><b>3.14</b> Summary</a></li>
<li class="chapter" data-level="3.15" data-path="binary-task-model.html"><a href="binary-task-model.html#binary-task-model-references"><i class="fa fa-check"></i><b>3.15</b> References</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ratings-paradigm.html"><a href="ratings-paradigm.html"><i class="fa fa-check"></i><b>4</b> Ratings Paradigm</a><ul>
<li class="chapter" data-level="4.1" data-path="ratings-paradigm.html"><a href="ratings-paradigm.html#ratings-paradigm-how-much-finished"><i class="fa fa-check"></i><b>4.1</b> TBA How much finished</a></li>
<li class="chapter" data-level="4.2" data-path="ratings-paradigm.html"><a href="ratings-paradigm.html#ratings-paradigm-introduction"><i class="fa fa-check"></i><b>4.2</b> Introduction</a></li>
<li class="chapter" data-level="4.3" data-path="ratings-paradigm.html"><a href="ratings-paradigm.html#binary-task-roc-counts-table"><i class="fa fa-check"></i><b>4.3</b> The ROC counts table</a></li>
<li class="chapter" data-level="4.4" data-path="ratings-paradigm.html"><a href="ratings-paradigm.html#binary-task-operating-points-from-counts-table"><i class="fa fa-check"></i><b>4.4</b> Operating points from counts table</a><ul>
<li class="chapter" data-level="4.4.1" data-path="ratings-paradigm.html"><a href="ratings-paradigm.html#labeling-the-points"><i class="fa fa-check"></i><b>4.4.1</b> Labeling the points</a></li>
<li class="chapter" data-level="4.4.2" data-path="ratings-paradigm.html"><a href="ratings-paradigm.html#binary-task-examples"><i class="fa fa-check"></i><b>4.4.2</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="ratings-paradigm.html"><a href="ratings-paradigm.html#binary-task-automating"><i class="fa fa-check"></i><b>4.5</b> Automating all this</a></li>
<li class="chapter" data-level="4.6" data-path="ratings-paradigm.html"><a href="ratings-paradigm.html#binary-task-relation-to-rating"><i class="fa fa-check"></i><b>4.6</b> Relation between ratings paradigm and the binary paradigm</a></li>
<li class="chapter" data-level="4.7" data-path="ratings-paradigm.html"><a href="ratings-paradigm.html#binary-task-ratings-not-numerical-values"><i class="fa fa-check"></i><b>4.7</b> Ratings are not numerical values</a></li>
<li class="chapter" data-level="4.8" data-path="ratings-paradigm.html"><a href="ratings-paradigm.html#binary-task-clinical-operating-point"><i class="fa fa-check"></i><b>4.8</b> A single “clinical” operating point from ratings data</a></li>
<li class="chapter" data-level="4.9" data-path="ratings-paradigm.html"><a href="ratings-paradigm.html#binary-task-2afc"><i class="fa fa-check"></i><b>4.9</b> The forced choice paradigm</a></li>
<li class="chapter" data-level="4.10" data-path="ratings-paradigm.html"><a href="ratings-paradigm.html#binary-task-observer-studies-as-simulations"><i class="fa fa-check"></i><b>4.10</b> Observer performance studies as laboratory simulations of clinical tasks</a></li>
<li class="chapter" data-level="4.11" data-path="ratings-paradigm.html"><a href="ratings-paradigm.html#binary-task-discrete-vs-continuous-ratings"><i class="fa fa-check"></i><b>4.11</b> Discrete vs. continuous ratings: the Miller study</a></li>
<li class="chapter" data-level="4.12" data-path="ratings-paradigm.html"><a href="ratings-paradigm.html#binary-task-birads-rating-scale"><i class="fa fa-check"></i><b>4.12</b> The BI-RADS ratings scale and ROC studies</a></li>
<li class="chapter" data-level="4.13" data-path="ratings-paradigm.html"><a href="ratings-paradigm.html#binary-task-birads-rating-scale-controversy"><i class="fa fa-check"></i><b>4.13</b> The controversy</a></li>
<li class="chapter" data-level="4.14" data-path="ratings-paradigm.html"><a href="ratings-paradigm.html#ratings-paradigm-discussion"><i class="fa fa-check"></i><b>4.14</b> Discussion</a></li>
<li class="chapter" data-level="4.15" data-path="ratings-paradigm.html"><a href="ratings-paradigm.html#ratings-paradigm-references"><i class="fa fa-check"></i><b>4.15</b> References</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="empirical-auc.html"><a href="empirical-auc.html"><i class="fa fa-check"></i><b>5</b> Empirical AUC</a><ul>
<li class="chapter" data-level="5.1" data-path="empirical-auc.html"><a href="empirical-auc.html#empirical-auc-how-much-finished"><i class="fa fa-check"></i><b>5.1</b> TBA How much finished</a></li>
<li class="chapter" data-level="5.2" data-path="empirical-auc.html"><a href="empirical-auc.html#empirical-auc-introduction"><i class="fa fa-check"></i><b>5.2</b> Introduction</a></li>
<li class="chapter" data-level="5.3" data-path="empirical-auc.html"><a href="empirical-auc.html#empirical-roc-plot"><i class="fa fa-check"></i><b>5.3</b> The empirical ROC plot</a><ul>
<li class="chapter" data-level="5.3.1" data-path="empirical-auc.html"><a href="empirical-auc.html#notation-for-cases"><i class="fa fa-check"></i><b>5.3.1</b> Notation for cases</a></li>
<li class="chapter" data-level="5.3.2" data-path="empirical-auc.html"><a href="empirical-auc.html#an-empirical-operating-point"><i class="fa fa-check"></i><b>5.3.2</b> An empirical operating point</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="empirical-auc.html"><a href="empirical-auc.html#empirical-auc-operating-points"><i class="fa fa-check"></i><b>5.4</b> Empirical operating points from ratings data</a></li>
<li class="chapter" data-level="5.5" data-path="empirical-auc.html"><a href="empirical-auc.html#empirical-auc-area-under"><i class="fa fa-check"></i><b>5.5</b> AUC under the empirical ROC plot</a></li>
<li class="chapter" data-level="5.6" data-path="empirical-auc.html"><a href="empirical-auc.html#empirical-auc-wilcoxon"><i class="fa fa-check"></i><b>5.6</b> The Wilcoxon statistic</a></li>
<li class="chapter" data-level="5.7" data-path="empirical-auc.html"><a href="empirical-auc.html#empirical-auc-wilcoxon-bamber-theorem"><i class="fa fa-check"></i><b>5.7</b> Bamber’s Equivalence theorem</a></li>
<li class="chapter" data-level="5.8" data-path="empirical-auc.html"><a href="empirical-auc.html#empirical-auc-wilcoxon-bamber-theorem-importance"><i class="fa fa-check"></i><b>5.8</b> Importance of Bamber’s theorem</a></li>
<li class="chapter" data-level="5.9" data-path="empirical-auc.html"><a href="empirical-auc.html#empirical-auc-discussion-summary"><i class="fa fa-check"></i><b>5.9</b> Discussion / Summary</a></li>
<li class="chapter" data-level="5.10" data-path="empirical-auc.html"><a href="empirical-auc.html#empirical-auc-appendix-details-bamber-theorem"><i class="fa fa-check"></i><b>5.10</b> Appendix 5.A: Details of Wilcoxon theorem</a><ul>
<li class="chapter" data-level="5.10.1" data-path="empirical-auc.html"><a href="empirical-auc.html#upper-triangle"><i class="fa fa-check"></i><b>5.10.1</b> Upper triangle</a></li>
<li class="chapter" data-level="5.10.2" data-path="empirical-auc.html"><a href="empirical-auc.html#lowest-trapezoid"><i class="fa fa-check"></i><b>5.10.2</b> Lowest trapezoid</a></li>
</ul></li>
<li class="chapter" data-level="5.11" data-path="empirical-auc.html"><a href="empirical-auc.html#empirical-auc-references"><i class="fa fa-check"></i><b>5.11</b> References</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="binormal-model.html"><a href="binormal-model.html"><i class="fa fa-check"></i><b>6</b> Binormal model</a><ul>
<li class="chapter" data-level="6.1" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-how-much-finished"><i class="fa fa-check"></i><b>6.1</b> TBA How much finished</a></li>
<li class="chapter" data-level="6.2" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-introduction"><i class="fa fa-check"></i><b>6.2</b> TBA Introduction</a></li>
<li class="chapter" data-level="6.3" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-definition"><i class="fa fa-check"></i><b>6.3</b> Binormal model</a><ul>
<li class="chapter" data-level="6.3.1" data-path="binormal-model.html"><a href="binormal-model.html#the-basic-model"><i class="fa fa-check"></i><b>6.3.1</b> The basic model</a></li>
<li class="chapter" data-level="6.3.2" data-path="binormal-model.html"><a href="binormal-model.html#additional-parameters-for-binned-data"><i class="fa fa-check"></i><b>6.3.2</b> Additional parameters for binned data</a></li>
<li class="chapter" data-level="6.3.3" data-path="binormal-model.html"><a href="binormal-model.html#sensitivity-and-specificity-1"><i class="fa fa-check"></i><b>6.3.3</b> Sensitivity and specificity</a></li>
<li class="chapter" data-level="6.3.4" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-in-conventional-notation"><i class="fa fa-check"></i><b>6.3.4</b> Binormal model in conventional notation</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-roc-curve"><i class="fa fa-check"></i><b>6.4</b> Binormal ROC curve</a></li>
<li class="chapter" data-level="6.5" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-scalar-measure"><i class="fa fa-check"></i><b>6.5</b> Scalar threshold-independent measure</a><ul>
<li class="chapter" data-level="6.5.1" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-partial-auc"><i class="fa fa-check"></i><b>6.5.1</b> Partial AUC</a></li>
<li class="chapter" data-level="6.5.2" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-full-auc"><i class="fa fa-check"></i><b>6.5.2</b> Full AUC</a></li>
<li class="chapter" data-level="6.5.3" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-d-prime"><i class="fa fa-check"></i><b>6.5.3</b> The d’ measure</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-partial-true"><i class="fa fa-check"></i><b>6.6</b> Partial AUC vs. true performance</a></li>
<li class="chapter" data-level="6.7" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-illustrative-plots"><i class="fa fa-check"></i><b>6.7</b> Illustrative plots</a></li>
<li class="chapter" data-level="6.8" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-geometrical-argument"><i class="fa fa-check"></i><b>6.8</b> Geometrical argument</a></li>
<li class="chapter" data-level="6.9" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-optimal-op-pt"><i class="fa fa-check"></i><b>6.9</b> Optimal operating point on ROC</a></li>
<li class="chapter" data-level="6.10" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-discussion"><i class="fa fa-check"></i><b>6.10</b> Discussion</a></li>
<li class="chapter" data-level="6.11" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-pdf-curves-appendix-1"><i class="fa fa-check"></i><b>6.11</b> Appendix I: Density functions</a></li>
<li class="chapter" data-level="6.12" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-appendix-2"><i class="fa fa-check"></i><b>6.12</b> Appendix II: Area under binormal ROC</a><ul>
<li class="chapter" data-level="6.12.1" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-appendix-1-partial-auc"><i class="fa fa-check"></i><b>6.12.1</b> General case (partial-area)</a></li>
<li class="chapter" data-level="6.12.2" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-appendix-1-total-auc"><i class="fa fa-check"></i><b>6.12.2</b> Special case (total area)</a></li>
</ul></li>
<li class="chapter" data-level="6.13" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-invariance-property-appendix-3"><i class="fa fa-check"></i><b>6.13</b> Appendix III: Invariance property of pdfs</a></li>
<li class="chapter" data-level="6.14" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-curve-fitting-appendix-4"><i class="fa fa-check"></i><b>6.14</b> Appendix IV: Fitting an ROC curve</a><ul>
<li class="chapter" data-level="6.14.1" data-path="binormal-model.html"><a href="binormal-model.html#java-fitted-roc-curve"><i class="fa fa-check"></i><b>6.14.1</b> JAVA fitted ROC curve</a></li>
<li class="chapter" data-level="6.14.2" data-path="binormal-model.html"><a href="binormal-model.html#simplistic-straight-line-fit-to-the-roc-curve"><i class="fa fa-check"></i><b>6.14.2</b> Simplistic straight line fit to the ROC curve</a></li>
<li class="chapter" data-level="6.14.3" data-path="binormal-model.html"><a href="binormal-model.html#maximum-likelihood-estimation-mle"><i class="fa fa-check"></i><b>6.14.3</b> Maximum likelihood estimation (MLE)</a></li>
<li class="chapter" data-level="6.14.4" data-path="binormal-model.html"><a href="binormal-model.html#code-implementing-mle"><i class="fa fa-check"></i><b>6.14.4</b> Code implementing MLE</a></li>
</ul></li>
<li class="chapter" data-level="6.15" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-curve-fitting-validation-appendix-5"><i class="fa fa-check"></i><b>6.15</b> Appendix V: Validating fitting model</a><ul>
<li class="chapter" data-level="6.15.1" data-path="binormal-model.html"><a href="binormal-model.html#estimating-the-covariance-matrix"><i class="fa fa-check"></i><b>6.15.1</b> Estimating the covariance matrix</a></li>
<li class="chapter" data-level="6.15.2" data-path="binormal-model.html"><a href="binormal-model.html#estimating-the-variance-of-az"><i class="fa fa-check"></i><b>6.15.2</b> Estimating the variance of Az</a></li>
</ul></li>
<li class="chapter" data-level="6.16" data-path="binormal-model.html"><a href="binormal-model.html#binormal-model-references"><i class="fa fa-check"></i><b>6.16</b> References</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="sources-of-variability.html"><a href="sources-of-variability.html"><i class="fa fa-check"></i><b>7</b> Sources of AUC variability</a><ul>
<li class="chapter" data-level="7.1" data-path="sources-of-variability.html"><a href="sources-of-variability.html#sources-of-variability-how-much-finished"><i class="fa fa-check"></i><b>7.1</b> TBA How much finished</a></li>
<li class="chapter" data-level="7.2" data-path="sources-of-variability.html"><a href="sources-of-variability.html#sources-of-variabilityIntro"><i class="fa fa-check"></i><b>7.2</b> Introduction</a></li>
<li class="chapter" data-level="7.3" data-path="sources-of-variability.html"><a href="sources-of-variability.html#sources-of-variability3sources"><i class="fa fa-check"></i><b>7.3</b> Three sources of variability</a></li>
<li class="chapter" data-level="7.4" data-path="sources-of-variability.html"><a href="sources-of-variability.html#dependence-of-auc-on-the-case-sample"><i class="fa fa-check"></i><b>7.4</b> Dependence of AUC on the case sample</a><ul>
<li class="chapter" data-level="7.4.1" data-path="sources-of-variability.html"><a href="sources-of-variability.html#case-sampling-variability-of-auc"><i class="fa fa-check"></i><b>7.4.1</b> Case sampling variability of AUC</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="sources-of-variability.html"><a href="sources-of-variability.html#sources-of-variabilityDeLong"><i class="fa fa-check"></i><b>7.5</b> DeLong method</a></li>
<li class="chapter" data-level="7.6" data-path="sources-of-variability.html"><a href="sources-of-variability.html#sources-of-variabilityBootstrap"><i class="fa fa-check"></i><b>7.6</b> Bootstrap method</a><ul>
<li class="chapter" data-level="7.6.1" data-path="sources-of-variability.html"><a href="sources-of-variability.html#demonstration-of-the-bootstrap-method"><i class="fa fa-check"></i><b>7.6.1</b> Demonstration of the bootstrap method</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="sources-of-variability.html"><a href="sources-of-variability.html#sources-of-variabilityJackknife"><i class="fa fa-check"></i><b>7.7</b> Jackknife method</a></li>
<li class="chapter" data-level="7.8" data-path="sources-of-variability.html"><a href="sources-of-variability.html#sources-of-variabilityCalSimulator"><i class="fa fa-check"></i><b>7.8</b> Calibrated simulator</a><ul>
<li class="chapter" data-level="7.8.1" data-path="sources-of-variability.html"><a href="sources-of-variability.html#the-need-for-a-calibrated-simulator"><i class="fa fa-check"></i><b>7.8.1</b> The need for a calibrated simulator</a></li>
<li class="chapter" data-level="7.8.2" data-path="sources-of-variability.html"><a href="sources-of-variability.html#implementation-of-a-simple-calibrated-simulator"><i class="fa fa-check"></i><b>7.8.2</b> Implementation of a simple calibrated simulator</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="sources-of-variability.html"><a href="sources-of-variability.html#sources-of-variability-Discussion"><i class="fa fa-check"></i><b>7.9</b> Discussion</a></li>
<li class="chapter" data-level="7.10" data-path="sources-of-variability.html"><a href="sources-of-variability.html#sources-of-variability-references"><i class="fa fa-check"></i><b>7.10</b> References</a></li>
</ul></li>
<li class="part"><span><b>Significance Testing</b></span></li>
<li class="chapter" data-level="8" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html"><i class="fa fa-check"></i><b>8</b> Hypothesis Testing</a><ul>
<li class="chapter" data-level="8.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#hypothesis-testing-how-much-finished"><i class="fa fa-check"></i><b>8.1</b> TBA How much finished</a></li>
<li class="chapter" data-level="8.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#hypothesis-testing-introduction"><i class="fa fa-check"></i><b>8.2</b> Introduction</a></li>
<li class="chapter" data-level="8.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#single-modality-single-reader-roc-study"><i class="fa fa-check"></i><b>8.3</b> Single-modality single-reader ROC study</a></li>
<li class="chapter" data-level="8.4" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#type-i-errors"><i class="fa fa-check"></i><b>8.4</b> Type-I errors</a></li>
<li class="chapter" data-level="8.5" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#one-vs.-two-sided-tests"><i class="fa fa-check"></i><b>8.5</b> One vs. two sided tests</a></li>
<li class="chapter" data-level="8.6" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#statistical-power"><i class="fa fa-check"></i><b>8.6</b> Statistical power</a><ul>
<li class="chapter" data-level="8.6.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#factors-affecting-statistical-power"><i class="fa fa-check"></i><b>8.6.1</b> Factors affecting statistical power</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#hypothesis-testingComments"><i class="fa fa-check"></i><b>8.7</b> Comments</a></li>
<li class="chapter" data-level="8.8" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#why-alpha-is-chosen-as-5"><i class="fa fa-check"></i><b>8.8</b> Why alpha is chosen as 5%</a></li>
<li class="chapter" data-level="8.9" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#hypothesis-testingDiscussion"><i class="fa fa-check"></i><b>8.9</b> Discussion</a></li>
<li class="chapter" data-level="8.10" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#hypothesis-testing-references"><i class="fa fa-check"></i><b>8.10</b> References</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="dbm-analysis-background.html"><a href="dbm-analysis-background.html"><i class="fa fa-check"></i><b>9</b> DBM method background</a><ul>
<li class="chapter" data-level="9.1" data-path="dbm-analysis-background.html"><a href="dbm-analysis-background.html#dbm-analysis-background-how-much-finished"><i class="fa fa-check"></i><b>9.1</b> TBA How much finished</a></li>
<li class="chapter" data-level="9.2" data-path="dbm-analysis-background.html"><a href="dbm-analysis-background.html#dbm-analysis-background-introduction"><i class="fa fa-check"></i><b>9.2</b> Introduction</a><ul>
<li class="chapter" data-level="9.2.1" data-path="dbm-analysis-background.html"><a href="dbm-analysis-background.html#historical-background"><i class="fa fa-check"></i><b>9.2.1</b> Historical background</a></li>
<li class="chapter" data-level="9.2.2" data-path="dbm-analysis-background.html"><a href="dbm-analysis-background.html#the-wagner-analogy"><i class="fa fa-check"></i><b>9.2.2</b> The Wagner analogy</a></li>
<li class="chapter" data-level="9.2.3" data-path="dbm-analysis-background.html"><a href="dbm-analysis-background.html#the-shortage-of-numbers-to-analyze-and-a-pivotal-breakthrough"><i class="fa fa-check"></i><b>9.2.3</b> The shortage of numbers to analyze and a pivotal breakthrough</a></li>
<li class="chapter" data-level="9.2.4" data-path="dbm-analysis-background.html"><a href="dbm-analysis-background.html#organization-of-chapter"><i class="fa fa-check"></i><b>9.2.4</b> Organization of chapter</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="dbm-analysis-background.html"><a href="dbm-analysis-background.html#dbm-analysis-background-random-fixed-factors"><i class="fa fa-check"></i><b>9.3</b> Random and fixed factors</a></li>
<li class="chapter" data-level="9.4" data-path="dbm-analysis-background.html"><a href="dbm-analysis-background.html#dbm-analysis-background-reader-case-populations"><i class="fa fa-check"></i><b>9.4</b> Reader and case populations</a></li>
<li class="chapter" data-level="9.5" data-path="dbm-analysis-background.html"><a href="dbm-analysis-background.html#dbm-analysis-background-threeAnalyses"><i class="fa fa-check"></i><b>9.5</b> Three types of analyses</a></li>
<li class="chapter" data-level="9.6" data-path="dbm-analysis-background.html"><a href="dbm-analysis-background.html#dbm-analysis-background-approach"><i class="fa fa-check"></i><b>9.6</b> General approach</a></li>
<li class="chapter" data-level="9.7" data-path="dbm-analysis-background.html"><a href="dbm-analysis-background.html#dbm-analysis-background-summary"><i class="fa fa-check"></i><b>9.7</b> Summary TBA</a></li>
<li class="chapter" data-level="9.8" data-path="dbm-analysis-background.html"><a href="dbm-analysis-background.html#dbm-analysis-background-references"><i class="fa fa-check"></i><b>9.8</b> References</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="dbm-analysis-significance-testing.html"><a href="dbm-analysis-significance-testing.html"><i class="fa fa-check"></i><b>10</b> Significance Testing using the DBM Method</a><ul>
<li class="chapter" data-level="10.1" data-path="dbm-analysis-significance-testing.html"><a href="dbm-analysis-significance-testing.html#dbm-analysis-significance-testing-how-much-finished"><i class="fa fa-check"></i><b>10.1</b> TBA How much finished</a></li>
<li class="chapter" data-level="10.2" data-path="dbm-analysis-significance-testing.html"><a href="dbm-analysis-significance-testing.html#the-dbm-sampling-model"><i class="fa fa-check"></i><b>10.2</b> The DBM sampling model</a><ul>
<li class="chapter" data-level="10.2.1" data-path="dbm-analysis-significance-testing.html"><a href="dbm-analysis-significance-testing.html#explanation-of-terms-in-the-model"><i class="fa fa-check"></i><b>10.2.1</b> Explanation of terms in the model</a></li>
<li class="chapter" data-level="10.2.2" data-path="dbm-analysis-significance-testing.html"><a href="dbm-analysis-significance-testing.html#meanings-of-variance-components-in-the-dbm-model-tba-this-section-can-be-improved"><i class="fa fa-check"></i><b>10.2.2</b> Meanings of variance components in the DBM model (<strong>TBA this section can be improved</strong>)</a></li>
<li class="chapter" data-level="10.2.3" data-path="dbm-analysis-significance-testing.html"><a href="dbm-analysis-significance-testing.html#definitions-of-mean-squares"><i class="fa fa-check"></i><b>10.2.3</b> Definitions of mean-squares</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="dbm-analysis-significance-testing.html"><a href="dbm-analysis-significance-testing.html#expected-values-of-mean-squares"><i class="fa fa-check"></i><b>10.3</b> Expected values of mean squares</a></li>
<li class="chapter" data-level="10.4" data-path="dbm-analysis-significance-testing.html"><a href="dbm-analysis-significance-testing.html#dbm-analysis-significance-testing-RRRC-analysis"><i class="fa fa-check"></i><b>10.4</b> Random-reader random-case (RRRC) analysis</a><ul>
<li class="chapter" data-level="10.4.1" data-path="dbm-analysis-significance-testing.html"><a href="dbm-analysis-significance-testing.html#calculation-of-mean-squares-an-example"><i class="fa fa-check"></i><b>10.4.1</b> Calculation of mean squares: an example</a></li>
<li class="chapter" data-level="10.4.2" data-path="dbm-analysis-significance-testing.html"><a href="dbm-analysis-significance-testing.html#dbm-analysis-significance-testing-sig-testing"><i class="fa fa-check"></i><b>10.4.2</b> Significance testing</a></li>
<li class="chapter" data-level="10.4.3" data-path="dbm-analysis-significance-testing.html"><a href="dbm-analysis-significance-testing.html#the-satterthwaite-approximation"><i class="fa fa-check"></i><b>10.4.3</b> The Satterthwaite approximation</a></li>
<li class="chapter" data-level="10.4.4" data-path="dbm-analysis-significance-testing.html"><a href="dbm-analysis-significance-testing.html#decision-rules-p-value-and-confidence-intervals"><i class="fa fa-check"></i><b>10.4.4</b> Decision rules, p-value and confidence intervals</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="dbm-analysis-significance-testing.html"><a href="dbm-analysis-significance-testing.html#sample-size-estimation-for-random-reader-random-case-generalization"><i class="fa fa-check"></i><b>10.5</b> Sample size estimation for random-reader random-case generalization</a><ul>
<li class="chapter" data-level="10.5.1" data-path="dbm-analysis-significance-testing.html"><a href="dbm-analysis-significance-testing.html#the-non-centrality-parameter"><i class="fa fa-check"></i><b>10.5.1</b> The non-centrality parameter</a></li>
<li class="chapter" data-level="10.5.2" data-path="dbm-analysis-significance-testing.html"><a href="dbm-analysis-significance-testing.html#the-denominator-degrees-of-freedom"><i class="fa fa-check"></i><b>10.5.2</b> The denominator degrees of freedom</a></li>
<li class="chapter" data-level="10.5.3" data-path="dbm-analysis-significance-testing.html"><a href="dbm-analysis-significance-testing.html#example-of-sample-size-estimation-rrrc-generalization"><i class="fa fa-check"></i><b>10.5.3</b> Example of sample size estimation, RRRC generalization</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="dbm-analysis-significance-testing.html"><a href="dbm-analysis-significance-testing.html#significance-testing-and-sample-size-estimation-for-fixed-reader-random-case-generalization"><i class="fa fa-check"></i><b>10.6</b> Significance testing and sample size estimation for fixed-reader random-case generalization</a></li>
<li class="chapter" data-level="10.7" data-path="dbm-analysis-significance-testing.html"><a href="dbm-analysis-significance-testing.html#significance-testing-and-sample-size-estimation-for-random-reader-fixed-case-generalization"><i class="fa fa-check"></i><b>10.7</b> Significance testing and sample size estimation for random-reader fixed-case generalization</a></li>
<li class="chapter" data-level="10.8" data-path="dbm-analysis-significance-testing.html"><a href="dbm-analysis-significance-testing.html#dbm-analysis-significance-testing-summary"><i class="fa fa-check"></i><b>10.8</b> Summary TBA</a></li>
<li class="chapter" data-level="10.9" data-path="dbm-analysis-significance-testing.html"><a href="dbm-analysis-significance-testing.html#things-for-me-to-think-about"><i class="fa fa-check"></i><b>10.9</b> Things for me to think about</a><ul>
<li class="chapter" data-level="10.9.1" data-path="dbm-analysis-significance-testing.html"><a href="dbm-analysis-significance-testing.html#expected-values-of-mean-squares-1"><i class="fa fa-check"></i><b>10.9.1</b> Expected values of mean squares</a></li>
</ul></li>
<li class="chapter" data-level="10.10" data-path="dbm-analysis-significance-testing.html"><a href="dbm-analysis-significance-testing.html#dbm-analysis-significance-testing-references"><i class="fa fa-check"></i><b>10.10</b> References</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="dbm-analysis-special-cases.html"><a href="dbm-analysis-special-cases.html"><i class="fa fa-check"></i><b>11</b> DBM method special cases</a><ul>
<li class="chapter" data-level="11.1" data-path="dbm-analysis-special-cases.html"><a href="dbm-analysis-special-cases.html#dbm-analysis-special-cases-fits-how-much-finished"><i class="fa fa-check"></i><b>11.1</b> TBA How much finished</a></li>
<li class="chapter" data-level="11.2" data-path="dbm-analysis-special-cases.html"><a href="dbm-analysis-special-cases.html#FRRCDBMAnalysis"><i class="fa fa-check"></i><b>11.2</b> Fixed-reader random-case (FRRC) analysis</a><ul>
<li class="chapter" data-level="11.2.1" data-path="dbm-analysis-special-cases.html"><a href="dbm-analysis-special-cases.html#FRRCSingleReaderDBMAnalysis"><i class="fa fa-check"></i><b>11.2.1</b> Single-reader multiple-treatment analysis</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="dbm-analysis-special-cases.html"><a href="dbm-analysis-special-cases.html#dbm-analysis-special-cases-RRFCAnalysis"><i class="fa fa-check"></i><b>11.3</b> Random-reader fixed-case (RRFC) analysis</a></li>
<li class="chapter" data-level="11.4" data-path="dbm-analysis-special-cases.html"><a href="dbm-analysis-special-cases.html#dbm-analysis-special-cases-references"><i class="fa fa-check"></i><b>11.4</b> References</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="or-method-intro.html"><a href="or-method-intro.html"><i class="fa fa-check"></i><b>12</b> Introduction to the Obuchowski-Rockette method</a><ul>
<li class="chapter" data-level="12.1" data-path="or-method-intro.html"><a href="or-method-intro.html#or-method-intro-how-much-finished"><i class="fa fa-check"></i><b>12.1</b> TBA How much finished</a></li>
<li class="chapter" data-level="12.2" data-path="or-method-intro.html"><a href="or-method-intro.html#or-method-intro-helper-functions"><i class="fa fa-check"></i><b>12.2</b> Locations of helper functions</a></li>
<li class="chapter" data-level="12.3" data-path="or-method-intro.html"><a href="or-method-intro.html#or-method-intro-intro"><i class="fa fa-check"></i><b>12.3</b> Introduction</a></li>
<li class="chapter" data-level="12.4" data-path="or-method-intro.html"><a href="or-method-intro.html#or-method-intro-single-reader"><i class="fa fa-check"></i><b>12.4</b> Single-reader multiple-treatment</a><ul>
<li class="chapter" data-level="12.4.1" data-path="or-method-intro.html"><a href="or-method-intro.html#or-method-intro-single-reader-overview"><i class="fa fa-check"></i><b>12.4.1</b> Overview</a></li>
<li class="chapter" data-level="12.4.2" data-path="or-method-intro.html"><a href="or-method-intro.html#st-or-multiple-treatment"><i class="fa fa-check"></i><b>12.4.2</b> Significance testing</a></li>
<li class="chapter" data-level="12.4.3" data-path="or-method-intro.html"><a href="or-method-intro.html#or-method-intro-pvalue-ci"><i class="fa fa-check"></i><b>12.4.3</b> p-value and confidence interval</a></li>
<li class="chapter" data-level="12.4.4" data-path="or-method-intro.html"><a href="or-method-intro.html#or-method-intro-single-reader-nh-validation"><i class="fa fa-check"></i><b>12.4.4</b> Null hypothesis validation</a></li>
<li class="chapter" data-level="12.4.5" data-path="or-method-intro.html"><a href="or-method-intro.html#or-method-intro-single-reader-application-roc"><i class="fa fa-check"></i><b>12.4.5</b> Application 1</a></li>
<li class="chapter" data-level="12.4.6" data-path="or-method-intro.html"><a href="or-method-intro.html#or-method-intro-single-reader-application-froc"><i class="fa fa-check"></i><b>12.4.6</b> Application 2</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="or-method-intro.html"><a href="or-method-intro.html#or-method-intro-single-treatment"><i class="fa fa-check"></i><b>12.5</b> Single-treatment multiple-reader</a><ul>
<li class="chapter" data-level="12.5.1" data-path="or-method-intro.html"><a href="or-method-intro.html#or-method-intro-single-treatment-overview"><i class="fa fa-check"></i><b>12.5.1</b> Overview</a></li>
<li class="chapter" data-level="12.5.2" data-path="or-method-intro.html"><a href="or-method-intro.html#st-or-multiple-reader"><i class="fa fa-check"></i><b>12.5.2</b> Significance testing</a></li>
<li class="chapter" data-level="12.5.3" data-path="or-method-intro.html"><a href="or-method-intro.html#st-or-multiple-reader-example-three"><i class="fa fa-check"></i><b>12.5.3</b> Special case</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="or-method-intro.html"><a href="or-method-intro.html#or-method-intro-multiple-reader-multiple-treatment"><i class="fa fa-check"></i><b>12.6</b> Multiple-reader multiple-treatment</a><ul>
<li class="chapter" data-level="12.6.1" data-path="or-method-intro.html"><a href="or-method-intro.html#StrCovMatrix"><i class="fa fa-check"></i><b>12.6.1</b> Structure of the covariance matrix</a></li>
<li class="chapter" data-level="12.6.2" data-path="or-method-intro.html"><a href="or-method-intro.html#PhysicalMeaningsOfCovMatrix"><i class="fa fa-check"></i><b>12.6.2</b> Physical meanings of the covariance terms</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="or-method-intro.html"><a href="or-method-intro.html#or-method-intro-summary"><i class="fa fa-check"></i><b>12.7</b> Summary</a></li>
<li class="chapter" data-level="12.8" data-path="or-method-intro.html"><a href="or-method-intro.html#or-method-intro-discussion"><i class="fa fa-check"></i><b>12.8</b> Discussion</a></li>
<li class="chapter" data-level="12.9" data-path="or-method-intro.html"><a href="or-method-intro.html#or-method-intro-elementary-stats"><i class="fa fa-check"></i><b>12.9</b> Appendix: Covariance and correlation</a><ul>
<li class="chapter" data-level="12.9.1" data-path="or-method-intro.html"><a href="or-method-intro.html#or-method-intro-elementary-stats-f-stat-chisq-stat"><i class="fa fa-check"></i><b>12.9.1</b> Relation: chisquare and F with infinite ddf</a></li>
<li class="chapter" data-level="12.9.2" data-path="or-method-intro.html"><a href="or-method-intro.html#or-method-intro-elementary-stats-def-cov-matrix"><i class="fa fa-check"></i><b>12.9.2</b> Definitions of covariance and correlation</a></li>
<li class="chapter" data-level="12.9.3" data-path="or-method-intro.html"><a href="or-method-intro.html#or-method-intro-elementary-stats-equal-variance"><i class="fa fa-check"></i><b>12.9.3</b> Special case when variables have equal variances</a></li>
<li class="chapter" data-level="12.9.4" data-path="or-method-intro.html"><a href="or-method-intro.html#or-method-intro-elementary-stats-est-cov-matrix"><i class="fa fa-check"></i><b>12.9.4</b> Estimating the variance-covariance matrix</a></li>
<li class="chapter" data-level="12.9.5" data-path="or-method-intro.html"><a href="or-method-intro.html#or-method-intro-elementary-stats-jack-var-inflation-factor"><i class="fa fa-check"></i><b>12.9.5</b> The variance inflation factor</a></li>
<li class="chapter" data-level="12.9.6" data-path="or-method-intro.html"><a href="or-method-intro.html#or-method-intro-elementary-stats-meaning-cov-matrix"><i class="fa fa-check"></i><b>12.9.6</b> Meaning of the covariance matrix</a></li>
<li class="chapter" data-level="12.9.7" data-path="or-method-intro.html"><a href="or-method-intro.html#or-method-intro-elementary-stats-code-cov-matrix"><i class="fa fa-check"></i><b>12.9.7</b> Code illustrating the covariance matrix</a></li>
<li class="chapter" data-level="12.9.8" data-path="or-method-intro.html"><a href="or-method-intro.html#or-method-intro-compare-dbm-or"><i class="fa fa-check"></i><b>12.9.8</b> Comparing DBM to Obuchowski and Rockette for single-reader multiple-treatments</a></li>
</ul></li>
<li class="chapter" data-level="12.10" data-path="or-method-intro.html"><a href="or-method-intro.html#or-method-intro-references"><i class="fa fa-check"></i><b>12.10</b> References</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="or-analysis-st.html"><a href="or-analysis-st.html"><i class="fa fa-check"></i><b>13</b> Obuchowski Rockette (OR) Analysis</a><ul>
<li class="chapter" data-level="13.1" data-path="or-analysis-st.html"><a href="or-analysis-st.html#or-analysis-st-how-much-finished"><i class="fa fa-check"></i><b>13.1</b> TBA How much finished</a></li>
<li class="chapter" data-level="13.2" data-path="or-analysis-st.html"><a href="or-analysis-st.html#or-analysis-st-introduction"><i class="fa fa-check"></i><b>13.2</b> Introduction</a></li>
<li class="chapter" data-level="13.3" data-path="or-analysis-st.html"><a href="or-analysis-st.html#or-analysis-st-rrrc"><i class="fa fa-check"></i><b>13.3</b> Random-reader random-case</a><ul>
<li class="chapter" data-level="13.3.1" data-path="or-analysis-st.html"><a href="or-analysis-st.html#TwoAnecdotes"><i class="fa fa-check"></i><b>13.3.1</b> Two anecdotes</a></li>
<li class="chapter" data-level="13.3.2" data-path="or-analysis-st.html"><a href="or-analysis-st.html#Hills-ddf"><i class="fa fa-check"></i><b>13.3.2</b> Hillis ddf</a></li>
<li class="chapter" data-level="13.3.3" data-path="or-analysis-st.html"><a href="or-analysis-st.html#decision-rule-p-value-and-confidence-interval"><i class="fa fa-check"></i><b>13.3.3</b> Decision rule, p-value and confidence interval</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="or-analysis-st.html"><a href="or-analysis-st.html#or-analysis-st-frrc"><i class="fa fa-check"></i><b>13.4</b> Fixed-reader random-case</a></li>
<li class="chapter" data-level="13.5" data-path="or-analysis-st.html"><a href="or-analysis-st.html#or-analysis-st-rrfc"><i class="fa fa-check"></i><b>13.5</b> Random-reader fixed-case</a></li>
<li class="chapter" data-level="13.6" data-path="or-analysis-st.html"><a href="or-analysis-st.html#or-analysis-st-single-treatment"><i class="fa fa-check"></i><b>13.6</b> Single treatment analysis</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="or-applications.html"><a href="or-applications.html"><i class="fa fa-check"></i><b>14</b> Obuchowski Rockette Applications</a><ul>
<li class="chapter" data-level="14.1" data-path="or-applications.html"><a href="or-applications.html#or-applications-how-much-finished"><i class="fa fa-check"></i><b>14.1</b> TBA How much finished</a></li>
<li class="chapter" data-level="14.2" data-path="or-applications.html"><a href="or-applications.html#or-applications-introduction"><i class="fa fa-check"></i><b>14.2</b> Introduction</a></li>
<li class="chapter" data-level="14.3" data-path="or-applications.html"><a href="or-applications.html#or-applications-dataset02-hand"><i class="fa fa-check"></i><b>14.3</b> Hand calculation</a><ul>
<li class="chapter" data-level="14.3.1" data-path="or-applications.html"><a href="or-applications.html#or-applications-RRRC-dataset02-hand"><i class="fa fa-check"></i><b>14.3.1</b> Random-Reader Random-Case (RRRC) analysis</a></li>
<li class="chapter" data-level="14.3.2" data-path="or-applications.html"><a href="or-applications.html#or-applications-FRRC-dataset02-hand"><i class="fa fa-check"></i><b>14.3.2</b> Fixed-Reader Random-Case (FRRC) analysis</a></li>
<li class="chapter" data-level="14.3.3" data-path="or-applications.html"><a href="or-applications.html#or-applications-RRFC-dataset02-hand"><i class="fa fa-check"></i><b>14.3.3</b> Random-Reader Fixed-Case (RRFC) analysis</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="or-applications.html"><a href="or-applications.html#or-applications-dataset02-RJafroc"><i class="fa fa-check"></i><b>14.4</b> RJafroc: dataset02</a><ul>
<li class="chapter" data-level="14.4.1" data-path="or-applications.html"><a href="or-applications.html#or-applications-RRRC-dataset02-RJafroc"><i class="fa fa-check"></i><b>14.4.1</b> Random-Reader Random-Case (RRRC) analysis</a></li>
<li class="chapter" data-level="14.4.2" data-path="or-applications.html"><a href="or-applications.html#or-applications-FRRC-dataset02-RJafroc"><i class="fa fa-check"></i><b>14.4.2</b> Fixed-Reader Random-Case (FRRC) analysis</a></li>
<li class="chapter" data-level="14.4.3" data-path="or-applications.html"><a href="or-applications.html#or-applications-RRFC-dataset02-RJafroc"><i class="fa fa-check"></i><b>14.4.3</b> Random-Reader Fixed-Case (RRFC) analysis</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="or-applications.html"><a href="or-applications.html#or-applications-dataset04-RJafroc"><i class="fa fa-check"></i><b>14.5</b> RJafroc: dataset04</a><ul>
<li class="chapter" data-level="14.5.1" data-path="or-applications.html"><a href="or-applications.html#or-applications-RRRC-dataset04"><i class="fa fa-check"></i><b>14.5.1</b> Random-Reader Random-Case (RRRC) analysis</a></li>
<li class="chapter" data-level="14.5.2" data-path="or-applications.html"><a href="or-applications.html#or-applications-FRRC-dataset04"><i class="fa fa-check"></i><b>14.5.2</b> Fixed-Reader Random-Case (FRRC) analysis</a></li>
<li class="chapter" data-level="14.5.3" data-path="or-applications.html"><a href="or-applications.html#or-applications-RRFC-dataset04"><i class="fa fa-check"></i><b>14.5.3</b> Random-Reader Fixed-Case (RRFC) analysis</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="or-applications.html"><a href="or-applications.html#or-applications-dataset04-FROC-RJafroc"><i class="fa fa-check"></i><b>14.6</b> RJafroc: dataset04, FROC</a><ul>
<li class="chapter" data-level="14.6.1" data-path="or-applications.html"><a href="or-applications.html#or-applications-RRRC-dataset04-FROC"><i class="fa fa-check"></i><b>14.6.1</b> Random-Reader Random-Case (RRRC) analysis</a></li>
<li class="chapter" data-level="14.6.2" data-path="or-applications.html"><a href="or-applications.html#or-applications-FRRC-dataset04-FROC"><i class="fa fa-check"></i><b>14.6.2</b> Fixed-Reader Random-Case (FRRC) analysis</a></li>
<li class="chapter" data-level="14.6.3" data-path="or-applications.html"><a href="or-applications.html#or-applications-RRFC-dataset04-FROC"><i class="fa fa-check"></i><b>14.6.3</b> Random-Reader Fixed-Case (RRFC) analysis</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="or-applications.html"><a href="or-applications.html#or-applications-dataset04-FROC-DBM-RJafroc"><i class="fa fa-check"></i><b>14.7</b> RJafroc: dataset04, FROC/DBM</a><ul>
<li class="chapter" data-level="14.7.1" data-path="or-applications.html"><a href="or-applications.html#or-applications-RRRC-dataset04-FROC-DBM"><i class="fa fa-check"></i><b>14.7.1</b> Random-Reader Random-Case (RRRC) analysis</a></li>
<li class="chapter" data-level="14.7.2" data-path="or-applications.html"><a href="or-applications.html#or-applications-FRRC-dataset04-FROC-DBM"><i class="fa fa-check"></i><b>14.7.2</b> Fixed-Reader Random-Case (FRRC) analysis</a></li>
<li class="chapter" data-level="14.7.3" data-path="or-applications.html"><a href="or-applications.html#or-applications-RRFC-dataset04-FROC-DBM"><i class="fa fa-check"></i><b>14.7.3</b> Random-Reader Fixed-Case (RRFC) analysis</a></li>
</ul></li>
<li class="chapter" data-level="14.8" data-path="or-applications.html"><a href="or-applications.html#or-applications-Summary"><i class="fa fa-check"></i><b>14.8</b> Summary</a></li>
<li class="chapter" data-level="14.9" data-path="or-applications.html"><a href="or-applications.html#or-applications-Discussion"><i class="fa fa-check"></i><b>14.9</b> Discussion</a></li>
<li class="chapter" data-level="14.10" data-path="or-applications.html"><a href="or-applications.html#ToMullOver1-tentative"><i class="fa fa-check"></i><b>14.10</b> Tentative</a></li>
<li class="chapter" data-level="14.11" data-path="or-applications.html"><a href="or-applications.html#or-applications-references"><i class="fa fa-check"></i><b>14.11</b> References</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="roc-sample-size-dbm.html"><a href="roc-sample-size-dbm.html"><i class="fa fa-check"></i><b>15</b> Sample size estimation for ROC studies DBM method</a><ul>
<li class="chapter" data-level="15.1" data-path="roc-sample-size-dbm.html"><a href="roc-sample-size-dbm.html#roc-sample-size-dbm-how-much-finished"><i class="fa fa-check"></i><b>15.1</b> TBA How much finished</a></li>
<li class="chapter" data-level="15.2" data-path="roc-sample-size-dbm.html"><a href="roc-sample-size-dbm.html#roc-sample-size-dbm-introduction"><i class="fa fa-check"></i><b>15.2</b> Introduction</a></li>
<li class="chapter" data-level="15.3" data-path="roc-sample-size-dbm.html"><a href="roc-sample-size-dbm.html#StatPower1"><i class="fa fa-check"></i><b>15.3</b> Statistical Power</a><ul>
<li class="chapter" data-level="15.3.1" data-path="roc-sample-size-dbm.html"><a href="roc-sample-size-dbm.html#observed-vs.-anticipated-effect-size"><i class="fa fa-check"></i><b>15.3.1</b> Observed vs. anticipated effect-size</a></li>
<li class="chapter" data-level="15.3.2" data-path="roc-sample-size-dbm.html"><a href="roc-sample-size-dbm.html#roc-sample-size-dbm-dependence-of-stats-power"><i class="fa fa-check"></i><b>15.3.2</b> Dependence of statistical power on estimates of model parameters</a></li>
<li class="chapter" data-level="15.3.3" data-path="roc-sample-size-dbm.html"><a href="roc-sample-size-dbm.html#roc-sample-size-dbm-RRRC-sample-size-estimation"><i class="fa fa-check"></i><b>15.3.3</b> Formulae for random-reader random-case (RRRC) sample size estimation</a></li>
<li class="chapter" data-level="15.3.4" data-path="roc-sample-size-dbm.html"><a href="roc-sample-size-dbm.html#roc-sample-size-dbm-sig-testing"><i class="fa fa-check"></i><b>15.3.4</b> Significance testing</a></li>
<li class="chapter" data-level="15.3.5" data-path="roc-sample-size-dbm.html"><a href="roc-sample-size-dbm.html#roc-sample-size-dbm-pvalue-ci"><i class="fa fa-check"></i><b>15.3.5</b> p-value and confidence interval</a></li>
<li class="chapter" data-level="15.3.6" data-path="roc-sample-size-dbm.html"><a href="roc-sample-size-dbm.html#roc-sample-size-dbm-CompareDBM2OR"><i class="fa fa-check"></i><b>15.3.6</b> Comparing DBM to Obuchowski and Rockette for single-reader multiple-treatments</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="roc-sample-size-dbm.html"><a href="roc-sample-size-dbm.html#roc-sample-size-dbm-FRRC-sample-size-estimation"><i class="fa fa-check"></i><b>15.4</b> Formulae for fixed-reader random-case (FRRC) sample size estimation</a><ul>
<li class="chapter" data-level="15.4.1" data-path="roc-sample-size-dbm.html"><a href="roc-sample-size-dbm.html#roc-sample-size-dbm-RRFC-sample-size-estimation"><i class="fa fa-check"></i><b>15.4.1</b> Formulae for random-reader fixed-case (RRFC) sample size estimation</a></li>
<li class="chapter" data-level="15.4.2" data-path="roc-sample-size-dbm.html"><a href="roc-sample-size-dbm.html#roc-sample-size-dbm-FRRCAnalysis"><i class="fa fa-check"></i><b>15.4.2</b> Fixed-reader random-case (FRRC) analysis TBA</a></li>
<li class="chapter" data-level="15.4.3" data-path="roc-sample-size-dbm.html"><a href="roc-sample-size-dbm.html#roc-sample-size-dbm-RRFCAnalysis"><i class="fa fa-check"></i><b>15.4.3</b> Random-reader fixed-case (RRFC) analysis</a></li>
<li class="chapter" data-level="15.4.4" data-path="roc-sample-size-dbm.html"><a href="roc-sample-size-dbm.html#roc-sample-size-dbm-STMRAnalysis"><i class="fa fa-check"></i><b>15.4.4</b> Single-treatment multiple-reader analysis</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="roc-sample-size-dbm.html"><a href="roc-sample-size-dbm.html#discussionsummary2"><i class="fa fa-check"></i><b>15.5</b> Discussion/Summary/2</a></li>
<li class="chapter" data-level="15.6" data-path="roc-sample-size-dbm.html"><a href="roc-sample-size-dbm.html#roc-sample-size-dbm-references"><i class="fa fa-check"></i><b>15.6</b> References</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="roc-sample-size-or.html"><a href="roc-sample-size-or.html"><i class="fa fa-check"></i><b>16</b> Sample size estimation for ROC studies OR method</a><ul>
<li class="chapter" data-level="16.1" data-path="roc-sample-size-or.html"><a href="roc-sample-size-or.html#roc-sample-size-or-how-much-finished"><i class="fa fa-check"></i><b>16.1</b> TBA How much finished</a></li>
<li class="chapter" data-level="16.2" data-path="roc-sample-size-or.html"><a href="roc-sample-size-or.html#roc-sample-size-or-introduction"><i class="fa fa-check"></i><b>16.2</b> Introduction</a></li>
<li class="chapter" data-level="16.3" data-path="roc-sample-size-or.html"><a href="roc-sample-size-or.html#StatPower2"><i class="fa fa-check"></i><b>16.3</b> Statistical Power</a><ul>
<li class="chapter" data-level="16.3.1" data-path="roc-sample-size-or.html"><a href="roc-sample-size-or.html#sample-size-estimation-for-random-reader-random-cases"><i class="fa fa-check"></i><b>16.3.1</b> Sample size estimation for random-reader random-cases</a></li>
<li class="chapter" data-level="16.3.2" data-path="roc-sample-size-or.html"><a href="roc-sample-size-or.html#roc-sample-size-or-dependence-of-stats-power"><i class="fa fa-check"></i><b>16.3.2</b> Dependence of statistical power on estimates of model parameters</a></li>
<li class="chapter" data-level="16.3.3" data-path="roc-sample-size-or.html"><a href="roc-sample-size-or.html#roc-sample-size-or-RRRC-sample-size-estimation"><i class="fa fa-check"></i><b>16.3.3</b> Formulae for random-reader random-case (RRRC) sample size estimation</a></li>
<li class="chapter" data-level="16.3.4" data-path="roc-sample-size-or.html"><a href="roc-sample-size-or.html#roc-sample-size-or-sig-testing"><i class="fa fa-check"></i><b>16.3.4</b> Significance testing</a></li>
<li class="chapter" data-level="16.3.5" data-path="roc-sample-size-or.html"><a href="roc-sample-size-or.html#roc-sample-size-or-pvalue-ci"><i class="fa fa-check"></i><b>16.3.5</b> p-value and confidence interval</a></li>
<li class="chapter" data-level="16.3.6" data-path="roc-sample-size-or.html"><a href="roc-sample-size-or.html#roc-sample-size-or-CompareDBM2OR"><i class="fa fa-check"></i><b>16.3.6</b> Comparing DBM to Obuchowski and Rockette for single-reader multiple-treatments</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="roc-sample-size-or.html"><a href="roc-sample-size-or.html#roc-sample-size-or-FRRC-sample-size-estimation"><i class="fa fa-check"></i><b>16.4</b> Formulae for fixed-reader random-case (FRRC) sample size estimation</a><ul>
<li class="chapter" data-level="16.4.1" data-path="roc-sample-size-or.html"><a href="roc-sample-size-or.html#roc-sample-size-or-RRFC-sample-size-estimation"><i class="fa fa-check"></i><b>16.4.1</b> Formulae for random-reader fixed-case (RRFC) sample size estimation</a></li>
<li class="chapter" data-level="16.4.2" data-path="roc-sample-size-or.html"><a href="roc-sample-size-or.html#example-1"><i class="fa fa-check"></i><b>16.4.2</b> Example 1</a></li>
<li class="chapter" data-level="16.4.3" data-path="roc-sample-size-or.html"><a href="roc-sample-size-or.html#roc-sample-size-or-FRRCAnalysis"><i class="fa fa-check"></i><b>16.4.3</b> Fixed-reader random-case (FRRC) analysis</a></li>
<li class="chapter" data-level="16.4.4" data-path="roc-sample-size-or.html"><a href="roc-sample-size-or.html#roc-sample-size-or-RRFCAnalysis"><i class="fa fa-check"></i><b>16.4.4</b> Random-reader fixed-case (RRFC) analysis</a></li>
<li class="chapter" data-level="16.4.5" data-path="roc-sample-size-or.html"><a href="roc-sample-size-or.html#roc-sample-size-or-STMRAnalysis"><i class="fa fa-check"></i><b>16.4.5</b> Single-treatment multiple-reader analysis</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="roc-sample-size-or.html"><a href="roc-sample-size-or.html#discussionsummary3"><i class="fa fa-check"></i><b>16.5</b> Discussion/Summary/3</a></li>
<li class="chapter" data-level="16.6" data-path="roc-sample-size-or.html"><a href="roc-sample-size-or.html#roc-sample-size-or-references"><i class="fa fa-check"></i><b>16.6</b> References</a></li>
</ul></li>
<li class="part"><span><b>Advanced topics</b></span></li>
<li class="chapter" data-level="17" data-path="proper-roc-models.html"><a href="proper-roc-models.html"><i class="fa fa-check"></i><b>17</b> Proper ROC models</a><ul>
<li class="chapter" data-level="17.1" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-how-much-finished"><i class="fa fa-check"></i><b>17.1</b> TBA How much finished</a></li>
<li class="chapter" data-level="17.2" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-introduction"><i class="fa fa-check"></i><b>17.2</b> Introduction</a></li>
<li class="chapter" data-level="17.3" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-likelihood-ratio-theorem1"><i class="fa fa-check"></i><b>17.3</b> Theorem: ROC slope equals likelihood ratio</a></li>
<li class="chapter" data-level="17.4" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-likelihood-ratio-theorem2"><i class="fa fa-check"></i><b>17.4</b> Theorem: likelihood ratio observer maximizes AUC</a><ul>
<li class="chapter" data-level="17.4.1" data-path="proper-roc-models.html"><a href="proper-roc-models.html#explanation"><i class="fa fa-check"></i><b>17.4.1</b> Explanation</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-proper-vs-improper"><i class="fa fa-check"></i><b>17.5</b> Proper vs. improper ROC curves</a></li>
<li class="chapter" data-level="17.6" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-degenerate-datasets"><i class="fa fa-check"></i><b>17.6</b> Degenerate datasets</a><ul>
<li class="chapter" data-level="17.6.1" data-path="proper-roc-models.html"><a href="proper-roc-models.html#comments-on-degeneracy"><i class="fa fa-check"></i><b>17.6.1</b> Comments on degeneracy</a></li>
</ul></li>
<li class="chapter" data-level="17.7" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-likelihood-ratio-observer"><i class="fa fa-check"></i><b>17.7</b> The likelihood ratio observer</a></li>
<li class="chapter" data-level="17.8" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-proproc"><i class="fa fa-check"></i><b>17.8</b> PROPROC</a><ul>
<li class="chapter" data-level="17.8.1" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-proproc-formulae"><i class="fa fa-check"></i><b>17.8.1</b> PROPROC formulae</a></li>
<li class="chapter" data-level="17.8.2" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-proproc-code"><i class="fa fa-check"></i><b>17.8.2</b> PROPROC code implementation</a></li>
<li class="chapter" data-level="17.8.3" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-proproc-rocs"><i class="fa fa-check"></i><b>17.8.3</b> PROPROC ROC and slope plots</a></li>
</ul></li>
<li class="chapter" data-level="17.9" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-cbm"><i class="fa fa-check"></i><b>17.9</b> The contaminated binormal model (CBM)</a><ul>
<li class="chapter" data-level="17.9.1" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-cbm-formulae"><i class="fa fa-check"></i><b>17.9.1</b> CBM formulae</a></li>
<li class="chapter" data-level="17.9.2" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-cbm-code"><i class="fa fa-check"></i><b>17.9.2</b> CBM code implementation</a></li>
<li class="chapter" data-level="17.9.3" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-cbm-rocs"><i class="fa fa-check"></i><b>17.9.3</b> CBM ROC plots</a></li>
<li class="chapter" data-level="17.9.4" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-cbm-pdfs"><i class="fa fa-check"></i><b>17.9.4</b> CBM pdf plots</a></li>
<li class="chapter" data-level="17.9.5" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-cbm-slopes"><i class="fa fa-check"></i><b>17.9.5</b> CBM likelihood ratio plots</a></li>
</ul></li>
<li class="chapter" data-level="17.10" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-bigamma"><i class="fa fa-check"></i><b>17.10</b> The bigamma model (BGM)</a><ul>
<li class="chapter" data-level="17.10.1" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-bigamma-formulae"><i class="fa fa-check"></i><b>17.10.1</b> BGM formulae</a></li>
<li class="chapter" data-level="17.10.2" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-bigamma-code"><i class="fa fa-check"></i><b>17.10.2</b> BGM code implementation</a></li>
<li class="chapter" data-level="17.10.3" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-bigamma-rocs"><i class="fa fa-check"></i><b>17.10.3</b> BGM ROC plots</a></li>
<li class="chapter" data-level="17.10.4" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-bigamma-pdfs"><i class="fa fa-check"></i><b>17.10.4</b> BGM pdf plots</a></li>
<li class="chapter" data-level="17.10.5" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-bigamma-slopes"><i class="fa fa-check"></i><b>17.10.5</b> BGM likelihood ratio plots</a></li>
</ul></li>
<li class="chapter" data-level="17.11" data-path="proper-roc-models.html"><a href="proper-roc-models.html#proper-roc-models-discussion"><i class="fa fa-check"></i><b>17.11</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="proproc-rocs.html"><a href="proproc-rocs.html"><i class="fa fa-check"></i><b>18</b> PROPROC ROC curves</a><ul>
<li class="chapter" data-level="18.1" data-path="proproc-rocs.html"><a href="proproc-rocs.html#helper-functions"><i class="fa fa-check"></i><b>18.1</b> Helper functions</a></li>
<li class="chapter" data-level="18.2" data-path="proproc-rocs.html"><a href="proproc-rocs.html#definitions-of-proproc-parameters-in-terms-of-binormal-model-parameters"><i class="fa fa-check"></i><b>18.2</b> Definitions of PROPROC parameters in terms of binormal model parameters</a></li>
<li class="chapter" data-level="18.3" data-path="proproc-rocs.html"><a href="proproc-rocs.html#main-code-and-output"><i class="fa fa-check"></i><b>18.3</b> Main code and output</a></li>
<li class="chapter" data-level="18.4" data-path="proproc-rocs.html"><a href="proproc-rocs.html#discussion"><i class="fa fa-check"></i><b>18.4</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="metz-eqn-36.html"><a href="metz-eqn-36.html"><i class="fa fa-check"></i><b>19</b> Metz Eqn 36 numerical check</a><ul>
<li class="chapter" data-level="19.1" data-path="metz-eqn-36.html"><a href="metz-eqn-36.html#helper-functions-1"><i class="fa fa-check"></i><b>19.1</b> Helper functions</a></li>
<li class="chapter" data-level="19.2" data-path="metz-eqn-36.html"><a href="metz-eqn-36.html#main-code-and-output-1"><i class="fa fa-check"></i><b>19.2</b> Main code and output</a></li>
<li class="chapter" data-level="19.3" data-path="metz-eqn-36.html"><a href="metz-eqn-36.html#discussion-1"><i class="fa fa-check"></i><b>19.3</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html"><i class="fa fa-check"></i><b>20</b> Bivariate binormal model</a><ul>
<li class="chapter" data-level="20.1" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-how-much-finished"><i class="fa fa-check"></i><b>20.1</b> TBA How much finished</a></li>
<li class="chapter" data-level="20.2" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-introduction"><i class="fa fa-check"></i><b>20.2</b> Introduction</a></li>
<li class="chapter" data-level="20.3" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-bivariate-density"><i class="fa fa-check"></i><b>20.3</b> Bivariate density function</a></li>
<li class="chapter" data-level="20.4" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-formulae"><i class="fa fa-check"></i><b>20.4</b> The bivariate binormal model</a></li>
<li class="chapter" data-level="20.5" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-multivariate-density-visualization"><i class="fa fa-check"></i><b>20.5</b> Visualizing the bivariate density function</a></li>
<li class="chapter" data-level="20.6" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-multivariate-density-estimation"><i class="fa fa-check"></i><b>20.6</b> Estimating bivariate binormal model parameters</a></li>
<li class="chapter" data-level="20.7" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-multivariate-density-examples"><i class="fa fa-check"></i><b>20.7</b> Examples of bivariate normal probability integrals</a><ul>
<li class="chapter" data-level="20.7.1" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-multivariate-density-estimation-code"><i class="fa fa-check"></i><b>20.7.1</b> Code listing</a></li>
<li class="chapter" data-level="20.7.2" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-examples-integrals"><i class="fa fa-check"></i><b>20.7.2</b> Examples of bivariate normal probability integrals</a></li>
</ul></li>
<li class="chapter" data-level="20.8" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-likelihood"><i class="fa fa-check"></i><b>20.8</b> Likelihood function</a></li>
<li class="chapter" data-level="20.9" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-corroc2"><i class="fa fa-check"></i><b>20.9</b> CORROC2 software</a><ul>
<li class="chapter" data-level="20.9.1" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-corroc2-details"><i class="fa fa-check"></i><b>20.9.1</b> Details of CORROC2 software</a></li>
<li class="chapter" data-level="20.9.2" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-corroc2-data-input"><i class="fa fa-check"></i><b>20.9.2</b> CORROC2 data input</a></li>
<li class="chapter" data-level="20.9.3" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-corroc2-output"><i class="fa fa-check"></i><b>20.9.3</b> CORROC2 output</a></li>
<li class="chapter" data-level="20.9.4" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-corroc2-covariance-matrix"><i class="fa fa-check"></i><b>20.9.4</b> Covariance matrix</a></li>
<li class="chapter" data-level="20.9.5" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-corroc2-output-restof"><i class="fa fa-check"></i><b>20.9.5</b> Rest of CORROC2 output</a></li>
</ul></li>
<li class="chapter" data-level="20.10" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-corroc2-application"><i class="fa fa-check"></i><b>20.10</b> Application to a real dataset</a><ul>
<li class="chapter" data-level="20.10.1" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-corroc2-application-code-output"><i class="fa fa-check"></i><b>20.10.1</b> Code Output</a></li>
<li class="chapter" data-level="20.10.2" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-corroc2-application-debug-window"><i class="fa fa-check"></i><b>20.10.2</b> Contents of the Debug window, as viewed from the Mac side</a></li>
<li class="chapter" data-level="20.10.3" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-corroc2-application-corrocii-input"><i class="fa fa-check"></i><b>20.10.3</b> Contents of CorrocIIinput.txt</a></li>
</ul></li>
<li class="chapter" data-level="20.11" data-path="bivariate-binormal-model.html"><a href="bivariate-binormal-model.html#bivariate-binormal-model-corroc2-discussion"><i class="fa fa-check"></i><b>20.11</b> Discussion / Summary</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The RJafroc Roc Book</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="binormal-model" class="section level1 hasAnchor">
<h1><span class="header-section-number">Chapter 6</span> Binormal model<a href="binormal-model.html#binormal-model" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="binormal-model-how-much-finished" class="section level2 hasAnchor">
<h2><span class="header-section-number">6.1</span> TBA How much finished<a href="binormal-model.html#binormal-model-how-much-finished" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>70%</p>
</div>
<div id="binormal-model-introduction" class="section level2 hasAnchor">
<h2><span class="header-section-number">6.2</span> TBA Introduction<a href="binormal-model.html#binormal-model-introduction" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The equal variance binormal model was described in TBA Chapter 02. The ratings method of acquiring ROC data and calculation of operating points was discussed in TBA Chapter 04. It was shown, TBA Fig. <a href="ratings-paradigm.html#fig:ratings-paradigm-eq-var-fit-a">4.1</a>, that for a clinical dataset the unequal-variance binormal model visually fitted the data better than the equal-variance binormal model, although how the unequal variance fit was obtained was not discussed. This chapter deals with details of the unequal-variance binormal model, often abbreviated to <strong>binormal model</strong>, establishes necessary notation, and derives expressions for sensitivity, specificity and the area under the predicted ROC curve).</p>
<p>The binormal model describes univariate datasets, in which there is <em>one ROC rating per case</em>, as in a single observer interpreting cases, one at a time, in a single modality. By convention the qualifier “univariate” is often omitted. In TBA Chapter 21 a bivariate model will be described where each case yields two ratings, as in a single observer interpreting cases in two modalities, or the homologous problem of two observers interpreting cases in a single modality.</p>
<p>The main aim of this chapter is to demystify statistical curve fitting. With the passing of Dorfman, Metz and Swensson, parametric modeling is being neglected. Researchers are instead focusing on non-parametric analysis using the empirical AUC. While useful and practical, empirical AUC yields almost no insight into what is limiting performance. Taking the mystery out of curve fitting will allow the reader to appreciate later chapters that describe more complex fitting methods, which yield important insights into factors limiting performance.</p>
<p>Here is the organization of this chapter. It starts with a description of the binormal model and how it accommodates data binning. An important point, on which there is much confusion, on the invariance of the binormal model to arbitrary monotone transformations of the ratings is explicated with an example. Expressions for sensitivity and specificity are derived. Two notations used to characterize the binormal model are explained. Expressions for the pdfs of the binormal model are derived. A simple linear fitting method is illustrated: this used to be the only recourse a researcher had before Dorfman and Alf’s seminal publication <span class="citation">(Dorfman and Alf <a href="#ref-RN1081" role="doc-biblioref">1969</a>)</span>. The maximum likelihood method for estimating parameters of the binormal model is detailed. Validation of the fitting method is described, i.e., how can one be confident that the fitting method, which makes normality and other assumptions, is valid for a dataset arising from an unknown distribution. The Appendix has a detailed derivation, originally published in a terse paper <span class="citation">(Thompson and Zucchini <a href="#ref-thompson1989statistical" role="doc-biblioref">1989</a>)</span> on the partial-area under the ROC curve. The partial-area is defined by the area under the binormal ROC curve from <span class="math inline">\(FPF = 0\)</span> to <span class="math inline">\(FPF = c\)</span>, where <span class="math inline">\(0 \leq c \leq 1\)</span>. As a special case <span class="math inline">\(c = 1\)</span> yields the total area under the binormal ROC.</p>
</div>
<div id="binormal-model-definition" class="section level2 hasAnchor">
<h2><span class="header-section-number">6.3</span> Binormal model<a href="binormal-model.html#binormal-model-definition" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="the-basic-model" class="section level3 hasAnchor">
<h3><span class="header-section-number">6.3.1</span> The basic model<a href="binormal-model.html#the-basic-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The unequal-variance binormal model (henceforth abbreviated to binormal model; when I mean equal variances, it will be made explicit) is defined by (capital letters indicate random variables and their lower-case counterparts are realized values):</p>
<p><span class="math display" id="eq:binormal-model-z-samples-1">\[\begin{equation} 
Z_{k_tt}\sim N\left ( \mu_t,\sigma_{t}^{2} \right );t=1,2
\tag{6.1}
\end{equation}\]</span></p>
<p>where</p>
<p><span class="math display" id="eq:binormal-model-z-samples-2">\[\begin{equation} 
\left.
\begin{aligned}
\mu_1=&amp;0\\
\mu_2=&amp;\mu\\
\sigma_{1}^{2}=&amp;1\\
\sigma_{2}^{2}=&amp;\sigma^{2}
\end{aligned}
\right \}
\tag{6.2}
\end{equation}\]</span></p>
<p>Eqn. <a href="binormal-model.html#eq:binormal-model-z-samples-1">(6.1)</a> states that the z-samples for non-diseased cases are distributed as a <span class="math inline">\(N(0,1)\)</span> distribution, i.e., the unit normal distribution, while the z-samples for diseased cases are distributed as a <span class="math inline">\(N(\mu,\sigma^2)\)</span> distribution, i.e., a normal distribution with mean <span class="math inline">\(\mu\)</span> and variance <span class="math inline">\(\sigma^2\)</span>. <em>This is a 2-parameter model of the z-samples, not counting additional threshold parameters needed for data binning.</em><a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
</div>
<div id="additional-parameters-for-binned-data" class="section level3 hasAnchor">
<h3><span class="header-section-number">6.3.2</span> Additional parameters for binned data<a href="binormal-model.html#additional-parameters-for-binned-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In an R-rating ROC study the observed ratings <span class="math inline">\(r\)</span> take on integer values, 1 through <span class="math inline">\(R\)</span>, it being understood that higher ratings correspond to greater confidence for disease. Defining dummy cutoffs <span class="math inline">\(\zeta_0 = -\infty\)</span> and <span class="math inline">\(\zeta_R = +\infty\)</span>, the binning rule for a case with realized z-sample z is (Chapter <a href="ratings-paradigm.html#ratings-paradigm">4</a>, Eqn. <a href="ratings-paradigm.html#eq:ratings-paradigm-binningRule">(4.4)</a>):</p>
<p><span class="math display" id="eq:binormal-modelZBinning">\[\begin{equation} 
\text{if} \left (\zeta_{r-1} \le z \le \zeta_r  \right )\Rightarrow \text {rating} = r
\tag{6.3}
\end{equation}\]</span></p>
<pre><code>#&gt; Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
#&gt; ℹ Please use `linewidth` instead.</code></pre>
<p><img src="06-binormal-model_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>In the unequal-variance binormal model, the variance <span class="math inline">\(\sigma^2\)</span> of the z-samples for diseased cases is allowed to be different from unity. Most ROC datasets are consistent with <span class="math inline">\(\sigma &gt; 1\)</span>. The above figure, generated with <span class="math inline">\(\mu = 1.5, \sigma = 1.5, \zeta_1 = -2, \zeta_2 = -0.5, \zeta_3 = 1, \zeta_4 = 2.5\)</span>, illustrates how realized z-samples are converted to ratings, i.e., application of the binning rule <a href="binormal-model.html#eq:binormal-modelZBinning">(6.3)</a>. For example, a case with z-sample equal to -2.5 would be rated “1”, and one with z-sample equal to -1 would be rated “2”, cases with z-samples greater than 2.5 would be rated “5”, etc.</p>
</div>
<div id="sensitivity-and-specificity-1" class="section level3 hasAnchor">
<h3><span class="header-section-number">6.3.3</span> Sensitivity and specificity<a href="binormal-model.html#sensitivity-and-specificity-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let <span class="math inline">\(Z_t\)</span> denote the random z-sample for truth state <span class="math inline">\(t\)</span> (<span class="math inline">\(t\)</span> = 1 for non-diseased and <span class="math inline">\(t\)</span> = 2 for diseased cases). Since the distribution of z-samples from disease-free cases is <span class="math inline">\(N(0,1)\)</span>, the expression for specificity, Chapter “Modeling Binary Paradigm”, Eqn. 3.13, applies. It is reproduced below:</p>
<p><span class="math display" id="eq:binormal-modelSp">\[\begin{equation} 
Sp\left ( \zeta \right )=P\left ( Z_1 &lt; \zeta \right )=\Phi\left ( \zeta \right )
\tag{6.4}
\end{equation}\]</span></p>
<p>To obtain an expression for sensitivity, consider that for truth state <span class="math inline">\(t = 2\)</span>, the random variable <span class="math inline">\(\frac{Z_2-\mu}{\sigma}\)</span> is distributed as <span class="math inline">\(N(0,1)\)</span>:</p>
<p><span class="math display">\[\begin{equation*} 
\frac{Z_2-\mu}{\sigma}\sim N\left ( 0,1 \right )
\end{equation*}\]</span></p>
<p>Sensitivity is <span class="math inline">\(P\left ( Z_2 &gt; \zeta \right )\)</span>, which implies, because <span class="math inline">\(\sigma\)</span> is positive (subtract <span class="math inline">\(\mu\)</span> from both sides of the “greater than” symbol and divide by <span class="math inline">\(\sigma\)</span>):</p>
<p><span class="math display" id="eq:binormal-modelSe">\[\begin{equation} 
Se\left ( \zeta | \mu, \sigma \right )= P\left ( Z_2 &gt; \zeta \right )=P\left ( \frac{Z_2-\mu}{\sigma} &gt; \frac{\zeta-\mu}{\sigma} \right )
\tag{6.5}
\end{equation}\]</span></p>
<p>The right-hand-side can be rewritten as follows:</p>
<p><span class="math display">\[\begin{equation*} 
Se\left ( \zeta | \mu, \sigma \right )= 1 - P\left ( \frac{Z_2-\mu}{\sigma} \leq  \frac{\zeta-\mu}{\sigma} \right )\\
=1-\Phi\left (  \frac{\zeta-\mu}{\sigma}\right )=\Phi\left (  \frac{\mu-\zeta}{\sigma}\right )
\end{equation*}\]</span></p>
<p>Summarizing, the formulae for the specificity and sensitivity for the binormal model are:</p>
<p><span class="math display" id="eq:binormal-modelSeSp">\[\begin{equation} 
Sp\left ( \zeta \right ) = \Phi\left ( \zeta \right )\\
Se\left ( \zeta | \mu, \sigma \right ) = \Phi\left (  \frac{\mu-\zeta}{\sigma}\right )
\tag{6.6}
\end{equation}\]</span></p>
<p>The coordinates of the operating point defined by <span class="math inline">\(\zeta\)</span> are given by:</p>
<p><span class="math display" id="eq:binormal-model-fpf">\[\begin{equation} 
FPF\left ( \zeta \right ) = 1 - Sp\left ( \zeta \right ) = 1 - \Phi\left ( \zeta \right ) = \Phi\left ( -\zeta \right )
\tag{6.7}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:binormal-model-tpf">\[\begin{equation} 
TPF\left ( \zeta | \mu, \sigma \right ) = \Phi\left ( \frac{\mu-\zeta}{\sigma} \right )
\tag{6.8}
\end{equation}\]</span></p>
<p>These expressions allow calculation of the operating point for any <span class="math inline">\(\zeta\)</span>. An equation for a curve is usually expressed as <span class="math inline">\(y=f(x)\)</span>. An expression of this form for the ROC curve, i.e., the y-coordinate (TPF) expressed as a function of the x-coordinate (FPF), follows upon inversion of the expression for FPF, Eqn. <a href="binormal-model.html#eq:binormal-model-fpf">(6.7)</a>:</p>
<p><span class="math display" id="eq:binormal-modelZeta">\[\begin{equation} 
\zeta = -\Phi^{-1}\left ( FPF \right )
\tag{6.9}
\end{equation}\]</span></p>
<p>Substitution of Eqn. <a href="binormal-model.html#eq:binormal-modelZeta">(6.9)</a> in Eqn. <a href="binormal-model.html#eq:binormal-model-tpf">(6.8)</a> yields:</p>
<p><span class="math display" id="eq:binormal-model-roc-curve1">\[\begin{equation} 
TPF = \Phi\left ( \frac{\mu + \Phi^{-1}\left (FPF  \right )}{\sigma} \right )
\tag{6.10}
\end{equation}\]</span></p>
<p>This equation gives the dependence of TPF on FPF, i.e., the equation for the ROC curve. It will be put into standard notation next.</p>
</div>
<div id="binormal-model-in-conventional-notation" class="section level3 hasAnchor">
<h3><span class="header-section-number">6.3.4</span> Binormal model in conventional notation<a href="binormal-model.html#binormal-model-in-conventional-notation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The following notation is widely used in the literature:</p>
<p><span class="math display" id="eq:binormal-modelabParameters">\[\begin{equation} 
a=\frac{\mu}{\sigma};b=\frac{1}{\sigma}
\tag{6.11}
\end{equation}\]</span></p>
<p>The reason for the <span class="math inline">\((a,b)\)</span> instead of the <span class="math inline">\((\mu,\sigma)\)</span> notation is that Dorfman and Alf assumed, in their seminal paper <span class="citation">(Dorfman and Alf <a href="#ref-RN1081" role="doc-biblioref">1969</a>)</span>, that the diseased distribution (signal distribution in signal detection theory) had unit variance, and the non-diseased distribution (noise) had standard deviation <span class="math inline">\(b\)</span> (<span class="math inline">\(b &gt; 0\)</span>) or variance <span class="math inline">\(b^2\)</span>, and that the separation of the two distributions was <span class="math inline">\(a\)</span>, see figure below. In this example: <span class="math inline">\(a = 1.11\)</span> and <span class="math inline">\(b = 0.556\)</span>, corresponding to <span class="math inline">\(\mu = 2\)</span> and <span class="math inline">\(\sigma = 1.8\)</span>. Dorfman and Alf’s fundamental contribution, namely estimating these parameters from ratings data, to be described below, led to the widespread usage of the <span class="math inline">\((a,b)\)</span> parameters estimated by their software (RSCORE), and its newer variants (e.g., RSCORE–II, ROCFIT and ROCKIT).</p>
<p>By dividing the z-samples by <span class="math inline">\(b\)</span>, the variance of the distribution labeled “Noise” becomes unity, its mean stays at zero, and the variance of the distribution labeled “Signal” becomes <span class="math inline">\(1/b\)</span>, and its mean becomes <span class="math inline">\(a/b\)</span>, as shown below. It illustrates that the inverses of Eqn. <a href="binormal-model.html#eq:binormal-modelabParameters">(6.11)</a> are:</p>
<p><span class="math display" id="eq:binormal-modelabParametersInv">\[\begin{equation} 
\mu=\frac{a}{b};\sigma=\frac{1}{b}
\tag{6.12}
\end{equation}\]</span></p>
<p>Eqns. <a href="binormal-model.html#eq:binormal-modelabParameters">(6.11)</a> and <a href="binormal-model.html#eq:binormal-modelabParametersInv">(6.12)</a> allow conversion from one notation to another.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="binormal-model.html#cb28-1"></a><span class="kw">grid.arrange</span>(p1,p2,<span class="dt">ncol=</span><span class="dv">2</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:binormal-model-ab2-mu-sigma"></span>
<img src="06-binormal-model_files/figure-html/binormal-model-ab2-mu-sigma-1.png" alt="Plot A shows the definitions of the (a,b) parameters of the binormal model. In plot B the x-axis has been rescaled so that the noise distribution has unit variance, thereby illustrations between (a,b) and the ($\mu,\sigma$) parameters." width="672" />
<p class="caption">
FIGURE 6.1: Plot A shows the definitions of the (a,b) parameters of the binormal model. In plot B the x-axis has been rescaled so that the noise distribution has unit variance, thereby illustrations between (a,b) and the (<span class="math inline">\(\mu,\sigma\)</span>) parameters.
</p>
</div>
</div>
</div>
<div id="binormal-model-roc-curve" class="section level2 hasAnchor">
<h2><span class="header-section-number">6.4</span> Binormal ROC curve<a href="binormal-model.html#binormal-model-roc-curve" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Using the <span class="math inline">\((a,b)\)</span> notation, Eqn. <a href="binormal-model.html#eq:binormal-model-roc-curve1">(6.10)</a> for the ROC curve reduces to:</p>
<p><span class="math display" id="eq:binormal-model-roc-curve">\[\begin{equation} 
TPF = \Phi\left ( a+ b \Phi^{-1}\left (FPF  \right ) \right )
\tag{6.13}
\end{equation}\]</span></p>
<p>Since <span class="math inline">\(\Phi^{-1}(FPF)\)</span> is an increasing function of its argument <span class="math inline">\(FPF\)</span>, and <span class="math inline">\(b &gt; 0\)</span>, the argument of the <span class="math inline">\(\Phi\)</span> function is an increasing function of <span class="math inline">\(FPF\)</span>. Since <span class="math inline">\(\Phi\)</span> is a monotonically increasing function of its argument, <span class="math inline">\(TPF\)</span> is a monotonically increasing function of <span class="math inline">\(FPF\)</span>. This is true regardless of the sign of <span class="math inline">\(a\)</span>. If <span class="math inline">\(FPF = 0\)</span>, then <span class="math inline">\(\Phi^{-1}(0) = -\infty\)</span> and <span class="math inline">\(TPF = 0\)</span>. If <span class="math inline">\(FPF = 1\)</span>, then <span class="math inline">\(\Phi^{-1}(1) = +\infty\)</span> and <span class="math inline">\(TPF = 1\)</span>. Regardless of the value of <span class="math inline">\(a\)</span>, as long as <span class="math inline">\(b \ge 0\)</span>, the ROC curve starts at (0,0) and increases monotonically ending at (1,1).</p>
<p>From Eqn. <a href="binormal-model.html#eq:binormal-model-fpf">(6.7)</a> and Eqn. <a href="binormal-model.html#eq:binormal-model-tpf">(6.8)</a>, the expressions for <span class="math inline">\(FPF\)</span> and <span class="math inline">\(TPF\)</span> in terms of model parameters <span class="math inline">\((a,b)\)</span> are:</p>
<p><span class="math display" id="eq:binormal-model-op-point-ab">\[\begin{equation}
\left.
\begin{aligned}
FPF\left ( \zeta \right ) &amp;= \Phi\left ( -\zeta \right )\\
TPF &amp;= \Phi\left ( a - b \zeta \right )
\end{aligned}
\right \}
\tag{6.14}
\end{equation}\]</span></p>
</div>
<div id="binormal-model-scalar-measure" class="section level2 hasAnchor">
<h2><span class="header-section-number">6.5</span> Scalar threshold-independent measure<a href="binormal-model.html#binormal-model-scalar-measure" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Sensitivity-specificity is a dual (two-valued) measure of performance. Using a dual measure it is difficult to unambiguously compare two systems since one cannot separate the effect of reporting threshold from the measures. For example, if sensitivity is higher for one system but specificity is higher for another, this could be due to different thresholds. Sensitivity and specificity depend on the threshold. As the threshold changes, sensitivitya nd specificity are both affected in opposite directions. Desirable is a scalard measure of performance that takes this variation into account and does not depend on any specific threshold.</p>
<p>Generally accepted measures are the partial-area <span class="math inline">\(A_{z;c}\)</span> under the ROC, Eqn. <a href="binormal-model.html#eq:binormal-model-partial-area-final">(6.15)</a>, the full-area <span class="math inline">\(A_z\)</span> under the ROC, Eqn. <a href="binormal-model.html#eq:binormal-model-ab-2az">(6.18)</a>, and the <span class="math inline">\(d&#39;\)</span> index Eqn. <a href="binormal-model.html#eq:binormal-model-ab-2dprime">(6.19)</a>.</p>
<p>Before deriving analytical expressions for these measures let us further examine the premise that sensitivity-specificity is undesirable because it is a 2D measure. A trivial way to convert it to a scalar measure is to sum the two values: high sensitivity and high specificity are both desirable, so a high value of their sum is certainly also desirable. In fact this is the basis for the Youden index, defined as sensitivity plust specificity minus one <span class="citation">(Youden <a href="#ref-youden1950index" role="doc-biblioref">1950</a>)</span>. (Subtracting one makes the Youden index range from 0 to 1.) However, this index varies with the position of the operating point on the ROC curve. (The operating point at which it is maximum is often thought of as the optimal operating point on the ROC curve.)</p>
<p>To emphasize, we desire a scalar measure that is threshold independent.</p>
<div id="binormal-model-partial-auc" class="section level3 hasAnchor">
<h3><span class="header-section-number">6.5.1</span> Partial AUC<a href="binormal-model.html#binormal-model-partial-auc" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>While this is a scalar measure, it does depend on choice of operating point. It is included here as it yields, as a special case, a scalar measure that does not depend on choice of operating point. The details are in Section <a href="binormal-model.html#binormal-model-appendix-1-partial-auc">6.12.1</a>, which derives the formula for the partial-area under the unequal-variance binormal model. The final result is:</p>
<p><span class="math display" id="eq:binormal-model-partial-area-final">\[\begin{equation}
A_{z;c} = \int_{z_2=-\infty}^{\Phi^{-1}\left ( c \right )}   \int_{z_1=-\infty}^{\frac{a}{\sqrt{1+b^2}}} \phi\left ( z_1,z_2;\rho \right ) dz_1dz_2
\tag{6.15}
\end{equation}\]</span></p>
<p>The threshold <span class="math inline">\(\zeta_1\)</span> corresponding to <span class="math inline">\(FPF = c\)</span> is given by:</p>
<p><span class="math display" id="eq:binormal-model-zeta-c-relation">\[\begin{equation} 
\zeta_1 = - \Phi^{-1}   \left ( c \right )
\tag{6.16}
\end{equation}\]</span></p>
<p><span class="math inline">\(A_{z;c}\)</span> is the area under the partial ROC curve extending from <span class="math inline">\(FPF = 0\)</span> to <span class="math inline">\(FPF = c\)</span> and <span class="math inline">\(\phi\left ( z_1,z_2;\rho \right )\)</span> is the standard bivariate normal distribution, where the correlation coefficient <span class="math inline">\(\rho\)</span> of the distribution is defined by:</p>
<p><span class="math display" id="eq:binormal-model-rho-final">\[\begin{equation}
\rho = - \frac{b}{\sqrt{1+b^2}}
\tag{6.17}
\end{equation}\]</span></p>
<p>The bivariate 2D integral can be evaluated numerically. The following code illustrates calculation of the partial-area measure using the function <code>pmvnorm</code> in <code>R</code> package <code>mvtnorm</code>. The following parameter values were used: <span class="math inline">\(a = 2\)</span>, <span class="math inline">\(b = 1\)</span> and <span class="math inline">\(\zeta_1 = 1.5\)</span>. (The parameter <span class="math inline">\(b\)</span> was deliberately chosen equal to one so that we do not have to worry about improper ROC curves.)</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb29-1"><a href="binormal-model.html#cb29-1"></a>a &lt;-<span class="st"> </span><span class="dv">2</span>;b &lt;-<span class="st"> </span><span class="dv">1</span>; zeta1 &lt;-<span class="st"> </span><span class="fl">1.5</span></span>
<span id="cb29-2"><a href="binormal-model.html#cb29-2"></a>A_z &lt;-<span class="st"> </span><span class="kw">pnorm</span>(a<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">1</span><span class="op">+</span>b<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb29-3"><a href="binormal-model.html#cb29-3"></a>opPtx &lt;-<span class="st"> </span><span class="kw">pnorm</span>(<span class="op">-</span>zeta1)</span>
<span id="cb29-4"><a href="binormal-model.html#cb29-4"></a>opPty &lt;-<span class="st"> </span><span class="kw">pnorm</span>(a <span class="op">-</span><span class="st"> </span>b <span class="op">*</span><span class="st"> </span>zeta1)</span>
<span id="cb29-5"><a href="binormal-model.html#cb29-5"></a>rho &lt;-<span class="st"> </span><span class="op">-</span>b<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">1</span><span class="op">+</span>b<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb29-6"><a href="binormal-model.html#cb29-6"></a>Lower1 &lt;-<span class="st"> </span><span class="op">-</span><span class="ot">Inf</span></span>
<span id="cb29-7"><a href="binormal-model.html#cb29-7"></a>Upper1 &lt;-<span class="st"> </span><span class="kw">qnorm</span>(opPtx)</span>
<span id="cb29-8"><a href="binormal-model.html#cb29-8"></a>Lower2 &lt;-<span class="st"> </span><span class="op">-</span><span class="ot">Inf</span></span>
<span id="cb29-9"><a href="binormal-model.html#cb29-9"></a>Upper2 &lt;-<span class="st"> </span>a<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">1</span><span class="op">+</span>b<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb29-10"><a href="binormal-model.html#cb29-10"></a>sigma &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">c</span>(<span class="dv">1</span>, rho), <span class="kw">c</span>(rho, <span class="dv">1</span>))</span>
<span id="cb29-11"><a href="binormal-model.html#cb29-11"></a>A_zc &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">pmvnorm</span>(</span>
<span id="cb29-12"><a href="binormal-model.html#cb29-12"></a>  <span class="kw">c</span>(Lower1, Lower2), </span>
<span id="cb29-13"><a href="binormal-model.html#cb29-13"></a>  <span class="kw">c</span>(Upper1, Upper2), </span>
<span id="cb29-14"><a href="binormal-model.html#cb29-14"></a>  <span class="dt">sigma =</span> sigma))</span></code></pre></div>
<p>The partial-area measure is <span class="math inline">\(A_{z;c}\)</span> = 0.0352195. The corresponding full-area measure is <span class="math inline">\(A_z\)</span> = 0.9213504. <span class="math inline">\(A_{z;c}\)</span> is small because the reporting threshold is high. However, <span class="math inline">\(A_{z;c}\)</span> should not be confused with true performance of the observer, as shown in Section <a href="binormal-model.html#binormal-model-partial-true">6.6</a>.</p>
</div>
<div id="binormal-model-full-auc" class="section level3 hasAnchor">
<h3><span class="header-section-number">6.5.2</span> Full AUC<a href="binormal-model.html#binormal-model-full-auc" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A special case of this formula is the area under the full ROC curve, shown below using both parameterizations of the binormal model:</p>
<p><span class="math display" id="eq:binormal-model-ab-2az">\[\begin{equation} 
A_z=\Phi\left ( \frac{a}{\sqrt{1+b^2}} \right )=\Phi\left ( \frac{\mu}{\sqrt{1+\sigma^2}} \right )
\tag{6.18}
\end{equation}\]</span></p>
<p>The binormal fitted AUC increases as <span class="math inline">\(a\)</span> increases or as <span class="math inline">\(b\)</span> decreases. Equivalently, it increases as <span class="math inline">\(\mu\)</span> increases or as <span class="math inline">\(\sigma\)</span> decreases. In the example just given, the full AUC is <span class="math inline">\(A_z\)</span> = 0.9213504.</p>
</div>
<div id="binormal-model-d-prime" class="section level3 hasAnchor">
<h3><span class="header-section-number">6.5.3</span> The d’ measure<a href="binormal-model.html#binormal-model-d-prime" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <span class="math inline">\(d&#39;\)</span> parameter is defined as the separation of two unit-variance normal distributions yielding the same AUC as that predicted by the <span class="math inline">\((a,b)\)</span> parameter binormal model. It is defined by:</p>
<p><span class="math display" id="eq:binormal-model-ab-2dprime">\[\begin{equation} 
d&#39;=\sqrt{2}\Phi^{-1}\left ( A_z \right )
\tag{6.19}
\end{equation}\]</span></p>
<p>The d’ index corresponding to the above binormal parameters is 2. The transformation from an index that ranges from 0.5 to 1 to one that ranges from 0 to infinity can be viewed as desirable. The d’ index can be regarded as a perceptual signal-to-noise-ratio.</p>
</div>
</div>
<div id="binormal-model-partial-true" class="section level2 hasAnchor">
<h2><span class="header-section-number">6.6</span> Partial AUC vs. true performance<a href="binormal-model.html#binormal-model-partial-true" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>A <em>partial-area observer</em> such as in Section <a href="binormal-model.html#binormal-model-partial-auc">6.5.1</a> rates cases as follows: for the sub-set of cases defined by <span class="math inline">\(z \ge \zeta_1\)</span> the observer reports <em>explicit</em> ratings exactly equal to the observed z-samples (or some monotonic transformation of the z-samples). For the remaining cases the observer assigns a <em>fixed value rating that is smaller than <span class="math inline">\(\zeta_1\)</span></em> (the exact value does not matter; these cases are said to be assigned <em>implicit</em> ratings).</p></li>
<li><p>In contrast, the <em>full-area observer</em> reports explicit ratings <em>for all cases</em>.</p></li>
</ul>
<p><em>To measure true performance of the partial-area observer one must, of course, include all cases.</em> The ROC curve extends continuously from the origin to the solid dot <em>plus the area under the dotted line</em> extending from the solid dot to (1,1). True performance, the area under the continuous section plus that under the straight line extension, is denoted <span class="math inline">\(A_{z;c,TRUE}\)</span> and is defined by:</p>
<p><span class="math display" id="eq:binormal-model-partial-area-true-performance">\[\begin{equation} 
A_{z;c,\text{TRUE}} = A_{z;c} + \frac {\left ( 1 - FPF \right ) \left ( 1 + TPF \right )}{2}
\tag{6.20}
\end{equation}\]</span></p>
<p>In other words one adds to <span class="math inline">\(A_{z;c}\)</span> the area of the trapezoid with bases each equal to <span class="math inline">\((1 - FPF)\)</span> and opposing sides equal to <span class="math inline">\(TPF\)</span> and unity.</p>
<p>Since the partial-area observer does not preserve ordering information, <em>true performance of a partial-area observer is smaller than performance <span class="math inline">\(A_z\)</span> of a full-area observer</em>.</p>
<p><span class="math display" id="eq:binormal-model-true-performance-az-inequality">\[\begin{equation} 
A_{z;c,\text{TRUE}} \le A_{z}
\tag{6.21}
\end{equation}\]</span></p>
<p>True performance is illustrated with the following simulation 2AFC study. The <code>Wilcoxon</code> function, defined next, can be thought of as the mathematical equivalent of a 2AFC study, conducted with all possible pairings of non-diseased and diseased cases. For each pairing, if the z-sample of the diseased case exceeds that of the non-diseased case one adds unity to a zero-initialized counter; if it is smaller one does nothing; if they are equal one adds 0.5; and finally one divides by the number of comparisons.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb30-1"><a href="binormal-model.html#cb30-1"></a>Wilcoxon &lt;-<span class="st"> </span><span class="cf">function</span> (zk1, zk2)</span>
<span id="cb30-2"><a href="binormal-model.html#cb30-2"></a>{</span>
<span id="cb30-3"><a href="binormal-model.html#cb30-3"></a>  K1 =<span class="st"> </span><span class="kw">length</span>(zk1)</span>
<span id="cb30-4"><a href="binormal-model.html#cb30-4"></a>  K2 =<span class="st"> </span><span class="kw">length</span>(zk2)</span>
<span id="cb30-5"><a href="binormal-model.html#cb30-5"></a>  W &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb30-6"><a href="binormal-model.html#cb30-6"></a>    <span class="cf">for</span> (k1 <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>K1) {</span>
<span id="cb30-7"><a href="binormal-model.html#cb30-7"></a>      W &lt;-<span class="st"> </span>W <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(zk1[k1] <span class="op">&lt;</span><span class="st"> </span>zk2)</span>
<span id="cb30-8"><a href="binormal-model.html#cb30-8"></a>      W &lt;-<span class="st"> </span>W <span class="op">+</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span><span class="kw">sum</span>(zk1[k1] <span class="op">==</span><span class="st"> </span>zk2)</span>
<span id="cb30-9"><a href="binormal-model.html#cb30-9"></a>    }</span>
<span id="cb30-10"><a href="binormal-model.html#cb30-10"></a>    W &lt;-<span class="st"> </span>W<span class="op">/</span>K1<span class="op">/</span>K2</span>
<span id="cb30-11"><a href="binormal-model.html#cb30-11"></a>  <span class="kw">return</span> (W)</span>
<span id="cb30-12"><a href="binormal-model.html#cb30-12"></a>}</span></code></pre></div>
<p>The following code saves 10,000 pairs of ratings in two arrays: <code>z[1,]</code> and <code>z[2,]</code>. The first array corresponds to non-diseased cases and the second to diseased cases. Note the usage, at lines 3-4, of the <span class="math inline">\(a,b\)</span> values to define the two distributions. The array <code>zc</code>, initially a copy of <code>z</code>, is selectively binned by setting, lines 6-7, all ratings less than <span class="math inline">\(\zeta_1\)</span> to -100. The ordering information for these z-samples is lost.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb31-1"><a href="binormal-model.html#cb31-1"></a>nPairs &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb31-2"><a href="binormal-model.html#cb31-2"></a>z &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dt">dim =</span> <span class="kw">c</span>(<span class="dv">2</span>, nPairs))</span>
<span id="cb31-3"><a href="binormal-model.html#cb31-3"></a>z[<span class="dv">1</span>,] &lt;-<span class="st"> </span><span class="kw">rnorm</span>(nPairs, <span class="dt">sd =</span> b)</span>
<span id="cb31-4"><a href="binormal-model.html#cb31-4"></a>z[<span class="dv">2</span>,] &lt;-<span class="st"> </span><span class="kw">rnorm</span>(nPairs, <span class="dt">mean =</span> a, <span class="dt">sd =</span> <span class="dv">1</span>)</span>
<span id="cb31-5"><a href="binormal-model.html#cb31-5"></a>zc &lt;-<span class="st"> </span>z</span>
<span id="cb31-6"><a href="binormal-model.html#cb31-6"></a>zc[<span class="dv">1</span>,z[<span class="dv">1</span>,] <span class="op">&lt;</span><span class="st"> </span>zeta1] &lt;-<span class="st"> </span><span class="dv">-100</span> <span class="co"># ratings of partial area observer</span></span>
<span id="cb31-7"><a href="binormal-model.html#cb31-7"></a>zc[<span class="dv">2</span>,z[<span class="dv">2</span>,] <span class="op">&lt;</span><span class="st"> </span>zeta1] &lt;-<span class="st"> </span><span class="dv">-100</span> <span class="co"># do:</span></span></code></pre></div>
<p>The following code prints the predicted and observed full areas under the ROCs followed by the predicted and observed true performances. With this many cases sampling variability is small and the predicted and observed values are close.</p>
<pre><code>#&gt; A_z predicted =  0.9213504 
#&gt; A_z observed =  0.9210913
#&gt; A_z{c;true} predicted =  0.8244498 
#&gt; A_z{c;true} observed =  0.8233194</code></pre>
<p>Note that:</p>
<ul>
<li><span class="math inline">\(A_{z;c,\text{TRUE}} &lt; A_z\)</span>, because ordering information is lost for all cases with z-samples less than <span class="math inline">\(\zeta_1\)</span>.</li>
<li><span class="math inline">\(A_{z;c,\text{TRUE}} &gt;&gt; A_{z;c}\)</span>, because of the large contribution from the area under the straight line, left poanel Fig. <a href="binormal-model.html#fig:binormal-model-threshold-dependence-2">6.2</a>.</li>
</ul>
</div>
<div id="binormal-model-illustrative-plots" class="section level2 hasAnchor">
<h2><span class="header-section-number">6.7</span> Illustrative plots<a href="binormal-model.html#binormal-model-illustrative-plots" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the ROC plots below the partial-area observer curve is shown as a continuous line extending from the origin to the limiting point <em>plus</em> a dotted line extending from the limiting point to (1,1). The continuous section is determined by cumulating cases with z-samples <span class="math inline">\(z \ge \zeta_1\)</span> while the (1,1) point is determined by cumulating all cases.</p>
<p>The ROC curve for both types of observers is shown in the left panel of <a href="binormal-model.html#fig:binormal-model-threshold-dependence-2">6.2</a> for the following parameters: <span class="math inline">\(a = 2\)</span>, <span class="math inline">\(b = 1\)</span> and <span class="math inline">\(\zeta_1 = 1.5\)</span>; <span class="math inline">\(\zeta_1\)</span> corresponds to <span class="math inline">\(c \equiv FPF = \Phi(-\zeta_1)\)</span> = 0.0668072 and <span class="math inline">\(TPF = \Phi(a - b\zeta_1)\)</span> = 0.6914625. In other words the limiting point coordinates are (0.067, 0.691), shown in the plot by the solid dot. Partial AUC <span class="math inline">\(A_{z;c}\)</span> equals 0.0352195. The full-area ROC curve, shown by the complete solid curve, extends from (0,0) to (1,1), the area under which is <span class="math inline">\(A_z\)</span> = 0.9213504.</p>
<div class="figure"><span style="display:block;" id="fig:binormal-model-threshold-dependence-2"></span>
<img src="06-binormal-model_files/figure-html/binormal-model-threshold-dependence-2-1.png" alt="Left panel: binormal ROC curve corresponding to a = 2 and b = 1. The dot is the operating point corresponding to $\zeta_1 = 1.5$. The continuous curve extending from the origin to (1,1) represents the full ROC. Note that in the region above the dot the continuus curve is above the dotted line, meaning true performance of an observer who only rates a sub-set of cases is less than performance of an observer who rates all cases. Right panel: variation of true performance with FPF; at FPF = 0 the plot starts at ordinate equal to 0.5 and levels out at FPF = 1 at AUC = $A_z = 0.921.$" width="672" />
<p class="caption">
FIGURE 6.2: Left panel: binormal ROC curve corresponding to a = 2 and b = 1. The dot is the operating point corresponding to <span class="math inline">\(\zeta_1 = 1.5\)</span>. The continuous curve extending from the origin to (1,1) represents the full ROC. Note that in the region above the dot the continuus curve is above the dotted line, meaning true performance of an observer who only rates a sub-set of cases is less than performance of an observer who rates all cases. Right panel: variation of true performance with FPF; at FPF = 0 the plot starts at ordinate equal to 0.5 and levels out at FPF = 1 at AUC = <span class="math inline">\(A_z = 0.921.\)</span>
</p>
</div>
<p>As FPF increases true-performance increases. the right panel of Fig. <a href="binormal-model.html#fig:binormal-model-threshold-dependence-2">6.2</a> shows the variation of true performance <span class="math inline">\(A_{z;c,\text{TRUE}}\)</span> with FPF. The curve starts from (0, 0.5) and ends at (1.000, 0.921). For low values of FPF the curve is very steep while for FPF &gt; 0.25 the curve levels out, approaching the maximum value defined by <span class="math inline">\(A_z\)</span> = 0.9213504. True performance is maximized at <span class="math inline">\(\zeta_1 = -\infty\)</span>.</p>
<p>Fig. <a href="binormal-model.html#fig:binormal-model-threshold-dependence-3">6.3</a>, left panel, corresponding to <span class="math inline">\(a = 1\)</span>, <span class="math inline">\(b = 0.2\)</span> and <span class="math inline">\(\zeta_1 = 1.5\)</span>, shows an improper ROC curve. The dashed line is well above the continuous curve and true performance is maximized at a finite value of <span class="math inline">\(\zeta_1\)</span>, corresponding to <span class="math inline">\(FPF = 0.153\)</span>, see right panel. This is an invalid conclusion since an improper ROC curve is a fitting artifact of the binormal model easily avoided by using modern curve-fitting methods (eg., PROPROC, CBM or RSM). TBA However, since the wAFROC has an operating characteristic with an improper-like feature but which is not a fitting artifact, this example serves a purpose, elaborated on in TBA Chapter (optim-op-point), where it is shown that by maximizing the area under the wAFROC one can find the optimal threshold of an algorithmic observer.</p>
<pre><code>#&gt; true performance max occurs at FPF =  0.1525</code></pre>
<div class="figure"><span style="display:block;" id="fig:binormal-model-threshold-dependence-3"></span>
<img src="06-binormal-model_files/figure-html/binormal-model-threshold-dependence-3-1.png" alt="The left panel shows the visibly improper ROC curve for a = 1 and b = 0.2. The solid line is below the dotted line. The right panel shows the variation of true performance pAUC_TRUE with FPF. True performance is maximized at FPF = 0.153. Since improper ROC fits are fitting artifacts, this example does not negate the previous finding that true performance for a proper ROC curve is maximized by setting the threshold to report all cases, i.e., FPF = 1." width="672" />
<p class="caption">
FIGURE 6.3: The left panel shows the visibly improper ROC curve for a = 1 and b = 0.2. The solid line is below the dotted line. The right panel shows the variation of true performance pAUC_TRUE with FPF. True performance is maximized at FPF = 0.153. Since improper ROC fits are fitting artifacts, this example does not negate the previous finding that true performance for a proper ROC curve is maximized by setting the threshold to report all cases, i.e., FPF = 1.
</p>
</div>
</div>
<div id="binormal-model-geometrical-argument" class="section level2 hasAnchor">
<h2><span class="header-section-number">6.8</span> Geometrical argument<a href="binormal-model.html#binormal-model-geometrical-argument" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Defining geometrical features of a proper ROC are:</p>
<ul>
<li>As one moves up the curve the slope decreases monotonically;</li>
<li>At each point the slope is greater than that of the straight line connecting the point to (1,1);</li>
<li>The curve ends at (1,1).</li>
</ul>
<p>The geometry ensures that true performance for a proper ROC is maximized at <span class="math inline">\(\zeta_1 = -\infty\)</span>, i.e., at FPF = 1, as in Fig. <a href="binormal-model.html#fig:binormal-model-threshold-dependence-2">6.2</a>, right panel.</p>
</div>
<div id="binormal-model-optimal-op-pt" class="section level2 hasAnchor">
<h2><span class="header-section-number">6.9</span> Optimal operating point on ROC<a href="binormal-model.html#binormal-model-optimal-op-pt" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We have seen that optimal ROC AUC is achieved by setting <span class="math inline">\(\zeta_1 = -\infty\)</span>, i.e., by reporting all cases as diseased. Of course, from clinical considerations, this is nonsense. Consider screening mammography, where typically for every 1000 cases only 5 are malignant. Recalling everybody would incur huge costs from having to rule out cancer in 995 actually non-diseased patients. Of course the 5 malignant cancers would be confirmed at the follow-up diagnostic mammography examination. But one can clearly see that the benefit of correctly detecting the 5 malignancies is far outweighed by the 995 unnecessary recalls. And if one is going to recall everybody, why perform the initial screeing mammography exam?</p>
<p>So what is going on? The problem is that AUC measures classification performance in a 2AFC task. A screening examination is not a 2AFC task: the radiologist is not presented two cases, one non-diseased and one diseased, and asked to pick the diseased patient. Rather, the radiologist is shown images of a single patient, and the object is to maximize the detection rate while minimizing false positives.</p>
<p>To address this optimization task one needs to know the costs and benefits of the four decision outcomes in the binary paradigm: true and false positives, and true and false negatives. This has been addressed in <span class="citation">(Metz <a href="#ref-metz1978rocmethodology" role="doc-biblioref">1978</a>)</span>. Here is the reasonaing. Let</p>
<ul>
<li><span class="math inline">\(C_0\)</span> denote the overhead cost of performing the imaging examination,</li>
<li><span class="math inline">\(C_{\text{TP}}\)</span> denote the cost of a true positive decision (a benefit can be expressed as a negative cost),</li>
<li><span class="math inline">\(C_{\text{FN}}\)</span> denote the cost of a false negative decision,</li>
<li><span class="math inline">\(C_{\text{FP}}\)</span> denote the cost of a false positive decision, and</li>
<li><span class="math inline">\(C_{\text{TN}}\)</span> denote the cost (or negative benefit) of a true negative decision.</li>
</ul>
<p>It is shown <span class="citation">(Metz <a href="#ref-metz1978rocmethodology" role="doc-biblioref">1978</a>)</span> that the average cost of the examination is:</p>
<p><span class="math display" id="eq:binormal-model-cost">\[\begin{equation} 
\overline{C} = C_0 + C_{\text{TP}} P(\text{TP}) 
+ C_{\text{TN}} P(\text{TN})
+ C_{\text{FP}} P(\text{FP})
+ C_{\text{FN}} P(\text{FN})
\tag{6.22}
\end{equation}\]</span></p>
<p>In this equation <span class="math inline">\(P(\text{TP})\)</span> is the probability of a TP-event, etc. These probabilities are related to disease prevalence <span class="math inline">\(P(+)\)</span> and the operating point by:</p>
<p><span class="math display" id="eq:binormal-model-cost2">\[\begin{equation} 
\left.
\begin{aligned}
P(\text{TP}) =&amp; P(+) \text{TPF} \\
P(\text{TN}) =&amp; (1-P(+)) (1-\text{FPF}) \\
P(\text{FP}) =&amp; (1-P(+)) \text{FPF} \\
P(\text{FN}) =&amp; P(+) (1-\text{TPF}) 
\end{aligned}
\right \}
\tag{6.23}
\end{equation}\]</span></p>
<p>With these substitutions one gets for the average cost:</p>
<p><span class="math display" id="eq:binormal-model-cost3">\[\begin{equation} 
\overline{C} = C_0 + C_{\text{TN}} P(-) + C_{\text{FN}}  P(+) \\
+ (C_{\text{TP}} - C_{\text{FN}}) P(+) \text{TPF} \\
+ (C_{\text{FP}} - C_{\text{TN}}) P(-) \text{FPF} \\
\tag{6.24}
\end{equation}\]</span></p>
<p>Equating the derivative of the average cost to zero, to minimize the average cost, one gets:</p>
<p><span class="math display" id="eq:binormal-model-cost4">\[\begin{equation} 
\frac{d(\text{TPF})}{d(\text{FPF})} = \frac{C_{\text{FP}} - C_{\text{TN}}}{C_{\text{FN}} - C_{\text{TP}}}\frac{P(-)}{P(+)}
\tag{6.25}
\end{equation}\]</span></p>
<p>This defines the slope <span class="math inline">\(\frac{d(\text{TPF})}{d(\text{FPF})}\)</span> of the ROC at the optimal operating point, i.e., the point that minimizes the average cost of the examination. Note that <span class="math inline">\(P(-) = 1 - P(+)\)</span>.</p>
<ul>
<li><p>If disease prevalence is high, then the optimal operating point is where the slope of the ROC is low, which is near the upper-right corner. With mostly diseased cases it makes sense to set the operating point at high sensitivity and low specificity. Conversely, with low prevalence, one should set the operating point at low sensitivity and high specificity.</p></li>
<li><p>For a given disease prevalence, if the cost of a FP decision is high (or if the benefit of a TN is high - recall that a benefit is the same as a negative cost), then the optimal operating point is where the slope of the ROC is high, which is near the lower-left corner. One sets the operating point at low sensitivity and high specificity.</p></li>
<li><p>For a given disease prevalence, if the cost of a FN decision is high (or if the benefit of a TP is high), then the optimal operating point is where the slope of the ROC is low, which is near the upper-right corner. One sets the operating point at high sensitivity and low specificity.</p></li>
</ul>
<p>The costs and benefits are often difficult to quantify. If one assumes that the right hand side of Eqn. <a href="binormal-model.html#eq:binormal-model-cost4">(6.25)</a> equals unity (e.g., the four costs / benefits are equal and disease-prevalence is 50%) then the optimal operating point is defined by that point on the ROC curve where the slope is unity, which is the point of nearest approach of the curve to the upper-left corner. This corresponds to maximizing the Youden index <span class="citation">(Youden <a href="#ref-youden1950index" role="doc-biblioref">1950</a>)</span>, defined as the sum of sensitivity and specificity minus one. This is demonstrated in the following code.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="binormal-model.html#cb34-1"></a>a &lt;-<span class="st"> </span><span class="dv">2</span>;b &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb34-2"><a href="binormal-model.html#cb34-2"></a>z &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">3</span>,<span class="fl">5.5</span>,<span class="fl">0.05</span>)</span>
<span id="cb34-3"><a href="binormal-model.html#cb34-3"></a>FPF &lt;-<span class="st"> </span><span class="kw">pnorm</span>(<span class="op">-</span>z)</span>
<span id="cb34-4"><a href="binormal-model.html#cb34-4"></a>TPF &lt;-<span class="st"> </span><span class="kw">pnorm</span>(a <span class="op">-</span><span class="st"> </span>b<span class="op">*</span>z)</span>
<span id="cb34-5"><a href="binormal-model.html#cb34-5"></a>Youden &lt;-<span class="st"> </span>TPF <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>FPF) <span class="op">-</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb34-6"><a href="binormal-model.html#cb34-6"></a>curve &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">FPF =</span> FPF, <span class="dt">TPF =</span> TPF, <span class="dt">YOU =</span> Youden)</span>
<span id="cb34-7"><a href="binormal-model.html#cb34-7"></a>dist &lt;-<span class="st"> </span><span class="kw">sqrt</span>(FPF<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>TPF)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb34-8"><a href="binormal-model.html#cb34-8"></a>p1 &lt;-<span class="st"> </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(curve, <span class="kw">aes</span>(<span class="dt">x =</span> FPF, <span class="dt">y =</span> TPF)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb34-9"><a href="binormal-model.html#cb34-9"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb34-10"><a href="binormal-model.html#cb34-10"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb34-11"><a href="binormal-model.html#cb34-11"></a>p2 &lt;-<span class="st"> </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(curve, <span class="kw">aes</span>(<span class="dt">x =</span> FPF, <span class="dt">y =</span> YOU)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb34-12"><a href="binormal-model.html#cb34-12"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb34-13"><a href="binormal-model.html#cb34-13"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb34-14"><a href="binormal-model.html#cb34-14"></a>indxDist &lt;-<span class="st"> </span><span class="kw">which</span>(dist <span class="op">==</span><span class="st"> </span><span class="kw">min</span>(dist))</span>
<span id="cb34-15"><a href="binormal-model.html#cb34-15"></a>indxYoud &lt;-<span class="st"> </span><span class="kw">which</span>(Youden <span class="op">==</span><span class="st"> </span><span class="kw">max</span>(Youden))</span>
<span id="cb34-16"><a href="binormal-model.html#cb34-16"></a><span class="cf">if</span> (indxDist <span class="op">!=</span><span class="st"> </span>indxYoud) <span class="kw">stop</span>(<span class="st">&quot;The two indices are different&quot;</span>) <span class="cf">else</span> {</span>
<span id="cb34-17"><a href="binormal-model.html#cb34-17"></a>  <span class="kw">cat</span>(<span class="st">&quot;Op Pt corresponding to max Youden and min distance is: </span><span class="ch">\n</span><span class="st">FPF = &quot;</span>, </span>
<span id="cb34-18"><a href="binormal-model.html#cb34-18"></a>      FPF[indxDist], </span>
<span id="cb34-19"><a href="binormal-model.html#cb34-19"></a>      <span class="st">&quot;</span><span class="ch">\n</span><span class="st">TPF = &quot;</span>, </span>
<span id="cb34-20"><a href="binormal-model.html#cb34-20"></a>      TPF[indxDist])</span>
<span id="cb34-21"><a href="binormal-model.html#cb34-21"></a>}</span>
<span id="cb34-22"><a href="binormal-model.html#cb34-22"></a><span class="co">#&gt; Op Pt corresponding to max Youden and min distance is: </span></span>
<span id="cb34-23"><a href="binormal-model.html#cb34-23"></a><span class="co">#&gt; FPF =  0.1586553 </span></span>
<span id="cb34-24"><a href="binormal-model.html#cb34-24"></a><span class="co">#&gt; TPF =  0.8413447</span></span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:binormal-model-youden-max"></span>
<img src="06-binormal-model_files/figure-html/binormal-model-youden-max-1.png" alt="Left panel: binormal ROC curve corresponding to a = 2 and b = 1. Right panel: variation of Youden index with FPF; the plot shows a maximum at FPF = 0.1586553; this corresponds to the nearest approch of the ROC curve to the upper-left corner." width="672" />
<p class="caption">
FIGURE 6.4: Left panel: binormal ROC curve corresponding to a = 2 and b = 1. Right panel: variation of Youden index with FPF; the plot shows a maximum at FPF = 0.1586553; this corresponds to the nearest approch of the ROC curve to the upper-left corner.
</p>
</div>
</div>
<div id="binormal-model-discussion" class="section level2 hasAnchor">
<h2><span class="header-section-number">6.10</span> Discussion<a href="binormal-model.html#binormal-model-discussion" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The binormal model is historically very important and the contribution by Dorfman and Alf <span class="citation">(Dorfman and Alf <a href="#ref-RN1081" role="doc-biblioref">1969</a>)</span> was seminal. Prior to their work, there was no valid way of estimating AUC from observed ratings counts. Their work and a key paper <span class="citation">(Lusted <a href="#ref-RN1487" role="doc-biblioref">1971</a>)</span> accelerated research using ROC methods. The number of publications using their algorithm, and the more modern versions developed by Metz and colleagues, is probably well in excess of 500. Because of its key role, I have endeavored to take out some of the mystery about how the binormal model parameters are estimated. In particular, a common misunderstanding that the binormal model assumptions are violated by real datasets, when in fact it is quite robust to apparent deviations from normality, is addressed.</p>
<p>A good understanding of this chapter should enable the reader to better understand alternative ROC models, discussed later.</p>
<p>It has been stated that the <code>b</code>-parameter of the binormal model is generally observed to be less than one, consistent with the diseased distribution being wider than the non-diseased one. The ROC literature is largely silent on the reason for this finding. One reason, namely location uncertainty, is presented in Chapter “Predictions of the RSM”, where RSM stands for Radiological Search Model. Basically, if the location of the lesion is unknown, then z-samples from diseased cases can be of two types, samples from the correct lesion location, or samples from other non-lesion locations. The resulting mixture distribution will then appear to have larger variance than the corresponding samples from non-diseased cases. This type of mixing need not be restricted to location uncertainty. Even is location is known, if the lesions are non-homogenous (e.g., they contain a range of contrasts) then a similar mixture-distribution induced broadening is expected. The contaminated binormal model (CBM) - see Chapter TBA - also predicts that the diseased distribution is wider than the non-diseased one.</p>
<p>The fact that the <code>b</code>-parameter is less than unity implies that the predicted ROC curve is improper, meaning its slope is not monotone decreasing as the operating point moves up the curve. The result is that a portion of the curve, near (1,1) that crosses the chance-diagonal and hooks upward approaching (1,1) with infinite slope. Ways of fitting proper ROC curves are described in Chapter “Other proper ROC models”. Usually the hook is not readily visible, which has been used as an excuse to ignore the problem. For example, in Fig. 6.4, one would have to “zoom-in” on the upper right corner to see it, but the reader should make no mistake about it, the hook is there as .</p>
<p>A recent example is Fig. 1 in the publication resulting from the Digital Mammographic Imaging Screening Trial (DMIST) clinical trial <span class="citation">(Pisano et al. <a href="#ref-RN1784" role="doc-biblioref">2005</a>)</span> involving 49,528 asymptomatic women from 33 clinical sites and involving 153 radiologists, where each of the film modality ROC plots crosses the chance diagonal and hooks upwards to (1,1), which as is known, results anytime <span class="math inline">\(b &lt;1\)</span>.</p>
<p>The unphysical nature of the hook (predicting worse than chance-level performance for supposedly expert readers) is not the only reason for seeking alternate ROC models. The binormal model is susceptible to degeneracy problems. If the dataset does not provide any interior operating points (i.e., all observed points lie on the axes defined by FPF = 0 or TPF = 1) then the model fits these points with b = 0. The resulting straight-line segment fits do not make physical sense. These problems are addressed by the contaminated binormal model16 to be discussed in Chapter “Other proper ROC models”. The first paper in the series has particularly readable accounts of data degeneracy.</p>
<p>To this day the binormal model is widely used to fit ROC datasets. In spite of its limitations, the binormal model has been very useful in bringing a level of quantification to this field that did not exist prior to <span class="citation">(Dorfman and Alf <a href="#ref-RN1081" role="doc-biblioref">1969</a>)</span>.</p>
</div>
<div id="binormal-model-pdf-curves-appendix-1" class="section level2 hasAnchor">
<h2><span class="header-section-number">6.11</span> Appendix I: Density functions<a href="binormal-model.html#binormal-model-pdf-curves-appendix-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>According to Eqn. <a href="binormal-model.html#eq:binormal-model-z-samples-1">(6.1)</a> the probability that a z-sample is smaller than a specified threshold <span class="math inline">\(\zeta\)</span>, i.e., the CDF function, is:</p>
<p><span class="math display">\[\begin{equation*} 
P\left ( Z \le \zeta \mid  Z\sim N\left ( 0,1 \right ) \right ) = 1-FPF\left ( \zeta \right ) = \Phi \left ( \zeta  \right )
\end{equation*}\]</span></p>
<p><span class="math display">\[\begin{equation*} 
P\left ( Z \le \zeta \mid  Z\sim N\left ( \mu,\sigma^2 \right ) \right ) = 1-TPF\left ( \zeta \right ) = \Phi \left ( \frac{\zeta - \mu}{\sigma}  \right )
\end{equation*}\]</span></p>
<p>Since the <em>pdf</em> is the derivative of the corresponding CDF function, it follows that (the subscripts N and D denote non-diseased and diseased cases, respectively):</p>
<p><span class="math display">\[\begin{equation*} 
pdf_N\left ( \zeta \right ) = \frac{\partial \Phi\left ( \zeta \right )}{\partial \zeta} = \phi\left ( \zeta \right ) \equiv \frac{1}{\sqrt{2 \pi}}\exp\left ( -\frac{\zeta^2}{2} \right )
\end{equation*}\]</span></p>
<p><span class="math display">\[\begin{equation*} 
pdf_D\left ( \zeta \right ) = \frac{\partial \Phi\left ( \frac{\zeta - \mu}{\sigma} \right )}{\partial \zeta} = \frac{1}{\sigma} \phi\left ( \frac{\zeta - \mu}{\sigma} \right ) \equiv \frac{1}{\sqrt{2 \pi}\sigma}\exp\left ( -\frac{\left (\zeta-\mu  \right )^2}{2\sigma} \right )
\end{equation*}\]</span></p>
<p>The second equation can be written in <span class="math inline">\((a,b)\)</span> notation as:</p>
<p><span class="math display">\[\begin{equation*} 
pdf_D\left ( \zeta \right ) = b\phi\left ( b\zeta-a \right ) = \frac{b}{\sqrt{2 \pi}}\exp\left ( -\frac{\left (b\zeta - a \right )^2}{2} \right )
\end{equation*}\]</span></p>
</div>
<div id="binormal-model-appendix-2" class="section level2 hasAnchor">
<h2><span class="header-section-number">6.12</span> Appendix II: Area under binormal ROC<a href="binormal-model.html#binormal-model-appendix-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="binormal-model-appendix-1-partial-auc" class="section level3 hasAnchor">
<h3><span class="header-section-number">6.12.1</span> General case (partial-area)<a href="binormal-model.html#binormal-model-appendix-1-partial-auc" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This section is based on <span class="citation">(Thompson and Zucchini <a href="#ref-thompson1989statistical" role="doc-biblioref">1989</a>)</span>. In what follows, FPF is abbreviates to x and TPF to y. Then the equation for the ROC curve is <a href="binormal-model.html#eq:binormal-model-roc-curve">(6.13)</a>:</p>
<p><span class="math display" id="eq:binormal-model-xy">\[\begin{equation} 
y=\Phi\left ( a + b \Phi^{-1} \left ( x \right ) \right )
\tag{6.26}
\end{equation}\]</span></p>
<p>The partial-area under the ROC curve from <span class="math inline">\(x = 0\)</span> to <span class="math inline">\(x = c\)</span>, where <span class="math inline">\(0 ≤ c ≤ 1\)</span>, is given by:</p>
<p><span class="math display" id="eq:binormal-model-partial-area-1">\[\begin{equation} 
A_{z;c} = \int_{0}^{c} y dx =  \int_{0}^{c} dx \Phi\left ( a + b \Phi^{-1} \left ( x \right ) \right ) 
\tag{6.27}
\end{equation}\]</span></p>
<p>Define change of variable:</p>
<p><span class="math display" id="eq:binormal-model-change-variable-1">\[\begin{equation} 
x = \Phi\left ( x_1 \right )
\tag{6.28}
\end{equation}\]</span></p>
<p>which implies:</p>
<p><span class="math display" id="eq:binormal-model-dx-dx1">\[\begin{equation}
\left. 
\begin{aligned}
x_1 = &amp;  \Phi^{-1}\left ( x \right ) \\
dx = &amp;  dx_1 \phi\left ( x_1 \right )
\end{aligned}
\right \}
\tag{6.29}
\end{equation}\]</span></p>
<p>This yields:</p>
<p><span class="math display" id="eq:binormal-model-partial-area-2">\[\begin{equation}
\left. 
\begin{aligned}
A_{z;c} = &amp;  \int_{0}^{c} dx \Phi \left ( a + b x_1 \right )\\
 = &amp;  \int_{-\infty}^{\Phi^{-1}\left ( c \right )} dx_1 \phi\left ( x_1 \right )\Phi \left ( a + b x_1 \right )
\end{aligned}
\right \}
\tag{6.30}
\end{equation}\]</span></p>
<p>The right hand side of Eqn. <a href="binormal-model.html#eq:binormal-model-partial-area-2">(6.30)</a> can be expressed as an integral over the bivariate normal distribution as follows. From the definition of the <span class="math inline">\(\Phi\)</span> function the above integral can be written as the following double integral:</p>
<p><span class="math display" id="eq:binormal-model-partial-area-double-integral-1">\[\begin{equation}
A_{z;c} = \int_{x_1=-\infty}^{\Phi^{-1}\left ( c \right )} dx_1 \phi\left ( x_1 \right ) \int_{x_2=-\infty}^{a+bx_1} \phi\left ( x_2 \right ) dx_2
\tag{6.31}
\end{equation}\]</span></p>
<p>Change variables from <span class="math inline">\((x_1, x_2)\)</span> to <span class="math inline">\((z_1, z_2)\)</span> as follows:</p>
<p><span class="math display" id="eq:binormal-model-change-variable-2">\[\begin{equation}
\left. 
\begin{aligned}
z_2= &amp;  x_1 \\
z_1= &amp;  \left ( x_2 - b x_1 \right ) f
\end{aligned}
\right \}
\tag{6.32}
\end{equation}\]</span></p>
<p>Here <span class="math inline">\(f\)</span> is a quantity to be determined, which will allow us to complete the transformation to the desired bivariate integral. The second equation above can be written as:</p>
<p><span class="math display" id="eq:binormal-model-dx2-z1-f">\[\begin{equation}
x_2= \frac{z_1}{f} + bx_1 = \frac{z_1}{f}  + bz_2
\tag{6.33}
\end{equation}\]</span></p>
<p>The Jacobian <span class="citation">(Stein and Barcellos <a href="#ref-stein1992calculus" role="doc-biblioref">1992</a>)</span> of the transformation is</p>
<p><span class="math display" id="eq:binormal-model-jacobian">\[\begin{equation}
J = \left (\begin{matrix}
0 &amp; 1\\ 
\frac{1}{f} &amp; b
\end{matrix}
  \right )\tag{6.34}
\end{equation}\]</span></p>
<p>The magnitude of the determinant of J is <span class="math inline">\(1/f\)</span>.</p>
<p>From a theorem in calculus <span class="citation">(Stein and Barcellos <a href="#ref-stein1992calculus" role="doc-biblioref">1992</a>)</span>, the double integral over <span class="math inline">\((x_1,x_2)\)</span> can be expressed in terms of a double integral over <span class="math inline">\((z_1,z_2)\)</span> as follows:</p>
<p><span class="math display" id="eq:binormal-model-partial-area-double-integral-2">\[\begin{equation}
A_{z;c} = \frac{1}{f}\int_{z_2=-\infty}^{\Phi^{-1}\left ( c \right )} dz_2 \phi\left ( z_2 \right ) \int_{z_1=-\infty}^{z_{1}^{UL}} \phi\left ( \frac{z_1}{f} + b z_2\right ) dz_1
\tag{6.35}
\end{equation}\]</span></p>
<p>The upper limit of the inner integral can be calculated as follows. Using the second equation in Eqn. <a href="binormal-model.html#eq:binormal-model-change-variable-2">(6.32)</a>:</p>
<p><span class="math display" id="eq:binormal-model-upper-limit-simplified">\[\begin{equation}
z_{1}^{UL}=\left ( x_{2}^{UL} - b x_1\right ) f = \left ( a+b x_1-bx_1 \right ) f = af
\tag{6.36}
\end{equation}\]</span></p>
<p>Eqn. <a href="binormal-model.html#eq:binormal-model-partial-area-double-integral-2">(6.35)</a> simplifies to:</p>
<p><span class="math display" id="eq:binormal-model-partial-area-double-integral-3">\[\begin{equation}
A_{z;c} = \frac{1}{f}\int_{z_2=-\infty}^{\Phi^{-1}\left ( c \right )} dz_2 \phi\left ( z_2 \right ) \int_{z_1=-\infty}^{af} \phi\left ( \frac{z_1}{f} + b z_2\right ) dz_1
\tag{6.37}
\end{equation}\]</span></p>
<p>Perform a change of variable from <span class="math inline">\(f\)</span> to a correlation-like quantity <span class="math inline">\(\rho\)</span> defined by:</p>
<p><span class="math display" id="eq:binormal-model-partial-area-rho2">\[\begin{equation}
f= \sqrt{1-\rho^2}
\tag{6.38}
\end{equation}\]</span></p>
<p>Define <span class="math inline">\(\rho\)</span> in terms of the b-parameter as follows:</p>
<p><span class="math display" id="eq:binormal-model-partial-b-rho">\[\begin{equation}
b\sqrt{1-\rho^2} = - \rho
\tag{6.39}
\end{equation}\]</span></p>
<p>This implies that <span class="math inline">\(\rho\)</span> is given by:</p>
<p><span class="math display" id="eq:binormal-model-rho-final1">\[\begin{equation}
\rho = - \frac{b}{\sqrt{1+b^2}}
\tag{6.40}
\end{equation}\]</span></p>
<p>The argument of the right-most <span class="math inline">\(\phi\)</span> function in Eqn. <a href="binormal-model.html#eq:binormal-model-partial-area-double-integral-3">(6.37)</a> simplifies as follows:</p>
<p><span class="math display" id="eq:binormal-model-partial-simplification">\[\begin{equation}
\frac{z_1}{f} + bz_2 = \frac{z_1 + b z_2 \sqrt{1-\rho^2}}{\sqrt{1-\rho^2}} = \frac{z_1 - \rho z_2}{\sqrt{1-\rho^2}}
\tag{6.41}
\end{equation}\]</span></p>
<p>The expression for the partial-area under the ROC reduces to:</p>
<p><span class="math display" id="eq:binormal-model-partial-area-double-integral-4">\[\begin{equation}
A_{z;c} = \frac{1}{\sqrt{1-\rho^2}}\int_{z_2=-\infty}^{\Phi^{-1}\left ( c \right )} dz_2 \phi\left ( z_2 \right ) \int_{z_1=-\infty}^{a\sqrt{1-\rho^2}} \phi\left ( \frac{z_1 - \rho z_2}{\sqrt{1-\rho^2}}\right ) dz_1
\tag{6.42}
\end{equation}\]</span></p>
<p>Eqn. <a href="binormal-model.html#eq:binormal-model-partial-b-rho">(6.39)</a> implies:</p>
<p><span class="math display" id="eq:binormal-model-simplification-4">\[\begin{equation}
1 - \rho^2 = \frac{1}{1+b^2}\\
\tag{6.43}
\end{equation}\]</span></p>
<p>Therefore,</p>
<p><span class="math display" id="eq:binormal-model-partial-area-double-integral-5">\[\begin{equation}
A_{z;c} = \frac{1}{\sqrt{1-\rho^2}}\int_{z_2=-\infty}^{\Phi^{-1}\left ( c \right )} dz_2 \phi\left ( z_2 \right ) \int_{z_1=-\infty}^{\frac{a}{\sqrt{1+b^2}}} \phi\left ( \frac{z_1 - \rho z_2}{\sqrt{1-\rho^2}}\right ) dz_1
\tag{6.44}
\end{equation}\]</span></p>
<p>The standard bivariate normal distribution with correlation coefficient <span class="math inline">\(\rho\)</span> is defined by:</p>
<p><span class="math display" id="eq:binormal-model-definition-standard-bivariate-distribution">\[\begin{equation}
\phi\left ( z_1,z_2;\rho \right ) = \frac{1}{2 \pi \sqrt{1-\rho^2}} \exp  \left ( -\frac{z_1^2 - 2 \rho z_1 z_2 + z_2^2}{2(1-\rho^2)}  \right )
\tag{6.45}
\end{equation}\]</span></p>
<p>The standard normal distribution is defined by:</p>
<p><span class="math display" id="eq:binormal-model-definition-standard-normal-distribution">\[\begin{equation}
\phi\left ( z\right ) = \frac{1}{\sqrt{2 \pi }} \exp  \left ( -\frac{z^2}{2}  \right )
\tag{6.46}
\end{equation}\]</span></p>
<p>It can be shown using these definitions that:</p>
<p><span class="math display" id="eq:binormal-model-standard-bivariate-distribution-2">\[\begin{equation}
\phi\left ( z_1,z_2;\rho \right ) = \frac{1}{\sqrt{1-\rho^2}}\phi\left ( z_2 \right )\phi\left ( \frac{z_1-\rho z_2}{\sqrt{1-\rho^2}} \right )
\tag{6.47}
\end{equation}\]</span></p>
<p>Using this form the expression for the partial-area is:</p>
<p><span class="math display" id="eq:binormal-model-partial-area-final1">\[\begin{equation}
A_{z;c} = \int_{z_2=-\infty}^{\Phi^{-1}\left ( c \right )}   \int_{z_1=-\infty}^{\frac{a}{\sqrt{1+b^2}}} \phi\left ( z_1,z_2;\rho \right ) dz_1dz_2
\tag{6.48}
\end{equation}\]</span></p>
</div>
<div id="binormal-model-appendix-1-total-auc" class="section level3 hasAnchor">
<h3><span class="header-section-number">6.12.2</span> Special case (total area)<a href="binormal-model.html#binormal-model-appendix-1-total-auc" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Since <span class="math inline">\(c\)</span> is the upper limit of FPF, setting <span class="math inline">\(c = 1\)</span> yields the total area under the binormal ROC curve:<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></p>
<p><span class="math display" id="eq:binormal-model-partial-area-special-case">\[\begin{equation}
\left. 
\begin{aligned}
A_{z} = &amp; \int_{z_2=-\infty}^{\infty}   \int_{z_1=-\infty}^{\frac{a}{\sqrt{1+b^2}}} \phi\left ( z_1,z_2;\rho \right ) dz_1dz_2 \\
= &amp;  \int_{z_1=-\infty}^{\frac{a}{\sqrt{1+b^2}}} \phi\left ( z_1 \right ) dz_1 \\
= &amp; \Phi\left ( \frac{a}{\sqrt{1+b^2}} \right )
\end{aligned}
\right \}
\tag{6.49}
\end{equation}\]</span></p>
<p>An equivalent forms for the total area under the unequal variance binormal ROC curve is:</p>
<p><span class="math display" id="eq:binormal-model-partial-area-special-case-2">\[\begin{equation}
\left. 
\begin{aligned}
A_{z} =  &amp; \Phi\left ( \frac{a}{\sqrt{1+b^2}} \right ) \\
= &amp; \Phi\left ( \frac{\frac{a}{b}}{\sqrt{1+\frac{1}{b^2}}} \right ) \\
= &amp; \Phi\left ( \frac{\mu}{\sqrt{1 + \sigma^2}} \right )
\end{aligned}
\right \}
\tag{6.50}
\end{equation}\]</span></p>
</div>
</div>
<div id="binormal-model-invariance-property-appendix-3" class="section level2 hasAnchor">
<h2><span class="header-section-number">6.13</span> Appendix III: Invariance property of pdfs<a href="binormal-model.html#binormal-model-invariance-property-appendix-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The binormal model is not as restrictive as might appear at first sight. Any monotone increasing transformation <span class="math inline">\(Y=f(Z)\)</span> applied to the observed z-samples, and the associated thresholds, will yield the same observed data, e.g., Table <a href="ratings-paradigm.html#tab:ratings-paradigmExampleTable">4.1</a>. This is because such a transformation leaves the ordering of the ratings unaltered and hence results in the same operating points. While the distributions for <span class="math inline">\(Y\)</span> will not be binormal (i.e., two independent normal distributions), one can safely “pretend” that one is still dealing with an underlying binormal model. An alternative way of stating this is that any pair of distributions is allowed as long as they are reducible to a binormal model form by a monotonic increasing transformation of Y: e.g., <span class="math inline">\(Z=f^{-1}\)</span>. [If <span class="math inline">\(f\)</span> is a monotone increasing function of its argument, so is <span class="math inline">\(f^{-1}\)</span>}.] For this reason, the term “pair of latent underlying normal distributions” is sometimes used to describe the binormal model. The robustness of the binormal model has been investigated <span class="citation">(Hanley <a href="#ref-hanley1988robustness" role="doc-biblioref">1988</a>; Dorfman et al. <a href="#ref-dorfman1997proper" role="doc-biblioref">1997</a>)</span>. The referenced paper by Dorfman et al has an excellent discussion of the robustness of the binormal model.</p>
<p>The robustness of the binormal model, i.e., the flexibility allowed by the infinite choices of monotonic increasing functions, application of each of which leaves the ordering of the data unaltered, is widely misunderstood. The non-Gaussian appearance of histograms of ratings in ROC studies can lead one to incorrect conclusions that the binormal model is inapplicable to these datasets. To quote a reviewer of one of my recent papers:</p>
<blockquote>
<p>I have had multiple encounters with statisticians who do not understand this difference…. They show me histograms of data, and tell me that the data is obviously not normal, therefore the binormal model should not be used.</p>
</blockquote>
<p>The reviewer is correct. The misconception is illustrated next.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="binormal-model.html#cb35-1"></a><span class="co"># shows that monotone transformations have no effect on </span></span>
<span id="cb35-2"><a href="binormal-model.html#cb35-2"></a><span class="co"># AUC even though the pdfs look non-gaussian</span></span>
<span id="cb35-3"><a href="binormal-model.html#cb35-3"></a><span class="co"># common misconception about ROC analysis</span></span>
<span id="cb35-4"><a href="binormal-model.html#cb35-4"></a>fArray &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.5</span>,<span class="fl">0.9</span>)</span>
<span id="cb35-5"><a href="binormal-model.html#cb35-5"></a>seedArray &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">12</span>)</span>
<span id="cb35-6"><a href="binormal-model.html#cb35-6"></a><span class="cf">for</span> (row <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>) { </span>
<span id="cb35-7"><a href="binormal-model.html#cb35-7"></a>  f &lt;-<span class="st"> </span>fArray[row]</span>
<span id="cb35-8"><a href="binormal-model.html#cb35-8"></a>  seed &lt;-<span class="st"> </span>seedArray[row]</span>
<span id="cb35-9"><a href="binormal-model.html#cb35-9"></a>  <span class="kw">set.seed</span>(seed) </span>
<span id="cb35-10"><a href="binormal-model.html#cb35-10"></a>  <span class="co"># numbers of cases simulated</span></span>
<span id="cb35-11"><a href="binormal-model.html#cb35-11"></a>  K1 &lt;-<span class="st"> </span><span class="dv">900</span></span>
<span id="cb35-12"><a href="binormal-model.html#cb35-12"></a>  K2 &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb35-13"><a href="binormal-model.html#cb35-13"></a>  mu1 &lt;-<span class="st"> </span><span class="dv">30</span></span>
<span id="cb35-14"><a href="binormal-model.html#cb35-14"></a>  sigma1 &lt;-<span class="st"> </span><span class="dv">7</span></span>
<span id="cb35-15"><a href="binormal-model.html#cb35-15"></a>  mu2 &lt;-<span class="st"> </span><span class="dv">55</span></span>
<span id="cb35-16"><a href="binormal-model.html#cb35-16"></a>  sigma2 &lt;-<span class="st"> </span><span class="dv">7</span> </span>
<span id="cb35-17"><a href="binormal-model.html#cb35-17"></a>  <span class="co"># Simulate true gaussian ratings using above parameter values</span></span>
<span id="cb35-18"><a href="binormal-model.html#cb35-18"></a>  z1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(K1,<span class="dt">mean =</span> mu1,<span class="dt">sd =</span> sigma1)</span>
<span id="cb35-19"><a href="binormal-model.html#cb35-19"></a>  z1[z1<span class="op">&gt;</span><span class="dv">100</span>] &lt;-<span class="st"> </span><span class="dv">100</span>;z1[z1<span class="op">&lt;</span><span class="dv">0</span>] &lt;-<span class="st"> </span><span class="dv">0</span> <span class="co"># constrain to 0 to 100</span></span>
<span id="cb35-20"><a href="binormal-model.html#cb35-20"></a>  z2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(K2,<span class="dt">mean =</span> mu2,<span class="dt">sd =</span> sigma2)</span>
<span id="cb35-21"><a href="binormal-model.html#cb35-21"></a>  z2[z2<span class="op">&gt;</span><span class="dv">100</span>] &lt;-<span class="st"> </span><span class="dv">100</span>;z2[z2<span class="op">&lt;</span><span class="dv">0</span>] &lt;-<span class="st"> </span><span class="dv">0</span> <span class="co"># constrain to 0 to 100</span></span>
<span id="cb35-22"><a href="binormal-model.html#cb35-22"></a>  <span class="co"># calculate AUC for true Gaussian ratings</span></span>
<span id="cb35-23"><a href="binormal-model.html#cb35-23"></a>  AUC1 &lt;-<span class="st"> </span><span class="kw">TrapezoidalArea</span>(z1, z2)</span>
<span id="cb35-24"><a href="binormal-model.html#cb35-24"></a>  Gaussians &lt;-<span class="st"> </span><span class="kw">c</span>(z1, z2)</span>
<span id="cb35-25"><a href="binormal-model.html#cb35-25"></a>  <span class="co"># display histograms of true Gaussian ratings, A1, A2 or A3</span></span>
<span id="cb35-26"><a href="binormal-model.html#cb35-26"></a>  x &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x=</span>Gaussians) <span class="co">#  line 27</span></span>
<span id="cb35-27"><a href="binormal-model.html#cb35-27"></a>  x &lt;-<span class="st">  </span></span>
<span id="cb35-28"><a href="binormal-model.html#cb35-28"></a><span class="st">    </span><span class="kw">ggplot</span>(<span class="dt">data =</span> x, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> x)) <span class="op">+</span></span>
<span id="cb35-29"><a href="binormal-model.html#cb35-29"></a><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">5</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill=</span><span class="st">&quot;grey&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb35-30"><a href="binormal-model.html#cb35-30"></a><span class="st">    </span><span class="kw">xlab</span>(<span class="dt">label =</span> <span class="st">&quot;Original Rating&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb35-31"><a href="binormal-model.html#cb35-31"></a><span class="st">    </span><span class="kw">ggtitle</span>(<span class="dt">label =</span> <span class="kw">paste0</span>(<span class="st">&quot;A&quot;</span>, row, <span class="st">&quot;: &quot;</span>, <span class="st">&quot;Gaussians&quot;</span>))</span>
<span id="cb35-32"><a href="binormal-model.html#cb35-32"></a>  <span class="kw">print</span>(x)</span>
<span id="cb35-33"><a href="binormal-model.html#cb35-33"></a>  z &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="fl">0.0</span>, <span class="dv">100</span>, <span class="fl">0.1</span>)</span>
<span id="cb35-34"><a href="binormal-model.html#cb35-34"></a>  <span class="co"># transform the latent Gaussians to true Gaussians</span></span>
<span id="cb35-35"><a href="binormal-model.html#cb35-35"></a>  transformation &lt;-<span class="st"> </span></span>
<span id="cb35-36"><a href="binormal-model.html#cb35-36"></a><span class="st">    </span><span class="kw">data.frame</span>(</span>
<span id="cb35-37"><a href="binormal-model.html#cb35-37"></a>      <span class="dt">x =</span> z, </span>
<span id="cb35-38"><a href="binormal-model.html#cb35-38"></a>      <span class="dt">z =</span>  <span class="kw">Y</span>(z,mu1,mu2,sigma1,sigma2,f))</span>
<span id="cb35-39"><a href="binormal-model.html#cb35-39"></a>  <span class="co"># display transformation functions, B1, B2 or B3</span></span>
<span id="cb35-40"><a href="binormal-model.html#cb35-40"></a>  x &lt;-<span class="st"> </span></span>
<span id="cb35-41"><a href="binormal-model.html#cb35-41"></a><span class="st">    </span><span class="kw">ggplot</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> z)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb35-42"><a href="binormal-model.html#cb35-42"></a><span class="st">    </span><span class="kw">geom_line</span>(<span class="dt">data =</span> transformation, <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb35-43"><a href="binormal-model.html#cb35-43"></a><span class="st">    </span><span class="kw">xlab</span>(<span class="dt">label =</span> <span class="st">&quot;Original Rating&quot;</span>) <span class="op">+</span></span>
<span id="cb35-44"><a href="binormal-model.html#cb35-44"></a><span class="st">    </span><span class="kw">ylab</span>(<span class="dt">label =</span> <span class="st">&quot;Transformed Rating&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb35-45"><a href="binormal-model.html#cb35-45"></a><span class="st">    </span><span class="kw">ggtitle</span>(<span class="dt">label =</span> <span class="kw">paste0</span>(<span class="st">&quot;B&quot;</span>, row, <span class="st">&quot;: &quot;</span>,<span class="st">&quot;Monotone Transformation&quot;</span>))</span>
<span id="cb35-46"><a href="binormal-model.html#cb35-46"></a>  <span class="kw">print</span>(x)</span>
<span id="cb35-47"><a href="binormal-model.html#cb35-47"></a>  y &lt;-<span class="st"> </span><span class="kw">Y</span>(<span class="kw">c</span>(z1, z2),mu1,mu2,sigma1,sigma2,f)</span>
<span id="cb35-48"><a href="binormal-model.html#cb35-48"></a>  y1 &lt;-<span class="st"> </span>y[<span class="dv">1</span><span class="op">:</span>K1];y2 &lt;-<span class="st"> </span>y[(K1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>(K1<span class="op">+</span>K2)]</span>
<span id="cb35-49"><a href="binormal-model.html#cb35-49"></a>  <span class="co"># calculate AUC for transformed ratings</span></span>
<span id="cb35-50"><a href="binormal-model.html#cb35-50"></a>  AUC2 &lt;-<span class="st"> </span><span class="kw">TrapezoidalArea</span>( y1, y2)</span>
<span id="cb35-51"><a href="binormal-model.html#cb35-51"></a>  <span class="co"># display histograms of latent Gaussian ratings, C1, C2 or C3</span></span>
<span id="cb35-52"><a href="binormal-model.html#cb35-52"></a>  x &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x=</span>y)</span>
<span id="cb35-53"><a href="binormal-model.html#cb35-53"></a>  x &lt;-<span class="st">  </span><span class="kw">ggplot</span>(<span class="dt">data =</span> x, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> x)) <span class="op">+</span></span>
<span id="cb35-54"><a href="binormal-model.html#cb35-54"></a><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">5</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill=</span><span class="st">&quot;grey&quot;</span>) <span class="op">+</span></span>
<span id="cb35-55"><a href="binormal-model.html#cb35-55"></a><span class="st">    </span><span class="kw">xlab</span>(<span class="dt">label =</span> <span class="st">&quot;Transformed Rating&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb35-56"><a href="binormal-model.html#cb35-56"></a><span class="st">    </span><span class="kw">ggtitle</span>(<span class="dt">label =</span> <span class="kw">paste0</span>(<span class="st">&quot;C&quot;</span>, row, <span class="st">&quot;: &quot;</span>, <span class="st">&quot;Latent Gaussians&quot;</span>))</span>
<span id="cb35-57"><a href="binormal-model.html#cb35-57"></a>  <span class="kw">print</span>(x)</span>
<span id="cb35-58"><a href="binormal-model.html#cb35-58"></a><span class="co"># print AUCs, note they are identical (for each row)  </span></span>
<span id="cb35-59"><a href="binormal-model.html#cb35-59"></a><span class="kw">options</span>(<span class="dt">digits =</span> <span class="dv">9</span>)</span>
<span id="cb35-60"><a href="binormal-model.html#cb35-60"></a>  <span class="kw">cat</span>(<span class="st">&quot;row =&quot;</span>, row, <span class="st">&quot;, seed =&quot;</span>, seed, <span class="st">&quot;, f =&quot;</span>, f, </span>
<span id="cb35-61"><a href="binormal-model.html#cb35-61"></a>      <span class="st">&quot;</span><span class="ch">\n</span><span class="st">AUC of actual Gaussians =&quot;</span>, AUC1, </span>
<span id="cb35-62"><a href="binormal-model.html#cb35-62"></a>      <span class="st">&quot;</span><span class="ch">\n</span><span class="st">AUC of latent Gaussians =&quot;</span>, AUC2, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb35-63"><a href="binormal-model.html#cb35-63"></a>}</span>
<span id="cb35-64"><a href="binormal-model.html#cb35-64"></a><span class="co">#&gt; row = 1 , seed = 10 , f = 0.1 </span></span>
<span id="cb35-65"><a href="binormal-model.html#cb35-65"></a><span class="co">#&gt; AUC of actual Gaussians = 0.99308 </span></span>
<span id="cb35-66"><a href="binormal-model.html#cb35-66"></a><span class="co">#&gt; AUC of latent Gaussians = 0.99308</span></span>
<span id="cb35-67"><a href="binormal-model.html#cb35-67"></a><span class="co">#&gt; row = 2 , seed = 11 , f = 0.5 </span></span>
<span id="cb35-68"><a href="binormal-model.html#cb35-68"></a><span class="co">#&gt; AUC of actual Gaussians = 0.993668889 </span></span>
<span id="cb35-69"><a href="binormal-model.html#cb35-69"></a><span class="co">#&gt; AUC of latent Gaussians = 0.993668889</span></span>
<span id="cb35-70"><a href="binormal-model.html#cb35-70"></a><span class="co">#&gt; row = 3 , seed = 12 , f = 0.9 </span></span>
<span id="cb35-71"><a href="binormal-model.html#cb35-71"></a><span class="co">#&gt; AUC of actual Gaussians = 0.995041111 </span></span>
<span id="cb35-72"><a href="binormal-model.html#cb35-72"></a><span class="co">#&gt; AUC of latent Gaussians = 0.995041111</span></span></code></pre></div>
<p><img src="06-binormal-model_files/figure-html/unnamed-chunk-15-1.png" width="33%" /><img src="06-binormal-model_files/figure-html/unnamed-chunk-15-2.png" width="33%" /><img src="06-binormal-model_files/figure-html/unnamed-chunk-15-3.png" width="33%" /><img src="06-binormal-model_files/figure-html/unnamed-chunk-15-4.png" width="33%" /><img src="06-binormal-model_files/figure-html/unnamed-chunk-15-5.png" width="33%" /><img src="06-binormal-model_files/figure-html/unnamed-chunk-15-6.png" width="33%" /><img src="06-binormal-model_files/figure-html/unnamed-chunk-15-7.png" width="33%" /><img src="06-binormal-model_files/figure-html/unnamed-chunk-15-8.png" width="33%" /><img src="06-binormal-model_files/figure-html/unnamed-chunk-15-9.png" width="33%" /></p>
<p><strong>Figure captions (A1 - C3):</strong> Illustrating the invariance of ROC analysis to arbitrary monotone transformations of the ratings. Each row contains 3 plots: labeled 1, 2 and 3. Each column contains 3 plots labeled A, B and C. So, for example, plot C2 refers to the second row and third column. The for-loop generates the plot one row at a time. Each of the latent Gaussian plots C1, C2 and C3 appears not binormal. However, using the inverse of the monotone transformations shown B1, B2 and B3, they can be transformed to the binormal model histograms A1, A2 and A3. Plot A1 shows the histogram of simulated ratings from a binormal model. Two peaks, one at 30 and the other at 55 are evident (by design, all ratings in this figure are in the range 0 to 100). Plot B1 shows the monotone transformation for <span class="math inline">\(f = 0.1\)</span>. Plot C1 shows the histogram of the transformed rating. The choice of <span class="math inline">\(f\)</span> leads to a transformed rating histogram that is peaked near the high end of the rating scale. For A1 and C1 the corresponding AUCs are identical (0.993080000). Plot A2 is for a different seed value, plot B2 is the transformation for <span class="math inline">\(f = 0.5\)</span> and now the transformed histogram is almost flat, plot C2. For plots A2 and C2 the corresponding AUCs are identical (0.993668889). Plot A3 is for a different seed value, B3 is the transformation for <span class="math inline">\(f = 0.9\)</span> and the transformed histogram C3 is peaked near the low end of the transformed rating scale. For plots A3 and (C3) the corresponding AUCs are identical (0.995041111).</p>
<p>The idea is to simulate continuous ratings data in the range 0 to 100 from a binormal model. <span class="math inline">\(K_1 = 900\)</span> non-diseased cases are sampled from a Gaussian centered at <span class="math inline">\(\mu_1\)</span> = 30 and standard deviation <span class="math inline">\(\sigma_1 = 7\)</span>. <span class="math inline">\(K_2 = 1000\)</span> diseased cases are sampled from a Gaussian centered at <span class="math inline">\(\mu_2\)</span> = 55 and standard deviation <span class="math inline">\(\sigma_2\)</span> = 7. The variable <span class="math inline">\(f\)</span>, which is in the range (0,1), controls the shape of the transformed distribution. If <span class="math inline">\(f\)</span> is small, the transformed distribution will be peaked towards 0 and if <span class="math inline">\(f\)</span> is unity, it will be peaked at 100. If <span class="math inline">\(f\)</span> equals 0.5, the transformed distribution is flat. Insight into the reason for this transformation is in <span class="citation">(Press et al. <a href="#ref-RN300" role="doc-biblioref">2007</a>)</span>, Chapter 7: it has to do with transformations of random variables. The transformation function, <span class="math inline">\(Y(Z)\)</span>, implements:</p>
<p><span class="math display" id="eq:binormal-modelDemoMisconception">\[\begin{equation} 
Y\left ( Z \right )=\left [ \left ( 1-f \right )\Phi\left ( \frac{Z-\mu_1}{\sigma_1} \right )+f\Phi\left ( \frac{Z-\mu_2}{\sigma_2} \right ) \right ]100
\tag{6.51}
\end{equation}\]</span></p>
<p>The multiplication by 100 ensures that the transformed variable is in the range 0 to 100 (if not, it is code-constrained to be). The code realizes the random samples, calculates the empirical AUC, displays the histogram of the true binormal samples, plots the transformation function, calculates the empirical AUC using the transformed samples, and plots the histogram of the transformed samples (the latent binormal).</p>
<ul>
<li>B1 shows the transformation for <span class="math inline">\(f = 0.1\)</span>. The steep initial rise of the curve has the effect of flattening the histogram of the transformed ratings at the low end of the rating scale, C1. Conversely, the flat nature of the curve near upper end of the rating range has the effect of causing the histogram of the transformed variable to peak in that range.</li>
<li>B2 shows the transformation for <span class="math inline">\(f = 0.5\)</span>. This time the latent rating histogram, C2, is almost flat over the entire range, definitely not visually binormal.</li>
<li>B3 shows the transformation for <span class="math inline">\(f = 0.9\)</span>. This time the transformed rating histogram, C3, is peaked at the low end of the transformed rating scale.</li>
<li>The output lists the values of the seed variable and the value of the shape parameter <span class="math inline">\(f\)</span>. <em>For each value of seed and the shape parameter, the AUCs of the actual Gaussians and the transformed variables are identical</em>.</li>
<li>The values of the parameters were chosen to best illustrate the true binormal nature of the plots A2 and A3. This has the effect of making the AUCs close to unity.</li>
</ul>
<p>The histograms in C1, C2 and C3 appear to be non-Gaussian. The corresponding non-diseased and diseased ratings will fail tests of normality. [Showing this is left as an exercise for the reader.] Nevertheless, they are latent Gaussians in the sense that the inverses of the transformations shown in B1, B2 and B3 will yield histograms that are strictly binormal, i.e., A1, A2 and A3. By appropriate changes to the monotone transformation function, the histograms shown in C1, C2 and C3 can be made to resemble a wide variety of shapes, for example, quasi-bimodal (don’t confuse bimodal with binormal) histograms.]</p>
<p><strong>Visual examination of the shape of the histograms of ratings, or standard tests for normality, yield little, if any, insight into whether the underlying binormal model assumptions are being violated.</strong></p>
</div>
<div id="binormal-model-curve-fitting-appendix-4" class="section level2 hasAnchor">
<h2><span class="header-section-number">6.14</span> Appendix IV: Fitting an ROC curve<a href="binormal-model.html#binormal-model-curve-fitting-appendix-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="java-fitted-roc-curve" class="section level3 hasAnchor">
<h3><span class="header-section-number">6.14.1</span> JAVA fitted ROC curve<a href="binormal-model.html#java-fitted-roc-curve" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This section, described in the physical book, has been abbreviated to a <a href="http://www.rad.jhmi.edu/jeng/javarad/roc/JROCFITi.html">relevant website</a>.</p>
</div>
<div id="simplistic-straight-line-fit-to-the-roc-curve" class="section level3 hasAnchor">
<h3><span class="header-section-number">6.14.2</span> Simplistic straight line fit to the ROC curve<a href="binormal-model.html#simplistic-straight-line-fit-to-the-roc-curve" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To be described next is a method for fitting data such as in Table <a href="ratings-paradigm.html#tab:ratings-paradigmExampleTable">4.1</a> to the binormal model, i.e., determining the parameters <span class="math inline">\((a,b)\)</span> and the thresholds <span class="math inline">\(\zeta_r , \quad r = 1, 2, ..., R-1\)</span>, to best fit, in some to-be-defined sense, the observed cell counts. The most common method uses an algorithm called maximum likelihood. But before getting to that, I describe the least-square method, which is conceptually simpler, but not really applicable, as will be explained shortly.</p>
<div id="least-squares-estimation" class="section level4 hasAnchor">
<h4><span class="header-section-number">6.14.2.1</span> Least-squares estimation<a href="binormal-model.html#least-squares-estimation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>By applying the function <span class="math inline">\(\Phi^{-1}\)</span> to both sides of Eqn. <a href="binormal-model.html#eq:binormal-model-roc-curve1">(6.10)</a>, one gets (the “inverse” function cancels the “forward” function on the right hand side):</p>
<p><span class="math display">\[\begin{equation*} 
\Phi^{-1}\left ( TPF \right ) = a + b \Phi^{-1}\left ( FPF \right )
\end{equation*}\]</span></p>
<p>This suggests that a plot of <span class="math inline">\(y = \Phi^{-1}\left ( TPF \right )\)</span> vs. <span class="math inline">\(x=\Phi^{-1}\left ( FPF \right )\)</span> is expected to follow a straight line with slope <span class="math inline">\(b\)</span> and intercept <span class="math inline">\(a\)</span>. Fitting a straight line to such data is generally performed by the method of least-squares, a capability present in most software packages and spreadsheets. Alternatively, one can simply visually draw the best straight line that fits the points, memorably referred to <span class="citation">(Press et al. <a href="#ref-RN300" role="doc-biblioref">2007</a>)</span> as “chi-by-eye”. This was the way parameters of the binormal model were estimated prior to Dorfman and Alf’s work <span class="citation">(Dorfman and Alf <a href="#ref-RN1081" role="doc-biblioref">1969</a>)</span>. The least-squares method is a quantitative way of accomplishing the same aim. If <span class="math inline">\(\left ( x_t,y_t \right )\)</span> are the data points, one constructs <span class="math inline">\(S\)</span>, the sum of the squared deviations of the observed ordinates from the predicted values (since <span class="math inline">\(R\)</span> is the number of ratings bins, the summation runs over the <span class="math inline">\(R-1\)</span> operating points):</p>
<p><span class="math display">\[\begin{equation*} 
S  = \sum_{i=1}^{R-1}\left ( y_i - \left ( a + bx_i \right ) \right )^2
\end{equation*}\]</span></p>
<p>The idea is to minimize S with respect to the parameters <span class="math inline">\((a,b)\)</span>. One approach is to differentiate this with respect to <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> and equate each resulting derivate expression to zero. This yields two equations in two unknowns, which are solved for <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>. If the reader has never done this before, one should go through these steps at least once, but it would be smarter in future to use software that does all this. In <code>R</code> the least-squares fitting function is <code>lm(y~x)</code>, which in its simplest form fits a linear model <code>lm(y~x)</code> using the method of least-squares (in case you are wondering <code>lm</code> stands for linear model, a whole branch of statistics in itself; in this example one is using its simplest capability).</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="binormal-model.html#cb36-1"></a><span class="co"># ML estimates of a and b (from Eng JAVA program)</span></span>
<span id="cb36-2"><a href="binormal-model.html#cb36-2"></a><span class="co"># a &lt;- 1.3204; b &lt;- 0.6075 </span></span>
<span id="cb36-3"><a href="binormal-model.html#cb36-3"></a><span class="co"># # these are not used in program; just here for comparison</span></span>
<span id="cb36-4"><a href="binormal-model.html#cb36-4"></a></span>
<span id="cb36-5"><a href="binormal-model.html#cb36-5"></a>FPF &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.017</span>, <span class="fl">0.050</span>, <span class="fl">0.183</span>, <span class="fl">0.5</span>)  </span>
<span id="cb36-6"><a href="binormal-model.html#cb36-6"></a><span class="co"># this is from Table 6.11, last two rows</span></span>
<span id="cb36-7"><a href="binormal-model.html#cb36-7"></a>TPF &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.440</span>, <span class="fl">0.680</span>, <span class="fl">0.780</span>, <span class="fl">0.900</span>)</span>
<span id="cb36-8"><a href="binormal-model.html#cb36-8"></a><span class="co"># ...do...</span></span>
<span id="cb36-9"><a href="binormal-model.html#cb36-9"></a></span>
<span id="cb36-10"><a href="binormal-model.html#cb36-10"></a>PhiInvFPF &lt;-<span class="st"> </span><span class="kw">qnorm</span>(FPF)</span>
<span id="cb36-11"><a href="binormal-model.html#cb36-11"></a><span class="co"># apply the PHI_INV function</span></span>
<span id="cb36-12"><a href="binormal-model.html#cb36-12"></a>PhiInvTPF &lt;-<span class="st"> </span><span class="kw">qnorm</span>(TPF)</span>
<span id="cb36-13"><a href="binormal-model.html#cb36-13"></a><span class="co"># ... do ... </span></span>
<span id="cb36-14"><a href="binormal-model.html#cb36-14"></a></span>
<span id="cb36-15"><a href="binormal-model.html#cb36-15"></a>fit &lt;-<span class="st"> </span><span class="kw">lm</span>(PhiInvTPF<span class="op">~</span>PhiInvFPF)</span>
<span id="cb36-16"><a href="binormal-model.html#cb36-16"></a><span class="kw">print</span>(fit)</span>
<span id="cb36-17"><a href="binormal-model.html#cb36-17"></a><span class="co">#&gt; </span></span>
<span id="cb36-18"><a href="binormal-model.html#cb36-18"></a><span class="co">#&gt; Call:</span></span>
<span id="cb36-19"><a href="binormal-model.html#cb36-19"></a><span class="co">#&gt; lm(formula = PhiInvTPF ~ PhiInvFPF)</span></span>
<span id="cb36-20"><a href="binormal-model.html#cb36-20"></a><span class="co">#&gt; </span></span>
<span id="cb36-21"><a href="binormal-model.html#cb36-21"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb36-22"><a href="binormal-model.html#cb36-22"></a><span class="co">#&gt; (Intercept)    PhiInvFPF  </span></span>
<span id="cb36-23"><a href="binormal-model.html#cb36-23"></a><span class="co">#&gt;    1.328844     0.630746</span></span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:binormal-modelStraightLineFit"></span>
<img src="06-binormal-model_files/figure-html/binormal-modelStraightLineFit-1.png" alt="The straight line fit method of estimating parameters of the fitting model." width="672" />
<p class="caption">
FIGURE 6.5: The straight line fit method of estimating parameters of the fitting model.
</p>
</div>
<p>Fig. <a href="binormal-model.html#fig:binormal-modelStraightLineFit">6.5</a> shows operating points from Table <a href="ratings-paradigm.html#tab:ratings-paradigmExampleTable">4.1</a>, transformed by the <span class="math inline">\(\Phi^{-1}\)</span> function; the slope of the line is the least-squares estimate of the <span class="math inline">\(b\)</span> parameter and the intercept is the corresponding <span class="math inline">\(a\)</span> parameter of the binormal model.</p>
<p>The last line contains the least squares estimated values, <span class="math inline">\(a\)</span> = 1.3288 and <span class="math inline">\(b\)</span> = 0.6307. The corresponding maximum likelihood estimates of these parameters, as yielded by the Eng web code, Appendix B, are listed in line 4 of the main program: <span class="math inline">\(a\)</span> = 1.3204 and <span class="math inline">\(b\)</span> = 0.6075. The estimates appear to be close, particularly the estimate of <span class="math inline">\(a\)</span> , but there are a few things wrong with the least-squares approach. First, the method of least squares assumes that the data points are independent. Because of the manner in which they are constructed, namely by cumulating points, the independence assumption is not valid for ROC operating points. Cumulating the 4 and 5 responses constrains the resulting operating point to be above and to the right of the point obtained by cumulating the 5 responses only, so the data points are definitely not independent. Similarly, cumulating the 3, 4 and 5 responses constrains the resulting operating point to be above and to the right of the point obtained by cumulating the 4 and 5 responses, and so on. The second problem is the linear least-squares method assumes there is no error in measuring x; the only source of error that is accounted for is in the y-coordinate. In fact, both coordinates of an ROC operating point are subject to sampling error. Third, disregard of error in the x-direction is further implicit in the estimates of the thresholds, which according to Eqn. (6.2.19), is given by:</p>
<p><span class="math display">\[\begin{equation*} 
\zeta_r = - \Phi^{-1}\left ( FPF_r \right )
\end{equation*}\]</span></p>
<p>These are “rigid” estimates that assume no error in the FPF values. As was shown in Chapter <a href="binary-task.html#binary-task">2</a>, 95% confidence intervals apply to these estimates.</p>
<p>A historical note: prior to computers and easy access to statistical functions the analyst had to use a special plotting paper, termed “double probability paper”, that converted probabilities into x and y distances using the inverse function.</p>
</div>
</div>
<div id="maximum-likelihood-estimation-mle" class="section level3 hasAnchor">
<h3><span class="header-section-number">6.14.3</span> Maximum likelihood estimation (MLE)<a href="binormal-model.html#maximum-likelihood-estimation-mle" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The approach taken by Dorfman and Alf was to maximize the likelihood function instead of S. The likelihood function is the probability of the observed data given a set of parameter values, i.e.,</p>
<p><span class="math display">\[\begin{equation*} 
\text {L} \equiv P\left ( data \mid \text {parameters} \right )
\end{equation*}\]</span></p>
<p>Generally “data” is suppressed, so likelihood is a function of the parameters; but “data” is always implicit. With reference to Fig. 6.1, the probability of a non-diseased case yielding a count in the 2nd bin equals the area under the curve labeled “Noise” bounded by the vertical lines at <span class="math inline">\(\zeta_1\)</span> and <span class="math inline">\(\zeta_2\)</span>. In general, the probability of a non-diseased case yielding a count in the <span class="math inline">\(r^\text{th}\)</span> bin equals the area under the curve labeled “Noise” bounded by the vertical lines at <span class="math inline">\(\zeta_{r-1}\)</span> and <span class="math inline">\(\zeta_r\)</span>. Since the area to the left of a threshold is the CDF corresponding to that threshold, the required probability is <span class="math inline">\(\Phi\left ( \zeta_r \right ) - \Phi\left ( \zeta_{r-1} \right )\)</span>; we are simply subtracting two expressions for specificity, Eqn. (6.2.5).</p>
<p><span class="math display">\[\begin{equation*} 
\text {count in non-diseased bin } r = \Phi\left ( \zeta_r \right ) - \Phi\left ( \zeta_{r-1} \right )
\end{equation*}\]</span></p>
<p>Similarly, the probability of a diseased case yielding a count in the rth bin equals the area under the curve labeled “Signal” bounded by the vertical lines at <span class="math inline">\(\zeta_{r-1}\)</span> and <span class="math inline">\(\zeta_r\)</span>. The area under the diseased distribution to the left of threshold <span class="math inline">\(\zeta_r\)</span> is the <span class="math inline">\(1 - TPF\)</span> at that threshold:</p>
<p><span class="math display">\[\begin{equation*} 
1 - \Phi\left ( \frac{\mu-\zeta_r}{\sigma} \right ) = \Phi\left ( \frac{\zeta_r - \mu}{\sigma} \right )
\end{equation*}\]</span></p>
<p>The area between the two thresholds is:</p>
<p><span class="math display">\[\begin{align*} 
P\left ( \text{count in diseased bin }r \right ) &amp;= \Phi\left ( \frac{\zeta_r - \mu}{\sigma} \right ) - \Phi\left ( \frac{\zeta_{r-1} - \mu}{\sigma} \right ) \\
&amp;= \Phi\left ( b\zeta_r-a \right ) - \Phi\left ( b\zeta_{r-1}-a \right )
\end{align*}\]</span></p>
<p>Let <span class="math inline">\(K_{1r}\)</span> denote the number of non-diseased cases in the rth bin, and <span class="math inline">\(K_{2r}\)</span> denotes the number of diseased cases in the rth bin. Consider the number of counts <span class="math inline">\(K_{1r}\)</span> in non-diseased case bin <span class="math inline">\(r\)</span>. Since the probability of each count is <span class="math inline">\(\Phi\left ( \zeta_{r+1} \right ) - \Phi\left ( \zeta_r \right )\)</span>, the probability of the observed number of counts, assuming the counts are independent, is <span class="math inline">\({\left(\Phi\left ( \zeta_{r+1} \right ) - \Phi\left ( \zeta_r \right ) \right )}^{K_{1r}}\)</span>. Similarly, the probability of observing counts in diseased case bin <span class="math inline">\(r\)</span> is <span class="math inline">\({\left (\Phi\left ( b\zeta_{r+1}-a \right ) - \Phi\left ( b\zeta_r-a \right ) \right )}^{K_{2r}}\)</span>, subject to the same independence assumption. The probability of simultaneously observing <span class="math inline">\(K_{1r}\)</span> counts in non-diseased case bin r and <span class="math inline">\(K_{2r}\)</span> counts in diseased case bin <span class="math inline">\(r\)</span> is the product of these individual probabilities (again, an independence assumption is being used):</p>
<p><span class="math display">\[\begin{equation*} 
\left (\Phi\left ( \zeta_{r+1}  \right ) - \Phi\left ( \zeta_r  \right )  \right )^{K_{1r}} \left (\Phi\left ( b\zeta_{r+1}-a  \right ) - \Phi\left ( b\zeta_r-a  \right )  \right )^{K_{2r}}
\end{equation*}\]</span></p>
<p>Similar expressions apply for all integer values of <span class="math inline">\(r\)</span> ranging from <span class="math inline">\(1,2,...,R\)</span>. Therefore the probability of observing the entire data set is the product of expressions like Eqn. (6.4.5), over all values of <span class="math inline">\(r\)</span>:</p>
<p><span class="math display" id="eq:binormal-modelProductProb">\[\begin{equation} 
\prod_{r=1}^{R}\left [\left (\Phi\left ( \zeta_{r+1}  \right ) - \Phi\left ( \zeta_r  \right )  \right )^{K_{1r}} \left (\Phi\left ( b\zeta_{r+1}-a  \right ) - \Phi\left ( b\zeta_r-a  \right )  \right )^{K_{2r}}  \right ]
\tag{6.52}
\end{equation}\]</span></p>
<p>We are almost there. A specific combination of <span class="math inline">\(K_{11},K_{12},...,K_{1R}\)</span> counts from <span class="math inline">\(K_1\)</span> non-diseased cases and counts <span class="math inline">\(K_{21},K_{22},...,K_{2R}\)</span> from <span class="math inline">\(K_2\)</span> diseased cases can occur the following number of times (given by the multinomial factor shown below):</p>
<p><span class="math display" id="eq:binormal-modelCombFactor">\[\begin{equation} 
\frac{K_1!}{\prod_{r=1}^{R}K_{1r}!}\frac{K_2!}{\prod_{r=1}^{R}K_{2r}!}
\tag{6.53}
\end{equation}\]</span></p>
<p>The likelihood function is the product of Eqn. <a href="binormal-model.html#eq:binormal-modelProductProb">(6.52)</a> and Eqn. <a href="binormal-model.html#eq:binormal-modelCombFactor">(6.53)</a>:</p>
<p><span class="math display" id="eq:binormal-modelLikelihood">\[\begin{equation} 
\begin{split}
L\left ( a,b,\overrightarrow{\zeta} \right ) &amp;= \left (\frac{K_1!}{\prod_{r=1}^{R}K_{1r}!}\frac{K_2!}{\prod_{r=1}^{R}K_{2r}!}  \right ) \times \\
&amp;\quad\prod_{r=1}^{R}\left [\left (\Phi\left ( \zeta_{r+1}  \right ) - \Phi\left ( \zeta_r  \right )  \right )^{K_{1r}} \left (\Phi\left ( b\zeta_{r+1}-a  \right ) - \Phi\left ( b\zeta_r-a  \right )  \right )^{K_{2r}}  \right ]
\end{split}
\tag{6.54}
\end{equation}\]</span></p>
<p>The left hand side of Eqn. <a href="binormal-model.html#eq:binormal-modelLikelihood">(6.54)</a> shows explicitly the dependence of the likelihood function on the parameters of the model, namely <span class="math inline">\(a,b,\overrightarrow{\zeta}\)</span>, where the vector of thresholds <span class="math inline">\(\overrightarrow{\zeta}\)</span> is a compact notation for the set of thresholds <span class="math inline">\(\zeta_1,\zeta_2,...,\zeta_R\)</span>, (note that since <span class="math inline">\(\zeta_0 = -\infty\)</span>, and <span class="math inline">\(\zeta_R = +\infty\)</span>, only <span class="math inline">\(R-1\)</span> free threshold parameters are involved, and the total number of free parameters in the model is <span class="math inline">\(R+1\)</span>). For example, for a 5-rating ROC study, the total number of free parameters is 6, i.e., <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span> and 4 thresholds <span class="math inline">\(\zeta_1,\zeta_2,\zeta_3,\zeta_4\)</span>.</p>
<p>Eqn. <a href="binormal-model.html#eq:binormal-modelLikelihood">(6.54)</a> is forbidding but here comes a simplification. The difference of probabilities such as <span class="math inline">\(\Phi\left ( \zeta_r \right )-\Phi\left ( \zeta_{r-1} \right )\)</span> is guaranteed to be positive and less than one [the <span class="math inline">\(\Phi\)</span> function is a probability, i.e., in the range 0 to 1, and since <span class="math inline">\(\zeta_r\)</span> is greater than <span class="math inline">\(\zeta_{r-1}\)</span>, the difference is positive and less than one]. When the difference is raised to the power of <span class="math inline">\(K_{1r}\)</span> (a non-negative integer) a very small number can result. Multiplication of all these small numbers may result in an even smaller number, which may be too small to be represented as a floating-point value, especially as the number of counts increases. To prevent this we resort to a trick. Instead of maximizing the likelihood function <span class="math inline">\(L\left ( a,b,\overrightarrow{\zeta} \right )\)</span> we choose to maximize the logarithm of the likelihood function (the base of the logarithm is immaterial). The logarithm of the likelihood function is:</p>
<p><span class="math display" id="eq:binormal-modelLogLikelihood">\[\begin{equation} 
LL\left ( a,b,\overrightarrow{\zeta} \right )=\log \left ( L\left ( a,b,\overrightarrow{\zeta} \right ) \right )
\tag{6.55}
\end{equation}\]</span></p>
<p>Since the logarithm is a monotonically increasing function of its argument, maximizing the logarithm of the likelihood function is equivalent to maximizing the likelihood function. Taking the logarithm converts the product symbols in Eqn. (6.4.8) to summations, so instead of multiplying small numbers one is adding them, thereby avoiding underflow errors. Another simplification is that one can ignore the logarithm of the multinomial factor involving the factorials, because these do not depend on the parameters of the model. Putting all this together, we get the following expression for the logarithm of the likelihood function:</p>
<p><span class="math display" id="eq:binormal-modelLL">\[\begin{equation} 
\begin{split}
LL\left ( a,b,\overrightarrow{\zeta} \right ) \propto&amp; \sum_{r=1}^{R} K_{1r}\log \left ( \Phi\left ( \zeta_{r+1} \right ) - \Phi\left ( \zeta_r \right ) \right ) \\
&amp;+ \sum_{r=1}^{R} K_{2r}\log \left ( \Phi\left (b \zeta_{r+1} - a \right ) - \Phi\left ( b \zeta_r - a \right ) \right ) 
\end{split}
\tag{6.56}
\end{equation}\]</span></p>
<p>The left hand side of Eqn. <a href="binormal-model.html#eq:binormal-modelLL">(6.56)</a> is a function of the model parameters <span class="math inline">\(a,b,\overrightarrow{\zeta}\)</span> and the observed data, the latter being the counts contained in the vectors <span class="math inline">\(\overrightarrow{K_1}\)</span> and <span class="math inline">\(\overrightarrow{K_2}\)</span>, where the vector notation is used as a compact form for the counts <span class="math inline">\(K_{11},K_{12},...,K_{1R}\)</span> and <span class="math inline">\(K_{21},K_{22},...,K_{2R}\)</span>, respectively. The right hand side of Eqn. <a href="binormal-model.html#eq:binormal-modelLL">(6.56)</a> is monotonically related to the probability of observing the data given the model parameters <span class="math inline">\(a,b,\overrightarrow{\zeta}\)</span>. If the choice of model parameters is poor, then the probability of observing the data will be small and log likelihood will be small. With a better choice of model parameters the probability and log likelihood will increase. With optimal choice of model parameters the probability and log likelihood will be maximized, and the corresponding optimal values of the model parameters are called maximum likelihood estimates (MLEs). These are the estimates produced by the programs RSCORE and ROCFIT.</p>
</div>
<div id="code-implementing-mle" class="section level3 hasAnchor">
<h3><span class="header-section-number">6.14.4</span> Code implementing MLE<a href="binormal-model.html#code-implementing-mle" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="binormal-model.html#cb37-1"></a></span>
<span id="cb37-2"><a href="binormal-model.html#cb37-2"></a><span class="co"># ML estimates of a and b (from Eng JAVA program)</span></span>
<span id="cb37-3"><a href="binormal-model.html#cb37-3"></a><span class="co"># a &lt;- 1.3204; b &lt;- 0.6075 </span></span>
<span id="cb37-4"><a href="binormal-model.html#cb37-4"></a><span class="co"># these are not used in program; just there for comparison</span></span>
<span id="cb37-5"><a href="binormal-model.html#cb37-5"></a></span>
<span id="cb37-6"><a href="binormal-model.html#cb37-6"></a>K1t &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">30</span>, <span class="dv">19</span>, <span class="dv">8</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb37-7"><a href="binormal-model.html#cb37-7"></a>K2t &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span>,  <span class="dv">6</span>, <span class="dv">5</span>, <span class="dv">12</span>, <span class="dv">22</span>)</span>
<span id="cb37-8"><a href="binormal-model.html#cb37-8"></a>dataset &lt;-<span class="st"> </span><span class="kw">Df2RJafrocDataset</span>(K1t, K2t, <span class="dt">InputIsCountsTable =</span> <span class="ot">TRUE</span>)</span>
<span id="cb37-9"><a href="binormal-model.html#cb37-9"></a>retFit &lt;-<span class="st"> </span><span class="kw">FitBinormalRoc</span>(dataset)</span>
<span id="cb37-10"><a href="binormal-model.html#cb37-10"></a>retFit[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</span>
<span id="cb37-11"><a href="binormal-model.html#cb37-11"></a><span class="co">#&gt; $a</span></span>
<span id="cb37-12"><a href="binormal-model.html#cb37-12"></a><span class="co">#&gt; [1] 1.32045261</span></span>
<span id="cb37-13"><a href="binormal-model.html#cb37-13"></a><span class="co">#&gt; </span></span>
<span id="cb37-14"><a href="binormal-model.html#cb37-14"></a><span class="co">#&gt; $b</span></span>
<span id="cb37-15"><a href="binormal-model.html#cb37-15"></a><span class="co">#&gt; [1] 0.607492932</span></span>
<span id="cb37-16"><a href="binormal-model.html#cb37-16"></a><span class="co">#&gt; </span></span>
<span id="cb37-17"><a href="binormal-model.html#cb37-17"></a><span class="co">#&gt; $zetas</span></span>
<span id="cb37-18"><a href="binormal-model.html#cb37-18"></a><span class="co">#&gt;      zetaFwd1      zetaFwd2      zetaFwd3      zetaFwd4 </span></span>
<span id="cb37-19"><a href="binormal-model.html#cb37-19"></a><span class="co">#&gt; 0.00768054675 0.89627306763 1.51564784976 2.39672209865 </span></span>
<span id="cb37-20"><a href="binormal-model.html#cb37-20"></a><span class="co">#&gt; </span></span>
<span id="cb37-21"><a href="binormal-model.html#cb37-21"></a><span class="co">#&gt; $AUC</span></span>
<span id="cb37-22"><a href="binormal-model.html#cb37-22"></a><span class="co">#&gt; [1] 0.870452157</span></span>
<span id="cb37-23"><a href="binormal-model.html#cb37-23"></a><span class="co">#&gt; </span></span>
<span id="cb37-24"><a href="binormal-model.html#cb37-24"></a><span class="co">#&gt; $StdAUC</span></span>
<span id="cb37-25"><a href="binormal-model.html#cb37-25"></a><span class="co">#&gt;              [,1]</span></span>
<span id="cb37-26"><a href="binormal-model.html#cb37-26"></a><span class="co">#&gt; [1,] 0.0379042262</span></span>
<span id="cb37-27"><a href="binormal-model.html#cb37-27"></a><span class="kw">print</span>(retFit<span class="op">$</span>fittedPlot)</span></code></pre></div>
<p><img src="06-binormal-model_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p>Note the usage of the <code>RJafroc</code> package <span class="citation">(Chakraborty, Philips, and Zhai <a href="#ref-R-RJafroc" role="doc-biblioref">2020</a>)</span>. Specifically, the function <code>FitBinormalRoc</code>. The ratings table is converted to an <code>RJafroc</code> dataset object, followed by application of the fitting function. The results, contained in <code>retFit</code> should be compared to those obtained from the <a href="http://www.rad.jhmi.edu/jeng/javarad/roc/JROCFITi.html">website implementation of ROCFIT</a>.</p>
</div>
</div>
<div id="binormal-model-curve-fitting-validation-appendix-5" class="section level2 hasAnchor">
<h2><span class="header-section-number">6.15</span> Appendix V: Validating fitting model<a href="binormal-model.html#binormal-model-curve-fitting-validation-appendix-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The above ROC curve is a good visual fit to the observed operating points. Quantification of the validity of the fitting model is accomplished by calculating the Pearson goodness-of-fit test <span class="citation">(Pearson <a href="#ref-RN2656" role="doc-biblioref">1900</a>)</span>, also known as the chi-square test, which uses the statistic defined by <span class="citation">(Larsen and Marx <a href="#ref-RN1492" role="doc-biblioref">2001</a>)</span>:</p>
<p><span class="math display" id="eq:binormal-modelGoodnessFit">\[\begin{equation} 
C^2=\sum_{t=1}^{2}\sum_{r=1}^{R}\frac{\left (K_{tr}-\left \langle K_{tr} \right \rangle  \right )^2}{\left \langle K_{tr} \right \rangle}\\
K_{tr} \geq 5
\tag{6.57}
\end{equation}\]</span></p>
<p>The expected values are given by:</p>
<p><span class="math display" id="eq:binormal-modelGoodnessFitExpVals">\[\begin{equation}
\begin{split}
\left \langle K_{1r} \right \rangle &amp;=K_1\left ( \Phi\left ( \zeta_{r+1} \right ) - \Phi\left ( \zeta_r \right )  \right ) \\
\left \langle K_{2r} \right \rangle &amp;=K_2\left ( \Phi\left ( a\zeta_{r+1}-b \right ) - \Phi\left ( a\zeta_r - b\right )  \right )
\end{split}
\tag{6.58}
\end{equation}\]</span></p>
<p>These expressions should make sense: the difference between the two CDF functions is the probability of a count in the specified bin, and multiplication by the total number of relevant cases should yield the expected counts (a non-integer).</p>
<p>It can be shown that under the null hypothesis that the assumed probability distribution functions for the counts equals the true probability distributions, i.e., the model is valid, the statistic <span class="math inline">\(C^2\)</span> is distributed as:</p>
<p><span class="math display" id="eq:binormal-modelGoodnessFitDistr">\[\begin{equation} 
C^2\sim \chi_{df}^{2}
\tag{6.59}
\end{equation}\]</span></p>
<p>Here <span class="math inline">\(C^2\sim \chi_{df}^{2}\)</span> is the chi-square distribution with degrees of freedom <em>df</em> defined by:</p>
<p><span class="math display" id="eq:binormal-modelGoodnessFitdf">\[\begin{equation} 
df=\left ( R-1 \right )+\left ( R-1 \right )-\left (2+ R-1 \right )=\left ( R-3 \right )
\tag{6.60}
\end{equation}\]</span></p>
<p>The right hand side of the above equation has been written in an expansive form to illustrate the general rule: for <span class="math inline">\(R\)</span> non-diseased cells in the ratings table, the degree of freedom is <span class="math inline">\(R-1\)</span>: this is because when all but one cells are specified, the last is determined, because they must sum to <span class="math inline">\(K_1\)</span> . Similarly, the degree of freedom for the diseased cells is also <span class="math inline">\(R-1\)</span>. Last, we need to subtract the number of free parameters in the model, which is <span class="math inline">\((2+R-1)\)</span>, i.e., the <span class="math inline">\(a,b\)</span> parameters and the <span class="math inline">\(R-1\)</span> thresholds. It is evident that if <span class="math inline">\(R = 3\)</span> then <span class="math inline">\(df = 0\)</span>. In this situation, there are only two non-trivial operating points and the straight-line fit shown will pass through both of them. With two basic parameters, fitting two points is trivial, and goodness of fit cannot be calculated.</p>
<p>Under the null hypothesis (i.e., model is valid) <span class="math inline">\(C^2\)</span> is distributed as <span class="math inline">\(\chi_{df}^{2}\)</span>. Therefore, one computes the probability that this statistic is larger than the observed value, called the <em>p-value</em>. If this probability is very small, that means that the deviations of the observed values of the cell counts from the expected values are so large that it is unlikely that the model is correct. The degree of unlikeliness is quantified by the p-value. Poor fits lead to small p values.</p>
<p>At the 5% significance level, one concludes that the fit is not good if <span class="math inline">\(p &lt; 0.05\)</span>. In practice one occasionally accepts smaller values of <span class="math inline">\(p\)</span>, <span class="math inline">\(p &gt; 0.001\)</span> before completely abandoning a model. It is known that adoption of a stricter criterion, e.g., <span class="math inline">\(p &gt; 0.05\)</span>, can occasionally lead to rejection of a retrospectively valid model <span class="citation">(Press et al. <a href="#ref-RN300" role="doc-biblioref">2007</a>)</span>.</p>
<div id="estimating-the-covariance-matrix" class="section level3 hasAnchor">
<h3><span class="header-section-number">6.15.1</span> Estimating the covariance matrix<a href="binormal-model.html#estimating-the-covariance-matrix" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>TBA See book chapter 6.4.3. This is implemented in <code>RJafroc.</code></p>
</div>
<div id="estimating-the-variance-of-az" class="section level3 hasAnchor">
<h3><span class="header-section-number">6.15.2</span> Estimating the variance of Az<a href="binormal-model.html#estimating-the-variance-of-az" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>TBA See book chapter 6.4.4. This is implemented in <code>RJafroc</code>.</p>
</div>
</div>
<div id="binormal-model-references" class="section level2 hasAnchor">
<h2><span class="header-section-number">6.16</span> References<a href="binormal-model.html#binormal-model-references" class="anchor-section" aria-label="Anchor link to header"></a></h2>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-R-RJafroc">
<p>Chakraborty, Dev, Peter Philips, and Xuetong Zhai. 2020. <em>RJafroc: Analyzing Diagnostic Observer Performance Studies</em>. <a href="https://dpc10ster.github.io/RJafroc/">https://dpc10ster.github.io/RJafroc/</a>.</p>
</div>
<div id="ref-RN1081">
<p>Dorfman, D. D., and E. Alf. 1969. “Maximum-Likelihood Estimation of Parameters of Signal-Detection Theory and Determination of Confidence Intervals - Rating-Method Data.” Journal Article. <em>Journal of Mathematical Psychology</em> 6: 487–96.</p>
</div>
<div id="ref-dorfman1997proper">
<p>Dorfman, Donald D, Kevin S Berbaum, Charles E Metz, Russell V Lenth, James A Hanley, and Hatem Abu Dagga. 1997. “Proper Receiver Operating Characteristic Analysis: The Bigamma Model.” <em>Academic Radiology</em> 4 (2): 138–49.</p>
</div>
<div id="ref-hanley1988robustness">
<p>Hanley, James A. 1988. “The Robustness of the" Binormal" Assumptions Used in Fitting Roc Curves.” <em>Medical Decision Making</em> 8 (3): 197–203.</p>
</div>
<div id="ref-RN1492">
<p>Larsen, Richard J., and Morris L. Marx. 2001. <em>An Introduction to Mathematical Statistics and Its Applications</em>. Book. 3rd ed. Upper Saddle River, NJ: Prentice-Hall Inc.</p>
</div>
<div id="ref-RN1487">
<p>Lusted, L. B. 1971. “Signal Detectability and Medical Decision Making.” Journal Article. <em>Science</em> 171: 1217–1219. <a href="https://doi.org/10.1126/science.171.3977.1217">https://doi.org/10.1126/science.171.3977.1217</a>.</p>
</div>
<div id="ref-metz1978rocmethodology">
<p>Metz, C. E. 1978. “Basic Principles of ROC Analysis.” Journal Article. <em>Seminars in Nuclear Medicine</em> 8 (4): 283–98. <a href="https://doi.org/10.1016/s0001-2998(78)80014-2">https://doi.org/10.1016/s0001-2998(78)80014-2</a>.</p>
</div>
<div id="ref-RN2656">
<p>Pearson, Karl. 1900. “X. On the Criterion That a Given System of Deviations from the Probable in the Case of a Correlated System of Variables Is Such That It Can Be Reasonably Supposed to Have Arisen from Random Sampling.” Journal Article. <em>The London, Edinburgh, and Dublin Philosophical Magazine and Journal of Science</em> 50 (302): 157–75. <a href="https://doi.org/10.1080/14786440009463897">https://doi.org/10.1080/14786440009463897</a>.</p>
</div>
<div id="ref-RN1784">
<p>Pisano, E. D., C. Gatsonis, E. Hendrick, M. Yaffe, J. K. Baum, S. Acharyya, E. F. Conant, et al. 2005. “Diagnostic Performance of Digital Versus Film Mammography for Breast-Cancer Screening.” Journal Article. <em>N Engl J Med</em> 353 (17): 1773–83. <a href="https://doi.org/10.1056/NEJMoa052911">https://doi.org/10.1056/NEJMoa052911</a>.</p>
</div>
<div id="ref-RN300">
<p>Press, W. H., S. A. Teukolsky, W. T. Vetterling, and B. P. Flannery. 2007. <em>Numerical Recipes: The Art of Scientific Computing</em>. Book. 3rd ed. Cambridge: Cambridge University Press.</p>
</div>
<div id="ref-stein1992calculus">
<p>Stein, Sherman K., and Anthony Barcellos. 1992. <em>Calculus and Analytic Geometry</em>. Book. 5th ed. McGraw-Hill Companies.</p>
</div>
<div id="ref-thompson1989statistical">
<p>Thompson, Mary Lou, and Walter Zucchini. 1989. “On the Statistical Analysis of Roc Curves.” <em>Statistics in Medicine</em> 8 (10): 1277–90.</p>
</div>
<div id="ref-youden1950index">
<p>Youden, William J. 1950. “Index for Rating Diagnostic Tests.” <em>Cancer</em> 3 (1): 32–35.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>A more complicated version of this model allows the mean of the non-diseased distribution to be non-zero and its variance different from unity. The 4-parameter model is no more general than the 2-parameter model. The reason is that one is free to transform the decision variable, and associated thresholds, by applying arbitrary monotonic increasing function transformation, which do not change the ordering of the ratings and hence do not change the ROC curve. So if the mean of the noise distribution were non-zero, subtracting this value from all Z-samples would shift the effective mean of the non-diseased distribution to zero (the shifted Z-values are monotonically related to the original values) and the mean of the shifted diseased distribution becomes <span class="math inline">\(\mu_2-\mu_1\)</span>. Next, one scales or divides (division by a positive number is also a monotonic transformation) all the Z-samples by <span class="math inline">\(\sigma_1\)</span>, resulting in the scaled non-diseased distribution having unit variance, and the scaled diseased distribution has mean <span class="math inline">\(\frac{\mu_2-\mu_1}{\sigma_1}\)</span> and variance <span class="math inline">\((\frac{\sigma_2}{\sigma_1})^2\)</span>. Therefore, if one starts with 4 parameters then one can, by simple shifting and scaling operations, reduce the model to 2 parameters, as in Eqn. <a href="binormal-model.html#eq:binormal-model-z-samples-1">(6.1)</a>. [The author has seen a publication on Bayesian ROC estimation using the four-parameter model.]<a href="binormal-model.html#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>Since the integral over <span class="math inline">\(z_2\)</span> is over the entire range it integrates out to unity leaving the one-dimensional density function <span class="math inline">\(\phi\left ( z_1 \right )\)</span> inside the integral. The last step follows from the definition of the <span class="math inline">\(\Phi\)</span> function.<a href="binormal-model.html#fnref2" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="empirical-auc.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sources-of-variability.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["RJafrocRocBook.pdf", "RJafrocRocBook.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
